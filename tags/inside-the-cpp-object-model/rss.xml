<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Inside-the-Cpp-Object-Model on Bluegill</title><link>https://hxhue.github.io/tags/inside-the-cpp-object-model/</link><description>Recent content in Inside-the-Cpp-Object-Model on Bluegill</description><generator>Hugo</generator><language>zh-CN</language><lastBuildDate>Tue, 18 Mar 2025 00:00:00 +0800</lastBuildDate><atom:link href="https://hxhue.github.io/tags/inside-the-cpp-object-model/rss.xml" rel="self" type="application/rss+xml"/><item><title>ğŸ“Œ C++ å¯¹è±¡æ¨¡å‹å¼€é”€æ€»ç»“</title><link>https://hxhue.github.io/inside-the-cpp-object-model/C++-%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B%E5%BC%80%E9%94%80%E6%80%BB%E7%BB%93/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/C++-%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B%E5%BC%80%E9%94%80%E6%80%BB%E7%BB%93/</guid><description>&lt;p>&lt;strong>ä¸‹é¢éƒ½æ˜¯åœ¨ Linux ä¸Šæµ‹è¯•ï¼Œå¤„ç†å™¨æ¶æ„ä¸º x86-64ï¼Œç”¨çš„ Itanium C++ ABI&lt;/strong>ã€‚&lt;/p>
&lt;div class="markdown-alert markdown-alert-caution">
 &lt;p class="markdown-alert-title">&lt;svg class="octicon octicon-stop mr-2" viewBox="0 0 16 16" width="16" height="16"
 aria-hidden="true">
 &lt;path
 d="M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z">
 &lt;/path>
 &lt;/svg>Caution&lt;/p></description></item><item><title>ğŸ“Œ vtable</title><link>https://hxhue.github.io/inside-the-cpp-object-model/vtable/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/vtable/</guid><description>&lt;h1 id="tldr-æ€§èƒ½å¼€é”€">TL;DR æ€§èƒ½å¼€é”€
&lt;a class="header-anchor" href="#tldr-%e6%80%a7%e8%83%bd%e5%bc%80%e9%94%80">&lt;/a>
&lt;/h1>&lt;p>åœ¨ä¸å¼€å¯ä¼˜åŒ–é€‰é¡¹æ—¶ç¼–è¯‘ï¼š&lt;/p>
&lt;ol>
&lt;li>æ¯æ¬¡è°ƒç”¨è™šå‡½æ•°æ¯”æ™®é€šå‡½æ•°å¤šä¸¤æ¬¡è®¿å­˜ã€‚&lt;/li>
&lt;li>æ¯æ¬¡åŠ¨æ€ç±»å‹è½¬æ¢ï¼ˆé™¤éç±»å‹ç²¾ç¡®å‘½ä¸­ï¼‰éƒ½æ˜¯è€—æ—¶çš„å›¾æœç´¢ç®—æ³•ã€‚&lt;/li>
&lt;li>æ˜ç¡®éœ€è¦ç²¾ç¡®è½¬æ¢æ—¶ç”¨ &lt;code>std::type_index&lt;/code> å’Œ &lt;code>static_cast&lt;/code> ä¼šæ›´å¿«ã€‚&lt;/li>
&lt;/ol>
&lt;p>ç›¸å…³ä»£ç ä¸‹è½½ï¼š&lt;/p></description></item><item><title>ğŸ“Œ éè‡ªåŠ¨å˜é‡åˆå§‹åŒ–</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E9%9D%9E%E8%87%AA%E5%8A%A8%E5%8F%98%E9%87%8F%E5%88%9D%E5%A7%8B%E5%8C%96/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E9%9D%9E%E8%87%AA%E5%8A%A8%E5%8F%98%E9%87%8F%E5%88%9D%E5%A7%8B%E5%8C%96/</guid><description>&lt;h1 id="c-å’Œ-c-thread_local-çš„åŒºåˆ«">C++ å’Œ C &lt;code>thread_local&lt;/code> çš„åŒºåˆ«
&lt;a class="header-anchor" href="#c-%e5%92%8c-c-thread_local-%e7%9a%84%e5%8c%ba%e5%88%ab">&lt;/a>
&lt;/h1>&lt;ol>
&lt;li>C++ æ”¯æŒä½¿ç”¨éå¸¸é‡è¡¨è¾¾å¼å¯¹å…¨å±€æˆ–é™æ€å˜é‡åˆå§‹åŒ– &lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>ã€‚å¯¹äº &lt;code>static&lt;/code> local &lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup> / &lt;code>thread_local&lt;/code> å˜é‡è€Œè¨€ï¼Œè¿™é¡¹åŠŸèƒ½éœ€è¦åœ¨è®¿é—®å‰æ£€æŸ¥å˜é‡æ˜¯å¦å·²ç»å®Œæˆåˆå§‹åŒ–ï¼Œ&lt;strong>&lt;code>thread_local&lt;/code> åˆå§‹åŒ–ä¸éœ€è¦çº¿ç¨‹é—´åŒæ­¥ï¼Œè€Œ &lt;code>static&lt;/code> local å˜é‡çš„è®¿é—®è¿‡ç¨‹éœ€è¦çº¿ç¨‹é—´çš„åŒæ­¥ï¼ˆ&lt;code>__cxa_guard_acquire&lt;/code> å’Œ &lt;code>__cxa_guard_release&lt;/code>ï¼‰&lt;/strong>ã€‚&lt;/li>
&lt;li>C++ çš„ &lt;code>thread_local&lt;/code> å˜é‡&lt;strong>åœ¨å‡½æ•°ä½œç”¨åŸŸä¸­&lt;/strong>è‡ªåŠ¨å…·æœ‰ &lt;code>static&lt;/code> å±æ€§ &lt;sup id="fnref:3">&lt;a href="#fn:3" class="footnote-ref" role="doc-noteref">3&lt;/a>&lt;/sup>ï¼Œè€Œ C è¦æ‰‹åŠ¨åŠ ã€‚åœ¨ C è¯­è¨€ä¸­ï¼Œå‡½æ•°ä¸­çš„ &lt;code>thread_local&lt;/code> å¿…é¡»å’Œ &lt;code>extern&lt;/code> æˆ–è€… &lt;code>static&lt;/code> ä¹‹ä¸€ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å­ä¸º &lt;a href="https://godbolt.org/z/eKz71xh7a" title="https://godbolt.org/z/eKz71xh7a" rel="noopener external nofollow noreferrer"
 target="_blank" class=" exturl" >https://godbolt.org/z/eKz71xh7a&lt;i class="fa fa-external-link-alt">&lt;/i>&lt;/a> ã€‚&lt;/li>
&lt;li>C çš„ &lt;code>thread_local&lt;/code> åœ¨ C23 ä¹‹å‰æ˜¯ä¸ªå®ã€‚&lt;/li>
&lt;/ol>
&lt;h1 id="ä»ä»£ä»·ä¸Šæ¥çœ‹-c-çš„å‡ ç§å˜é‡åˆå§‹åŒ–">ä»ä»£ä»·ä¸Šæ¥çœ‹ C++ çš„å‡ ç§å˜é‡åˆå§‹åŒ–
&lt;a class="header-anchor" href="#%e4%bb%8e%e4%bb%a3%e4%bb%b7%e4%b8%8a%e6%9d%a5%e7%9c%8b-c-%e7%9a%84%e5%87%a0%e7%a7%8d%e5%8f%98%e9%87%8f%e5%88%9d%e5%a7%8b%e5%8c%96">&lt;/a>
&lt;/h1>&lt;ul>
&lt;li>é¦–å…ˆï¼Œä¸éœ€è¦å‡½æ•°åˆå§‹åŒ–çš„åœ¨ç¼–è¯‘æœŸé—´å°±èƒ½å®Œæˆå·¥ä½œï¼Œæ²¡æœ‰ä»£ä»·ã€‚&lt;strong>æ‰€ä»¥ä»¥ä¸‹è®¨è®ºçš„éƒ½æ˜¯é€šè¿‡å‡½æ•°æˆ–æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–çš„å˜é‡&lt;/strong>ã€‚&lt;/li>
&lt;li>å…¶æ¬¡ï¼Œå‡½æ•°å†… (static) thread_local å˜é‡åªéœ€è¦åœ¨ä½¿ç”¨å‰æ£€æŸ¥ä¸€ä¸‹ï¼Œæ„é€ å’Œä½¿ç”¨éƒ½ä¸ç”¨åŒæ­¥ï¼Œä»£ä»·å¾ˆå°ã€‚å‡½æ•°å†… static å˜é‡çš„æ„é€ å’Œä½¿ç”¨åˆ™éœ€è¦çº¿ç¨‹ä¹‹é—´åŒæ­¥ã€‚&lt;/li>
&lt;li>å‡½æ•°å¤–å®šä¹‰çš„æ™®é€šå˜é‡å’Œ thread_local å˜é‡éƒ½ä¸éœ€è¦ä»»ä½•åŒæ­¥å°±èƒ½åœ¨é™æ€åˆå§‹åŒ–é˜¶æ®µå®Œæˆåˆå§‹åŒ–ï¼Œä½¿ç”¨æ—¶ä¹Ÿä¸éœ€è¦æ£€æŸ¥ã€‚&lt;/li>
&lt;li>å‡½æ•°å¤–å®šä¹‰çš„ inline å˜é‡ï¼ˆC++17ï¼‰åœ¨ä½¿ç”¨æ—¶ä¸éœ€è¦åŒæ­¥ï¼Œä½†æ˜¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¦æ£€æŸ¥æ˜¯å¦å·²ç»åˆå§‹åŒ–å®Œæˆï¼ˆä¸ºæ­¤æœ‰ä¸ª guard variable æ ‡è®°ï¼‰ã€‚è§ &lt;a href="https://godbolt.org/z/hYMjdbsxj" title="https://godbolt.org/z/hYMjdbsxj" rel="noopener external nofollow noreferrer"
 target="_blank" class=" exturl" >https://godbolt.org/z/hYMjdbsxj&lt;i class="fa fa-external-link-alt">&lt;/i>&lt;/a> ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸º inline å˜é‡å¯èƒ½è¢«å¤šä¸ªåœ°æ–¹ä½¿ç”¨ï¼Œæ¯ä¸ªåœ°æ–¹éƒ½è¦æé˜²é‡å¤åˆå§‹åŒ–ã€‚&lt;/li>
&lt;/ul>
&lt;h1 id="å…¨å±€-å’Œ-static-å˜é‡">å…¨å±€ (å’Œ static) å˜é‡
&lt;a class="header-anchor" href="#%e5%85%a8%e5%b1%80-%e5%92%8c-static-%e5%8f%98%e9%87%8f">&lt;/a>
&lt;/h1>&lt;p>æœ€å¤–å›´å®šä¹‰åŸŸå®šä¹‰çš„å˜é‡ï¼Œå¯ä»¥å…·æœ‰ static å±æ€§ä¹Ÿå¯ä»¥æ²¡æœ‰ã€‚&lt;/p></description></item><item><title>Cfront å¦‚ä½•æ’å…¥æ„é€ å‡½æ•°</title><link>https://hxhue.github.io/inside-the-cpp-object-model/Cfront-%E5%A6%82%E4%BD%95%E6%8F%92%E5%85%A5%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/Cfront-%E5%A6%82%E4%BD%95%E6%8F%92%E5%85%A5%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/</guid><description>&lt;p>å®é™…ä¸Šå¤åˆ¶æ„é€ å‡½æ•°çš„æ’å…¥æ¯”è¾ƒå›°éš¾ï¼Œæ¯”å¦‚åœ¨å‡½æ•°è¿”å›å’Œä¼ å‚çš„æ—¶å€™ã€‚ç”±äº C è¯­è¨€æ˜¯æŒ‰ä½å¤åˆ¶ï¼ˆè€Œä¸æ˜¯æŒ‰æˆå‘˜ï¼‰ï¼Œcfront ä¼šåœ¨å‡½æ•°è°ƒç”¨å‰æ’å…¥è¿”å›å€¼å˜é‡å£°æ˜ï¼Œåœ¨å‡½æ•°ä¸­ä½¿ç”¨å±€éƒ¨å˜é‡è¿ç®—ï¼Œå¹¶åœ¨è¿”å›æ—¶è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°ä»å±€éƒ¨å˜é‡å¤åˆ¶æˆå‘˜åˆ°è¿”å›å€¼å¤„ã€‚&lt;/p></description></item><item><title>new å’Œ delete</title><link>https://hxhue.github.io/inside-the-cpp-object-model/new-%E5%92%8C-delete/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/new-%E5%92%8C-delete/</guid><description>&lt;h1 id="new">&lt;code>new&lt;/code>
&lt;a class="header-anchor" href="#new">&lt;/a>
&lt;/h1>&lt;p>ç”¨ new ç”³è¯·çš„å†…å­˜æœ€å°‘å ç”¨ 1 ä¸ªå­—èŠ‚â€”â€”å°½ç®¡æˆ‘ä»¬ç”³è¯·çš„å¯èƒ½æ˜¯ 0 ä¸ªå­—èŠ‚ã€‚&lt;/p>
&lt;p>






&lt;img src="https://hxhue.github.io/assets/e06da70dc841cb03e9e0076d20f8f899.webp">&lt;/p>
&lt;h1 id="deletedelete">&lt;code>delete&lt;/code>/&lt;code>delete[]&lt;/code>
&lt;a class="header-anchor" href="#deletedelete">&lt;/a>
&lt;/h1>&lt;p>delete å’Œ delete[] éƒ½ä¼šå½’è¿˜ç©ºé—´ï¼Œä½†æ˜¯ delete[] ä¼šè¯¢é—®å…ƒç´ æ•°é‡ï¼Œå¹¶ææ„æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œè€Œ delete åªä¼šææ„ä¸€ä¸ªå…ƒç´ ã€‚&lt;/p></description></item><item><title>æŒ‰éœ€åˆæˆæ„é€ å‡½æ•°</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E6%8C%89%E9%9C%80%E5%90%88%E6%88%90%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E6%8C%89%E9%9C%80%E5%90%88%E6%88%90%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/</guid><description>&lt;p>






&lt;img src="https://hxhue.github.io/assets/862beea85cbeacd098f8815be021dd62.webp">&lt;/p>
&lt;p>






&lt;img src="https://hxhue.github.io/assets/44d6ca6c8f48a441c50cc07501a274e2.webp">&lt;/p>
&lt;p>å¤åˆ¶ã€é»˜è®¤æ„é€ éƒ½æ˜¯æŒ‰éœ€ç”Ÿæˆçš„ã€‚å¯¹äºå¹³å‡¡çš„æƒ…å†µä¸éœ€è¦ç”Ÿæˆï¼Œåªæ˜¯åœ¨è¯­æ„ä¸Šæ»¡è¶³â€œæ‹¥æœ‰æ„é€ å‡½æ•°â€çš„å«ä¹‰ã€‚&lt;/p>
&lt;p>&lt;code>x86-64 gcc 13.1 -std=c++20&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#719e07">struct&lt;/span> &lt;span style="color:#268bd2">Point&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#dc322f">int&lt;/span> x;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#dc322f">int&lt;/span> y;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Point() &lt;span style="color:#719e07">=&lt;/span> &lt;span style="color:#719e07">default&lt;/span>; &lt;span style="color:#586e75">// å³ä¾¿æ˜¾å¼å£°æ˜äº†é»˜è®¤æ„é€ å‡½æ•°ï¼Œä¹Ÿä¸ä¼šåˆæˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#586e75">&lt;/span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#dc322f">int&lt;/span> &lt;span style="color:#268bd2">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#719e07">auto&lt;/span> some_point &lt;span style="color:#719e07">=&lt;/span> Point{}; &lt;span style="color:#586e75">// {}åˆå§‹åŒ–å¯¹èšåˆç±»æœ‰æ¸…é›¶çš„æ•ˆæœ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#586e75">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;">&lt;code class="language-nasm" data-lang="nasm">&lt;span style="display:flex;">&lt;span>main:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#268bd2">push&lt;/span> &lt;span style="color:#b58900">rbp&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#268bd2">mov&lt;/span> &lt;span style="color:#b58900">rbp&lt;/span>, &lt;span style="color:#b58900">rsp&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#268bd2">mov&lt;/span> &lt;span style="color:#dc322f">DWORD&lt;/span> &lt;span style="color:#268bd2">PTR&lt;/span> [&lt;span style="color:#b58900">rbp&lt;/span>&lt;span style="color:#719e07">-&lt;/span>&lt;span style="color:#2aa198">8&lt;/span>], &lt;span style="color:#2aa198">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#268bd2">mov&lt;/span> &lt;span style="color:#dc322f">DWORD&lt;/span> &lt;span style="color:#268bd2">PTR&lt;/span> [&lt;span style="color:#b58900">rbp&lt;/span>&lt;span style="color:#719e07">-&lt;/span>&lt;span style="color:#2aa198">4&lt;/span>], &lt;span style="color:#2aa198">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#268bd2">mov&lt;/span> &lt;span style="color:#b58900">eax&lt;/span>, &lt;span style="color:#2aa198">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#268bd2">pop&lt;/span> &lt;span style="color:#b58900">rbp&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#268bd2">ret&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¿®æ”¹ Point çš„å®šä¹‰ï¼š&lt;/p></description></item><item><title>å¯¹è±¡å¸ƒå±€</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E5%AF%B9%E8%B1%A1%E5%B8%83%E5%B1%80/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E5%AF%B9%E8%B1%A1%E5%B8%83%E5%B1%80/</guid><description>&lt;h1 id="å…³äº-access-section">å…³äº access section
&lt;a class="header-anchor" href="#%e5%85%b3%e4%ba%8e-access-section">&lt;/a>
&lt;/h1>&lt;p>ä¸åŒ access section æ•°æ®ä¸ä¿è¯æŒ‰åºå¸ƒå±€ã€‚&lt;/p>
&lt;p>






&lt;img src="https://hxhue.github.io/assets/a8b2681128b573bd4e51d97c763af9e4.webp">&lt;/p>
&lt;p>






&lt;img src="https://hxhue.github.io/assets/a0ad7b8b74861c3674b93d10f9853a35.webp">&lt;/p>
&lt;blockquote>
 &lt;p>æˆ‘åœ¨ Compiler Explorer ä¸Šæµ‹è¯•äº† gcc å’Œ clangï¼Œä»–ä»¬éƒ½æ˜¯å¿½ç•¥ access æƒé™ï¼Œå°†å„ä¸ª access section çš„å˜é‡å¸ƒå±€ç›´æ¥æ‹¼æ¥åœ¨ä¸€èµ·çš„ã€‚&lt;/p>
&lt;/blockquote>&lt;p>æ³¨ï¼šåŒä¸€ä¸ªæƒé™ä¹Ÿå¯ä»¥æ˜¯ä¸åŒçš„ access sectionï¼š&lt;/p></description></item><item><title>å¤šç»§æ‰¿ç»™ C++ å¸¦æ¥äº†å“ªäº›è®¾è®¡è´Ÿæ‹…ï¼Ÿ</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E5%A4%9A%E7%BB%A7%E6%89%BF%E7%BB%99-C++-%E5%B8%A6%E6%9D%A5%E4%BA%86%E5%93%AA%E4%BA%9B%E8%AE%BE%E8%AE%A1%E8%B4%9F%E6%8B%85/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E5%A4%9A%E7%BB%A7%E6%89%BF%E7%BB%99-C++-%E5%B8%A6%E6%9D%A5%E4%BA%86%E5%93%AA%E4%BA%9B%E8%AE%BE%E8%AE%A1%E8%B4%9F%E6%8B%85/</guid><description>&lt;ol>
&lt;li>æŒ‡é’ˆåç§»æœ¬èº«æœ‰å°‘é‡å¼€é”€ï¼Œè‹¥éœ€è¦åç§»åˆ™å¾—å…ˆåˆ¤ç©ºï¼Œè¿™æ ·æ‰èƒ½ä¿è¯ç©ºæŒ‡é’ˆæ°¸è¿œä¸ºç©ºã€‚&lt;/li>
&lt;li>æŒ‡é’ˆåç§»å¯¹è®¾è®¡è™šå‡½æ•°è¡¨å¸¦æ¥äº†å›°éš¾ã€‚ä¾‹å¦‚ &lt;strong>thunk&lt;/strong> æŠ€æœ¯ç”¨æ¥å¯¹ this æŒ‡é’ˆåšé€‚é…å†è°ƒç”¨å¯¹åº”å‡½æ•°ã€‚&lt;/li>
&lt;li>æŒ‡é’ˆåç§»è®©æŒ‡å‘æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆæºå¸¦äº† this åç§»é‡ï¼Œå˜æˆäº†èƒ–æŒ‡é’ˆã€‚&lt;/li>
&lt;li>å¤šç»§æ‰¿å¼•å…¥äº†è±å½¢ç»§æ‰¿å›°å¢ƒï¼Œè¿›è€Œåˆå¼•å…¥äº†è™šæ‹Ÿç»§æ‰¿ã€‚&lt;/li>
&lt;li>è™šæ‹Ÿç»§æ‰¿ä½¿å¾— vtable ä¸­è¿˜è¦å­˜å‚¨è™šåŸºç±»å­å¯¹è±¡çš„åç§»ã€‚ç”±äºä¸åŒç»§æ‰¿ç»“æ„ä¸­ vtable é‡Œè™šåŸºç±»å­å¯¹è±¡çš„åç§»å¯èƒ½ä¸åŒï¼Œåˆå¼•å…¥äº† &lt;strong>VTT&lt;/strong>ï¼Œè®©å­ç±»è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°æ—¶ä¸ºåŸºç±»çš„æ„é€ å‡½æ•°æä¾› vptr å‚æ•°ã€‚&lt;/li>
&lt;/ol></description></item><item><title>å¤šç»§æ‰¿ä¸‹çš„è™šå‡½æ•°</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E5%A4%9A%E7%BB%A7%E6%89%BF%E4%B8%8B%E7%9A%84%E8%99%9A%E5%87%BD%E6%95%B0/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E5%A4%9A%E7%BB%A7%E6%89%BF%E4%B8%8B%E7%9A%84%E8%99%9A%E5%87%BD%E6%95%B0/</guid><description>&lt;h1 id="å¤šç»§æ‰¿ä¸‹é‡è½½ç­¾åç›¸åŒçš„å‡½æ•°">å¤šç»§æ‰¿ä¸‹é‡è½½ç­¾åç›¸åŒçš„å‡½æ•°
&lt;a class="header-anchor" href="#%e5%a4%9a%e7%bb%a7%e6%89%bf%e4%b8%8b%e9%87%8d%e8%bd%bd%e7%ad%be%e5%90%8d%e7%9b%b8%e5%90%8c%e7%9a%84%e5%87%bd%e6%95%b0">&lt;/a>
&lt;/h1>&lt;p>






&lt;img src="https://hxhue.github.io/assets/7bd760c39d3ddb901cc71b7795369680.webp">&lt;/p>
&lt;p>ç»“æœæ˜¯&lt;strong>ä¼šæŠŠåŸºç±»åŒç­¾åçš„æ‰€æœ‰é final è™šå‡½æ•°éƒ½é‡å†™äº†&lt;/strong>ï¼Œè€Œä¸”å®ç°æ–¹å¼ç›¸åŒã€‚å°½ç®¡åŸºç±»çš„è™šå‡½æ•°ç­¾åä¸€æ ·ï¼Œä½†æ˜¯ä»–ä»¬æ²¡æœ‰å…³è”æ€§ï¼Œæ‰€ä»¥åœ¨å­ç±»çš„è™šè¡¨ä¸­å ä¸¤ä¸ªæ§½ï¼ˆslotsï¼‰ï¼ˆä¸€ä¸ªæ§½æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼‰ã€‚åŒæ ·çš„ï¼Œå¦‚æœ Interface ä¸­æœ‰è™šå‡½æ•° fooï¼Œè€Œ A å’Œ B éƒ½ç»§æ‰¿äº† Interfaceï¼ŒC ç»§æ‰¿äº† A å’Œ Bã€‚å¦‚æœ A å’Œ B æ²¡æœ‰è™šæ‹Ÿç»§æ‰¿ Interfaceï¼Œé‚£ä¹ˆåœ¨ C çš„å¯¹è±¡è°ƒç”¨å‡½æ•° foo æ—¶å°†å‡ºç° ambiguous æŒ‡ä»£é”™è¯¯ã€‚å¦‚æœ C é‡å†™äº† foo å‡½æ•°ï¼Œé‚£ä¹ˆæŒ‡ä»£å°±è¿˜æ˜¯æ˜ç¡®çš„ã€‚&lt;strong>æˆ–è€…ï¼Œå¦‚æœ A å’Œ B éƒ½æ˜¯è™šæ‹Ÿç»§æ‰¿è‡ª Interfaceï¼Œé‚£ä¹ˆä¹Ÿä¸ä¼šæœ‰ç¼–è¯‘é”™è¯¯&lt;/strong>ã€‚ä½†è¿™æ ·é€šè¿‡æŒ‡é’ˆ/å¼•ç”¨è°ƒç”¨è™šå‡½æ•° foo å°±éœ€è¦å…ˆå–è™šåŸºç±»å­å¯¹è±¡ this çš„åç§»ï¼Œä¿®æ”¹ this ä¹‹åå†ä» vptr ä¸­è¯»è™šå‡½æ•° fooï¼Œå¼€é”€æ˜¯ 4 æ¬¡è®¿å­˜ï¼ˆå°†è™šæ‹Ÿç»§æ‰¿å’Œè™šå‡½æ•°è°ƒç”¨çš„ä»£ä»·ç´¯åŠ èµ·æ¥äº†ï¼‰ ã€‚&lt;/p></description></item><item><title>å¤šç»§æ‰¿ä¸‹çš„æŒ‡é’ˆè½¬æ¢</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E5%A4%9A%E7%BB%A7%E6%89%BF%E4%B8%8B%E7%9A%84%E6%8C%87%E9%92%88%E8%BD%AC%E6%8D%A2/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E5%A4%9A%E7%BB%A7%E6%89%BF%E4%B8%8B%E7%9A%84%E6%8C%87%E9%92%88%E8%BD%AC%E6%8D%A2/</guid><description>&lt;p>è¦æ³¨æ„ç©ºæŒ‡é’ˆæ˜¯ç‰¹æ®Šæƒ…å†µï¼š&lt;/p>
&lt;p>






&lt;img src="https://hxhue.github.io/assets/b91cf97c72043857b03f7b43bb65feac.webp">&lt;/p></description></item><item><title>å¤åˆ¶æ„é€ å’Œèµ‹å€¼è¿ç®—ç¬¦</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E5%A4%8D%E5%88%B6%E6%9E%84%E9%80%A0%E5%92%8C%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E5%A4%8D%E5%88%B6%E6%9E%84%E9%80%A0%E5%92%8C%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6/</guid><description>&lt;h1 id="vptr">vptr
&lt;a class="header-anchor" href="#vptr">&lt;/a>
&lt;/h1>&lt;p>è¿™ä¸ªå°èŠ‚æ²¡æœ‰æåˆ° vptr çš„å¤„ç†ã€‚&lt;/p>
&lt;ol>
&lt;li>å¯¹äºå¤åˆ¶æ„é€ å‡½æ•°ï¼Œå…¶æœ¬è´¨è¿˜æ˜¯æ„é€ ï¼Œæ‰€ä»¥å’Œä¸€èˆ¬çš„æ„é€ å‡½æ•°æµç¨‹ç›¸ä¼¼ï¼Œä¼šæ­£ç¡®è®¾ç½®å¥½ vptrã€‚&lt;/li>
&lt;li>å¯¹äºèµ‹å€¼è¿ç®—ç¬¦ï¼ŒåŸæœ‰ vptr å’Œæ–°çš„ vptr æ˜¯ä¸€æ ·çš„ï¼Œä¸éœ€è¦ä¿®æ”¹ã€‚&lt;/li>
&lt;/ol>
&lt;h1 id="æ€ä¹ˆå†™å¤åˆ¶æ„é€ èµ‹å€¼">æ€ä¹ˆå†™å¤åˆ¶æ„é€ /èµ‹å€¼ï¼Ÿ
&lt;a class="header-anchor" href="#%e6%80%8e%e4%b9%88%e5%86%99%e5%a4%8d%e5%88%b6%e6%9e%84%e9%80%a0%e8%b5%8b%e5%80%bc">&lt;/a>
&lt;/h1>&lt;p>å†™å¤åˆ¶æ„é€ å‡½æ•°å’Œå¤åˆ¶èµ‹å€¼æ“ä½œç¬¦çš„æ—¶å€™è¦è®°å¾—æŠŠåŸºç±»å’Œæˆå‘˜éƒ½æ­£ç¡®åˆå§‹åŒ–ï¼ˆ&lt;strong>ç”¨é»˜è®¤çš„æœ€å¥½&lt;/strong>ï¼‰ã€‚å¤åˆ¶æ„é€ å‡½æ•°ä¹Ÿç®—æ˜¯æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥è¦ä½¿ç”¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨æ¥æ­£ç¡®åˆå§‹åŒ–ã€‚&lt;/p></description></item><item><title>æ„é€ å‡½æ•°çš„æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E6%88%90%E5%91%98%E5%88%9D%E5%A7%8B%E5%8C%96%E5%88%97%E8%A1%A8/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E6%88%90%E5%91%98%E5%88%9D%E5%A7%8B%E5%8C%96%E5%88%97%E8%A1%A8/</guid><description>&lt;p>åˆå§‹åŒ–ä¼šæŒ‰ç…§å˜é‡å£°æ˜çš„é¡ºåºè¿›è¡Œã€‚å› æ­¤è™½ç„¶ä¸‹é¢çš„ä»£ç æƒ³è¦ç”¨ j çš„æ–°å€¼åˆå§‹åŒ– iï¼Œä½†å®é™…ä¸Šæ˜¯ &lt;code>i(j)&lt;/code> å…ˆè¢«æ‰§è¡Œï¼Œç„¶åæ‰æ˜¯ &lt;code>j(val)&lt;/code>ã€‚&lt;/p>
&lt;p>






&lt;img src="https://hxhue.github.io/assets/06ab52d0a31a5f56f772342fefe137d6.webp">&lt;/p>
&lt;p>ä¸è¿‡ï¼Œæ„é€ å‡½æ•°ä»£ç å—ä¸­çš„åˆå§‹åŒ–è¿‡ç¨‹å§‹ç»ˆå‘ç”Ÿäºæˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ä¹‹åã€‚&lt;/p></description></item><item><title>é™æ€æˆå‘˜å‡½æ•°</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E9%9D%99%E6%80%81%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E9%9D%99%E6%80%81%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0/</guid><description>&lt;h1 id="é™æ€æˆå‘˜å‡½æ•°å‡ºç°ä¹‹å‰">é™æ€æˆå‘˜å‡½æ•°å‡ºç°ä¹‹å‰
&lt;a class="header-anchor" href="#%e9%9d%99%e6%80%81%e6%88%90%e5%91%98%e5%87%bd%e6%95%b0%e5%87%ba%e7%8e%b0%e4%b9%8b%e5%89%8d">&lt;/a>
&lt;/h1>&lt;p>å¾ˆä¹…ä»¥å‰æ²¡æœ‰é™æ€æˆå‘˜å‡½æ•°ï¼ˆç›´åˆ° Cfront 2.0 æ‰åŠ å…¥ï¼‰ï¼Œé‚£ä¸ªæ—¶å€™é™æ€æ–¹æ³•å¯ä»¥ç”¨è¿™ç§æ–¹å¼è°ƒç”¨ï¼š&lt;/p>
&lt;p>






&lt;img src="https://hxhue.github.io/assets/07580994615633018e06f05426e98683.webp">&lt;/p>
&lt;p>è¯¥æ–¹æ³•æ²¡æœ‰é€šè¿‡ this è®¿å­˜ï¼Œå› è€Œä¸ä¼šå‡ºç°æ®µé”™è¯¯ã€‚å°½ç®¡è¿™ç§æ–¹æ³•è¿˜åœ¨æŸäº›ç¼–è¯‘å™¨ä¸Šèƒ½å¤Ÿä½¿ç”¨ï¼Œ&lt;strong>ä½†è¿™ç§å†™æ³•åœ¨ç°åœ¨æ˜¯æœªå®šä¹‰è¡Œä¸º&lt;/strong>ã€‚&lt;/p></description></item><item><title>ç±»å®šä¹‰ä¸­çš„ç±»å‹åå¯è§æ€§</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E7%B1%BB%E5%AE%9A%E4%B9%89%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%90%8D%E5%8F%AF%E8%A7%81%E6%80%A7/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E7%B1%BB%E5%AE%9A%E4%B9%89%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%90%8D%E5%8F%AF%E8%A7%81%E6%80%A7/</guid><description>&lt;p>å°½ç®¡ç°åœ¨çš„ç¼–è¯‘å™¨èƒ½å¤Ÿæ­£ç¡®ç†è§£æ•°æ®æˆå‘˜ï¼ˆå«æœ‰éšå¼çš„ this æŒ‡é’ˆï¼‰çš„ä½¿ç”¨ï¼Œå¹¶åœ¨çœ‹åˆ°æ•´ä¸ªç±»å®šä¹‰ä¹‹åå†æŸ¥æ‰¾åå­—ï¼Œç±»å‹åçš„æŸ¥æ‰¾åˆ™å‘ç”Ÿçš„å¾ˆæ—©ï¼Œå¯¼è‡´ä½¿ç”¨æ—¶å¯èƒ½çœ‹ä¸åˆ°ã€æˆ–è€…ä½¿ç”¨äº†é”™è¯¯çš„ç±»å‹å£°æ˜ã€‚&lt;/p></description></item><item><title>å®Œæ•´æ„é€ å‡½æ•°çš„åˆå§‹åŒ–é¡ºåº</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E5%AE%8C%E6%95%B4%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%BA%E5%BA%8F/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E5%AE%8C%E6%95%B4%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%BA%E5%BA%8F/</guid><description>&lt;p>æ„é€ å‡½æ•°åˆ†ä¸ºå®Œæ•´æ„é€ å‡½æ•°ï¼ˆComplete Object Constructorï¼‰å’ŒåŸºç±»æ„é€ å‡½æ•°ï¼ˆBase Object Constructorï¼‰ã€‚&lt;/p>
&lt;h1 id="åˆå§‹åŒ–é¡ºåº">åˆå§‹åŒ–é¡ºåº
&lt;a class="header-anchor" href="#%e5%88%9d%e5%a7%8b%e5%8c%96%e9%a1%ba%e5%ba%8f">&lt;/a>
&lt;/h1>&lt;p>æ˜¾å¼æ„é€ ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™è°ƒç”¨çš„æ˜¯å®Œæ•´æ„é€ å‡½æ•°ã€‚è¯¥å‡½æ•°æ‰§è¡Œçš„åˆå§‹åŒ–æµç¨‹å¦‚ä¸‹ï¼š&lt;/p></description></item><item><title>ææ„å‡½æ•°</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0/</guid><description>&lt;p>ææ„å‡½æ•°å’Œæ„é€ å‡½æ•°ä¸€æ ·ï¼Œä¹Ÿåˆ†å®Œæ•´ææ„å‡½æ•°å’ŒåŸºç±»ææ„å‡½æ•°ä¸¤ç§ã€‚è€Œä¸”ææ„å‡½æ•°çš„å·¥ä½œæµç¨‹å’Œæ„é€ å‡½æ•°ç›¸åã€‚&lt;/p>
&lt;p>å¦‚æœä¸€ä¸ªç±»çš„åŸºç±»æœ‰æœªå®ç°çš„ææ„å‡½æ•°ï¼ˆæœªæä¾›å®šä¹‰æˆ–è€…æ˜¯çº¯è™šå‡½æ•°ï¼‰ï¼Œä¼šå¯¼è‡´é“¾æ¥å¤±è´¥ã€‚è¿™æ˜¯å› ä¸ºå­ç±»çš„ææ„å‡½æ•°æœ‰è°ƒç”¨åŸºç±»ææ„å‡½æ•°çš„é€»è¾‘ï¼&lt;/p></description></item><item><title>è™šæ‹Ÿç»§æ‰¿</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E8%99%9A%E6%8B%9F%E7%BB%A7%E6%89%BF/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E8%99%9A%E6%8B%9F%E7%BB%A7%E6%89%BF/</guid><description>&lt;h1 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ
&lt;a class="header-anchor" href="#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5">&lt;/a>
&lt;/h1>&lt;p>






&lt;img src="https://hxhue.github.io/assets/9af2a15e034c9be3cf15b35c0525e241.webp">&lt;/p>
&lt;p>






&lt;img src="https://hxhue.github.io/assets/f28a0c3cd8d9c1ba00bb081453f3f9c6.webp">&lt;/p>
&lt;p>cfront å®ç°&lt;/p>
&lt;p>






&lt;img src="https://hxhue.github.io/assets/9d2a24e047f5cb0385a5aa819156d4db.webp">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#719e07">#include&lt;/span> &lt;span style="color:#719e07">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span style="color:#719e07">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#719e07">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#719e07">struct&lt;/span> &lt;span style="color:#268bd2">X&lt;/span> { &lt;span style="color:#719e07">public&lt;/span>&lt;span style="color:#719e07">:&lt;/span> &lt;span style="color:#dc322f">int&lt;/span> i; }; &lt;span style="color:#586e75">// size: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#586e75">&lt;/span>&lt;span style="color:#719e07">struct&lt;/span> &lt;span style="color:#268bd2">A&lt;/span>&lt;span style="color:#719e07">:&lt;/span> &lt;span style="color:#719e07">virtual&lt;/span> X { &lt;span style="color:#dc322f">int&lt;/span> j; }; &lt;span style="color:#586e75">// size: 16
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#586e75">&lt;/span>&lt;span style="color:#719e07">struct&lt;/span> &lt;span style="color:#268bd2">B&lt;/span>&lt;span style="color:#719e07">:&lt;/span> &lt;span style="color:#719e07">virtual&lt;/span> X { &lt;span style="color:#dc322f">double&lt;/span> d; }; &lt;span style="color:#586e75">// size: 24
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#586e75">&lt;/span>&lt;span style="color:#719e07">struct&lt;/span> &lt;span style="color:#268bd2">C&lt;/span>&lt;span style="color:#719e07">:&lt;/span> A, B { &lt;span style="color:#dc322f">int&lt;/span> k; }; &lt;span style="color:#586e75">// size: 40
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#586e75">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#dc322f">int&lt;/span> &lt;span style="color:#268bd2">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> C c;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#719e07">::&lt;/span>cout &lt;span style="color:#719e07">&amp;lt;&amp;lt;&lt;/span> c.i &lt;span style="color:#719e07">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#2aa198">&amp;#39;\n&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœæŠŠ A æˆ–è€… B çš„ virtual ç»§æ‰¿å±æ€§åˆ é™¤å°±ä¼šå‡ºç° ambiguous æŒ‡ä»£é”™è¯¯ã€‚å› ä¸º virtual ç»§æ‰¿åªä¿å­˜åŸºç±»çš„ä¸€ä»½æ•°æ®ï¼Œåˆ æ‰ä¹‹åè‡ªç„¶å°±æœ‰å¤šä»½å˜é‡ i äº†ã€‚ä¸è¿‡ï¼Œ&lt;strong>virtual ç»§æ‰¿å¹¶ä¸ä»£è¡¨è¯¥ç±»ä¸ºå¤šæ€ç±»ï¼ˆå¯ç”¨ type traits åˆ¤æ–­ï¼‰&lt;/strong>ã€‚&lt;/p></description></item><item><title>è™šæ‹Ÿç»§æ‰¿å’Œè™šå‡½æ•°å¯¹æ¯”</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E8%99%9A%E6%8B%9F%E7%BB%A7%E6%89%BF%E5%92%8C%E8%99%9A%E5%87%BD%E6%95%B0%E5%AF%B9%E6%AF%94/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E8%99%9A%E6%8B%9F%E7%BB%A7%E6%89%BF%E5%92%8C%E8%99%9A%E5%87%BD%E6%95%B0%E5%AF%B9%E6%AF%94/</guid><description>&lt;h1 id="ç›®çš„ä¸åŒ">ç›®çš„ä¸åŒ
&lt;a class="header-anchor" href="#%e7%9b%ae%e7%9a%84%e4%b8%8d%e5%90%8c">&lt;/a>
&lt;/h1>&lt;p>è™šæ‹Ÿç»§æ‰¿ç”¨æ¥åŠ¨æ€è®¿é—®æ•°æ®ï¼ˆèŠ‚çº¦å­˜å‚¨ç©ºé—´æˆ–ä¿è¯æ•°æ®åœ°å€å”¯ä¸€ï¼‰ï¼Œè™šå‡½æ•°ç”¨æ¥åŠ¨æ€è®¿é—®æ–¹æ³•ã€‚&lt;/p>
&lt;h1 id="è™šè¡¨çš„è®¿é—®æ–¹å¼">è™šè¡¨çš„è®¿é—®æ–¹å¼
&lt;a class="header-anchor" href="#%e8%99%9a%e8%a1%a8%e7%9a%84%e8%ae%bf%e9%97%ae%e6%96%b9%e5%bc%8f">&lt;/a>
&lt;/h1>&lt;p>å¦‚æœ A ç±»æœ‰è™šå‡½æ•°ï¼Œé‚£ä¹ˆ A ç±»å·²ç»æœ‰ vptrã€æ˜¯å¤šæ€ç±»ï¼Œé€šè¿‡ A ç±»æŒ‡é’ˆ/å¼•ç”¨è®¿é—®è™šå‡½æ•°åˆ™éœ€è¦æŸ¥æ‰¾è™šè¡¨ã€‚&lt;/p></description></item><item><title>å¼‚å¸¸å¤„ç†</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/</guid><description>&lt;p>æœ‰äººè¯´ä» Cfront è½¬å‘ä¸“é—¨çš„ C++ ç¼–è¯‘å™¨çš„ä¸€å¤§åŸå› å°±æ˜¯æ”¯æŒå¼‚å¸¸å¤„ç†ï¼Œå› ä¸ºå¼‚å¸¸å¤„ç†åœ¨ C è¯­è¨€ä¸­å¾ˆéš¾åšã€‚&lt;/p>
&lt;p>ä¸€ä¸ªå‡½æ•°çš„æŒ‡ä»¤åŒºåŸŸåˆ†æˆä¸‰ç§ï¼š&lt;/p>
&lt;ol>
&lt;li>try ä»¥å¤–ï¼Œä¸”æ²¡æœ‰æ´»è·ƒå¯¹è±¡&lt;/li>
&lt;li>try ä»¥å¤–ï¼Œæœ‰æ´»è·ƒå¯¹è±¡ï¼Œå‘ç”Ÿå¼‚å¸¸æ—¶éœ€è¦ææ„&lt;/li>
&lt;li>try ä»¥å†…&lt;/li>
&lt;/ol>
&lt;blockquote>
 &lt;p>æœ‰ä¸€ä¸ªæ´»è·ƒå¯¹è±¡å’Œä¸¤ä¸ªæ´»è·ƒå¯¹è±¡åº”è¯¥ä¼šæœ‰åŒºåˆ«å§ï¼Ÿè¿™æ ·åˆ¶è¡¨/æŸ¥è¡¨çš„å‹åŠ›å¾ˆå¤§ã€‚&lt;/p></description></item><item><title>æŒ‡å‘æˆå‘˜çš„æŒ‡é’ˆ</title><link>https://hxhue.github.io/inside-the-cpp-object-model/%E6%8C%87%E5%90%91%E6%88%90%E5%91%98%E7%9A%84%E6%8C%87%E9%92%88/</link><pubDate>Sat, 12 Aug 2023 00:00:00 +0800</pubDate><guid>https://hxhue.github.io/inside-the-cpp-object-model/%E6%8C%87%E5%90%91%E6%88%90%E5%91%98%E7%9A%84%E6%8C%87%E9%92%88/</guid><description>&lt;p>å‚è€ƒ &lt;a href="https://itanium-cxx-abi.github.io/cxx-abi/abi.html#member-pointers" title="https://itanium-cxx-abi.github.io/cxx-abi/abi.html#member-pointers" rel="noopener external nofollow noreferrer"
 target="_blank" class=" exturl" >https://itanium-cxx-abi.github.io/cxx-abi/abi.html#member-pointers&lt;i class="fa fa-external-link-alt">&lt;/i>&lt;/a>ã€‚&lt;/p>
&lt;h1 id="å‘ä¸‹è½¬æ¢çš„èƒ½åŠ›">å‘ä¸‹è½¬æ¢çš„èƒ½åŠ›ï¼
&lt;a class="header-anchor" href="#%e5%90%91%e4%b8%8b%e8%bd%ac%e6%8d%a2%e7%9a%84%e8%83%bd%e5%8a%9b">&lt;/a>
&lt;/h1>&lt;p>å’Œç±»çš„æŒ‡é’ˆ/å¼•ç”¨çš„è½¬æ¢ä¸åŒï¼ŒæŒ‡å‘æˆå‘˜çš„æŒ‡é’ˆæ—¢å¯ä»¥&lt;strong>å‘ä¸‹è½¬&lt;/strong>ï¼Œåˆå¯ä»¥å‘ä¸Šè½¬ï¼åªéœ€è¦ç›®çš„ç±»å‹æ‹¥æœ‰å¯¹åº”çš„æˆå‘˜å³å¯ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#719e07">struct&lt;/span> &lt;span style="color:#268bd2">A&lt;/span> { &lt;span style="color:#dc322f">long&lt;/span> a; };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#719e07">struct&lt;/span> &lt;span style="color:#268bd2">B&lt;/span>&lt;span style="color:#719e07">:&lt;/span> A { &lt;span style="color:#dc322f">long&lt;/span> b; };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#dc322f">int&lt;/span> &lt;span style="color:#268bd2">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#586e75">// long (A::*p) = &amp;amp;B::b; // é”™è¯¯ï¼ŒA ç±»å‹æ²¡æœ‰æˆå‘˜ B::b
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#586e75">&lt;/span> &lt;span style="color:#dc322f">long&lt;/span> (A&lt;span style="color:#719e07">::*&lt;/span>q) &lt;span style="color:#719e07">=&lt;/span> &lt;span style="color:#719e07">&amp;amp;&lt;/span>B&lt;span style="color:#719e07">::&lt;/span>a; &lt;span style="color:#586e75">// B::a å’Œ A::a æ˜¯ç›¸åŒçš„
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#586e75">&lt;/span> &lt;span style="color:#dc322f">long&lt;/span> (B&lt;span style="color:#719e07">::*&lt;/span>r) &lt;span style="color:#719e07">=&lt;/span> &lt;span style="color:#719e07">&amp;amp;&lt;/span>A&lt;span style="color:#719e07">::&lt;/span>a; &lt;span style="color:#586e75">// å‘ä¸‹è½¬
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#586e75">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="æŒ‡å‘æ•°æ®æˆå‘˜">æŒ‡å‘æ•°æ®æˆå‘˜
&lt;a class="header-anchor" href="#%e6%8c%87%e5%90%91%e6%95%b0%e6%8d%ae%e6%88%90%e5%91%98">&lt;/a>
&lt;/h1>&lt;p>éœ€è¦å­˜å‚¨ this åç½®ï¼ŒæŒ‰ç…§ Itanium C++ ABIï¼Œå­˜å‚¨çš„ç±»å‹ä¸º &lt;strong>ptrdiff_t&lt;/strong>ã€‚ä¸€èˆ¬æ•°æ®æˆå‘˜æŒ‡é’ˆå°±ç”¨å…¶ç›¸å¯¹äºå¼€å¤´çš„åç§»ä½œä¸ºæŒ‡é’ˆçš„å€¼ï¼Œè€Œç©ºæŒ‡é’ˆåˆ™ç”¨ &lt;strong>-1&lt;/strong> è¡¨ç¤ºã€‚&lt;/p></description></item></channel></rss>