<!doctype html><html lang=zh-CN data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.143.1"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="CTTCG 15 Template Argument Deduction"><meta itemprop=description content="ä¸ªäººåšå®¢ï¼Œä¸»è¦æ˜¯é›¶æ•£çš„ç¬”è®°ã€‚"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://hxhue.github.io/imgs/371907.jpg"><meta itemprop=keywords content="cpp,cpp-templates-the-complete-guide"><link type=text/css rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css><link rel=stylesheet href=/css/main.min.bea76f574a755574e17d42bea39502a74ca3ca4db65807b8c82d3e26dcec8420.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ æˆ‘å¯æ˜¯æœ‰åº•çº¿çš„å“Ÿ ~"}</style><link rel=stylesheet type=text/css href=/css/style.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/github-markdown-css@5.3.0/github-markdown-dark.css><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js></script><script>MathJax={tex:{displayMath:[["$$","$$"],["\\[","\\]"]],inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: false });
  mermaid.mermaidAPI.initialize();
  window.mermaid = mermaid;
</script><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":false,"isHome":false,"isPage":true,"path":"15-Template-Argument-Deduction","permalink":"https://hxhue.github.io/cpp-templates-the-complete-guide/15-Template-Argument-Deduction/","title":"CTTCG 15 Template Argument Deduction","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>CTTCG 15 Template Argument Deduction - Bluegill</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Bluegill</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description></p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href=/about/ class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>å…³äº</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>å½’æ¡£</a></li><li class="menu-item menu-item-categories"><a href=/categories/ class=hvr-icon-pulse rel=section><i class="fa fa-th hvr-icon"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-hashtag hvr-icon"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-daily"><a href=/daily/ class=hvr-icon-pulse rel=section><i class="fa fa-newspaper hvr-icon"></i>éšç¬”</a></li><li class="menu-item menu-item-discovery"><a href=https://rift-fear-f2c.notion.site/2025-1e354a33cfb1802c841bdf29f2f3dab3 class=hvr-icon-pulse rel=section><i class="fa fa-compass hvr-icon"></i>å‘ç°</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>æœç´¢</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=æœç´¢... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>æ–‡ç« ç›®å½•</li><li class=sidebar-nav-overview>ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#æ¨å¯¼ä¸Šä¸‹æ–‡deduced-context>æ¨å¯¼ä¸Šä¸‹æ–‡ï¼šDeduced Context</a></li><li><a href=#å¦‚ä½•æ¨å¯¼å‡ºæ¨¡æ¿å‚æ•°>å¦‚ä½•æ¨å¯¼å‡ºæ¨¡æ¿å‚æ•°</a></li><li><a href=#ç‰¹ä¾‹åˆå§‹åŒ–åˆ—è¡¨>ç‰¹ä¾‹ï¼šåˆå§‹åŒ–åˆ—è¡¨</a></li><li><a href=#ç‰¹ä¾‹å˜å‚åˆ—è¡¨å‚æ•°åŒ…>ç‰¹ä¾‹ï¼šå˜å‚åˆ—è¡¨/å‚æ•°åŒ…</a></li><li><a href=#ç‰¹ä¾‹å­—é¢é‡æ“ä½œç¬¦æ¨¡æ¿>ç‰¹ä¾‹ï¼šå­—é¢é‡æ“ä½œç¬¦æ¨¡æ¿</a><ul><li><a href=#æ•´æ•°-n>æ•´æ•° n</a></li><li><a href=#æµ®ç‚¹æ•°-f>æµ®ç‚¹æ•° f</a></li><li><a href=#å­—ç¬¦ä¸²-stré•¿åº¦ä¸º-len>å­—ç¬¦ä¸² strï¼Œé•¿åº¦ä¸º len</a></li><li><a href=#å­—ç¬¦-ch>å­—ç¬¦ ch</a></li></ul></li><li><a href=#ç‰¹ä¾‹é»˜è®¤å‚æ•°>ç‰¹ä¾‹ï¼šé»˜è®¤å‚æ•°</a></li><li><a href=#å¼•ç”¨ç±»å‹>å¼•ç”¨ç±»å‹</a></li><li><a href=#å®Œç¾è½¬å‘>å®Œç¾è½¬å‘</a><ul><li><a href=#ç±»å‹æ¨å¯¼>ç±»å‹æ¨å¯¼</a></li><li><a href=#ç¦ç”¨å®Œç¾è½¬å‘>ç¦ç”¨å®Œç¾è½¬å‘</a></li></ul></li><li><a href=#ç«‹å³ä¸Šä¸‹æ–‡immediate-context>ç«‹å³ä¸Šä¸‹æ–‡ï¼ˆimmediate contextï¼‰</a><ul><li><a href=#ç±»æ¨¡æ¿å®šä¹‰ä¸æ˜¯ç«‹å³ä¸Šä¸‹æ–‡>ç±»æ¨¡æ¿å®šä¹‰ä¸æ˜¯ç«‹å³ä¸Šä¸‹æ–‡</a></li><li><a href=#å¼‚å¸¸å£°æ˜ä¸æ˜¯ç«‹å³ä¸Šä¸‹æ–‡>å¼‚å¸¸å£°æ˜ä¸æ˜¯ç«‹å³ä¸Šä¸‹æ–‡</a></li></ul></li><li><a href=#auto-å…³é”®å­—>auto å…³é”®å­—</a><ul><li><a href=#æ„é€ ä¸€ä¸ªèƒ½å¤Ÿæ“ä½œå¯¹è±¡æˆå‘˜è‡ªå¢çš„-handle>æ„é€ ä¸€ä¸ªèƒ½å¤Ÿæ“ä½œå¯¹è±¡æˆå‘˜è‡ªå¢çš„ handle</a></li><li><a href=#å¼ºåˆ¶-auto-æ¨å¯¼ä¸­æ‰€æœ‰å‚æ•°ç±»å‹ä¸€è‡´>å¼ºåˆ¶ <code>auto...</code> æ¨å¯¼ä¸­æ‰€æœ‰å‚æ•°ç±»å‹ä¸€è‡´</a></li><li><a href=#decltypeauto><code>decltype(auto)</code></a></li><li><a href=#ä½¿ç”¨ä¸€ä¸ª-auto-å£°æ˜å¤šä¸ªå˜é‡>ä½¿ç”¨ä¸€ä¸ª <code>auto</code> å£°æ˜å¤šä¸ªå˜é‡</a></li><li><a href=#è¿”å›å€¼ç”¨-auto-æ¨å¯¼ä½†å‡½æ•°æœ‰å¤šä¸ªåˆ†æ”¯>è¿”å›å€¼ç”¨ <code>auto</code> æ¨å¯¼ï¼Œä½†å‡½æ•°æœ‰å¤šä¸ªåˆ†æ”¯</a></li><li><a href=#auto-ç±»å‹æ¨å¯¼æ„æˆå¾ªç¯ä¾èµ–><code>auto</code> ç±»å‹æ¨å¯¼æ„æˆå¾ªç¯ä¾èµ–</a></li></ul></li><li><a href=#ç»“æ„åŒ–ç»‘å®šstructured-binding>ç»“æ„åŒ–ç»‘å®šï¼ˆStructured Bindingï¼‰</a></li><li><a href=#class-template-argument-deduction-ctad>Class template argument deduction (CTAD)</a><ul><li><a href=#å•æ‹¬å·åˆå§‹åŒ–æ›´åå‘å¤åˆ¶ç§»åŠ¨æ„é€ >å•æ‹¬å·åˆå§‹åŒ–æ›´åå‘å¤åˆ¶/ç§»åŠ¨æ„é€ </a></li><li><a href=#åŸå§‹æ¨¡æ¿ç±»æœ‰éšå¼æ¨å¯¼è§„åˆ™>åŸå§‹æ¨¡æ¿ç±»æœ‰éšå¼æ¨å¯¼è§„åˆ™</a></li><li><a href=#injected-class-names>Injected Class Names</a></li><li><a href=#forwarding-references>Forwarding References</a></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=ğŸ¤– src=/imgs/371907.jpg><p class=site-author-name itemprop=name>ğŸ¤–</p><div class=site-description itemprop=description>ä¸ªäººåšå®¢ï¼Œä¸»è¦æ˜¯é›¶æ•£çš„ç¬”è®°ã€‚</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>433</span>
<span class=site-state-item-name>æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>12</span>
<span class=site-state-item-name>åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>86</span>
<span class=site-state-item-name>æ ‡ç­¾</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/hxhue title="Github â†’ https://github.com/hxhue" rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>
Github
</a></span><span class=links-of-social-item><a href=/rss.xml title="RSS è®¢é˜… â†’ /rss.xml" rel=noopener target=_blank><i class="fa fa-rss fa-fw"></i>
RSS è®¢é˜…</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=å…±äº«çŸ¥è¯†><img src=/imgs/cc/big/by_nc_sa.svg alt=å…±äº«çŸ¥è¯†></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
å‹æƒ…é“¾æ¥</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://shuai.guru/ title=https://shuai.guru/ target=_blank>shuai.guru</a></li></ul></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=toggle-theme class=button title=æ·±æµ…æ¨¡å¼åˆ‡æ¢><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=è¿”å›é¡¶éƒ¨><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://hxhue.github.io/cpp-templates-the-complete-guide/15-Template-Argument-Deduction/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/371907.jpg"><meta itemprop=name content="ğŸ¤–"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="ğŸ¤–"><meta itemprop=description content="ä¸ªäººåšå®¢ï¼Œä¸»è¦æ˜¯é›¶æ•£çš„ç¬”è®°ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="CTTCG 15 Template Argument Deduction"><meta itemprop=description content="2023 å¹´ 5 æœˆ 17 æ—¥
æ¨å¯¼ä¸Šä¸‹æ–‡ï¼šDeduced Context

P272 ä¹¦ä¸Š

ä¾èµ–äºæ¨¡æ¿ç±»å‹çš„å­ç±»å‹ä¸æ˜¯æ¨å¯¼ä¸Šä¸‹æ–‡ã€‚æ¯”å¦‚ typename X<N>::I ä¸æ˜¯ã€‚è€Œ X<N>::* è¿™æ ·çš„æŒ‡å‘æˆå‘˜çš„æŒ‡é’ˆæ²¡æœ‰ç”¨åˆ°å­ç±»å‹ï¼Œæ‰€ä»¥æ˜¯æ¨å¯¼ä¸Šä¸‹æ–‡ã€‚
éç±»å‹æ¨¡æ¿å‚æ•°çš„éå¹³å‡¡è¡¨è¾¾å¼ä¸æ˜¯æ¨å¯¼ä¸Šä¸‹æ–‡ã€‚æ¯”å¦‚æ¨¡æ¿ S å’Œå‚æ•° Iï¼ŒS<I+1> æ— æ³•æä¾›æ¨å¯¼ä¿¡æ¯ã€‚

å¦‚ä½•æ¨å¯¼å‡ºæ¨¡æ¿å‚æ•°


ä»å‚æ•°åˆ—è¡¨ä¸­æ¨å¯¼ï¼ˆæ¨å¯¼èƒ½åŠ›æ˜¯æœ‰é™åˆ¶çš„ï¼Œæ¯”å¦‚ä¸èƒ½ä» typename T::iterator å‚æ•°ä¸­æ¨å‡º T çš„ç±»å‹ï¼‰
å‡½æ•°æ¨¡æ¿è¢«å–åœ°å€æ—¶ï¼Œå¯ä»¥ä»è¦æ±‚çš„è¿”å›å€¼ç±»å‹æ¨å¯¼ï¼š

template<typename T>
void f(T, T);

void (*pf)(char, char) = &amp;f; // fçš„å‚æ•°Tç”±å‡½æ•°æŒ‡é’ˆçš„ç±»å‹ç¡®å®š

éšå¼è½¬æ¢æ“ä½œç¬¦æ¨¡æ¿çš„ç±»å‹å‚æ•° T ç”±éœ€è¦è½¬æ¢æ—¶æ‰€éœ€çš„ç±»å‹å†³å®šã€‚

æ¨¡æ¿å°è¯•åŒ¹é…çš„æ—¶å€™ä¸é€‚ç”¨ common typeã€‚ æ¯”å¦‚ä¸¤ä¸ª T ç±»å‹åˆ†åˆ«è¢«è®¤ä¸ºæ˜¯ int å’Œ double æ—¶ï¼Œä¼šå¯¼è‡´æ¨¡æ¿æ›¿æ¢å¤±è´¥ï¼Œè€Œä¸æ˜¯æŠŠ T è®¤ä¸ºæ˜¯ doubleã€‚æ¯”å¦‚"></span><header class=post-header><h1 class=post-title itemprop="name headline">CTTCG 15 Template Argument Deduction</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-12 00:00:00 +0800 CST" itemprop="dateCreated datePublished" datetime="2023-08-12 00:00:00 +0800 CST">2023-08-12
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar-check"></i>
</span><span class=post-meta-item-text title=æ›´æ–°äº>æ›´æ–°äºï¼š
</span><time title=ä¿®æ”¹æ—¶é—´ï¼š2024-04-08T00:00:00+08:00 itemprop=dateModified datetime=2024-04-08T00:00:00+08:00>2024-04-08</time>
</span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/cpp-templates-the-complete-guide itemprop=url rel=index><span itemprop=name>cpp-templates-the-complete-guide</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=å­—æ•°><span class=post-meta-item-icon><i class="far fa-file-word"></i>
</span><span class=post-meta-item-text>å­—æ•°ï¼š</span>
<span>4035</span>
</span><span class=post-meta-item title=é˜…è¯»><span class=post-meta-item-icon><i class="far fa-clock"></i>
</span><span class=post-meta-item-text>é˜…è¯»ï¼š&ap;</span>
<span>9åˆ†é’Ÿ</span></span></div></div></header><div class=post-body itemprop=articleBody><p>2023 å¹´ 5 æœˆ 17 æ—¥</p><h1 id=æ¨å¯¼ä¸Šä¸‹æ–‡deduced-context>æ¨å¯¼ä¸Šä¸‹æ–‡ï¼šDeduced Context
<a class=header-anchor href=#%e6%8e%a8%e5%af%bc%e4%b8%8a%e4%b8%8b%e6%96%87deduced-context></a></h1><p>P272 ä¹¦ä¸Š</p><ul><li>ä¾èµ–äºæ¨¡æ¿ç±»å‹çš„å­ç±»å‹ä¸æ˜¯æ¨å¯¼ä¸Šä¸‹æ–‡ã€‚æ¯”å¦‚ <code>typename X&lt;N>::I</code> ä¸æ˜¯ã€‚è€Œ <code>X&lt;N>::*</code> è¿™æ ·çš„æŒ‡å‘æˆå‘˜çš„æŒ‡é’ˆæ²¡æœ‰ç”¨åˆ°å­ç±»å‹ï¼Œæ‰€ä»¥æ˜¯æ¨å¯¼ä¸Šä¸‹æ–‡ã€‚</li><li>éç±»å‹æ¨¡æ¿å‚æ•°çš„éå¹³å‡¡è¡¨è¾¾å¼ä¸æ˜¯æ¨å¯¼ä¸Šä¸‹æ–‡ã€‚æ¯”å¦‚æ¨¡æ¿ <code>S</code> å’Œå‚æ•° <code>I</code>ï¼Œ<code>S&lt;I+1></code> æ— æ³•æä¾›æ¨å¯¼ä¿¡æ¯ã€‚</li></ul><h1 id=å¦‚ä½•æ¨å¯¼å‡ºæ¨¡æ¿å‚æ•°>å¦‚ä½•æ¨å¯¼å‡ºæ¨¡æ¿å‚æ•°
<a class=header-anchor href=#%e5%a6%82%e4%bd%95%e6%8e%a8%e5%af%bc%e5%87%ba%e6%a8%a1%e6%9d%bf%e5%8f%82%e6%95%b0></a></h1><ol><li>ä»å‚æ•°åˆ—è¡¨ä¸­æ¨å¯¼ï¼ˆæ¨å¯¼èƒ½åŠ›æ˜¯æœ‰é™åˆ¶çš„ï¼Œæ¯”å¦‚ä¸èƒ½ä» <code>typename T::iterator</code> å‚æ•°ä¸­æ¨å‡º <code>T</code> çš„ç±»å‹ï¼‰</li><li>å‡½æ•°æ¨¡æ¿è¢«å–åœ°å€æ—¶ï¼Œå¯ä»¥ä»è¦æ±‚çš„è¿”å›å€¼ç±»å‹æ¨å¯¼ï¼š</li></ol><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span> T<span style=color:#719e07>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#dc322f>void</span> f(T, T);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#dc322f>void</span> (<span style=color:#719e07>*</span>pf)(<span style=color:#dc322f>char</span>, <span style=color:#dc322f>char</span>) <span style=color:#719e07>=</span> <span style=color:#719e07>&amp;</span>f; <span style=color:#586e75>// fçš„å‚æ•°Tç”±å‡½æ•°æŒ‡é’ˆçš„ç±»å‹ç¡®å®š
</span></span></span></code></pre></div><ol><li><strong>éšå¼è½¬æ¢æ“ä½œç¬¦æ¨¡æ¿</strong>çš„ç±»å‹å‚æ•° T ç”±éœ€è¦è½¬æ¢æ—¶æ‰€éœ€çš„ç±»å‹å†³å®šã€‚</li></ol><p><em>æ¨¡æ¿å°è¯•åŒ¹é…çš„æ—¶å€™ä¸é€‚ç”¨ common typeã€‚</em> æ¯”å¦‚ä¸¤ä¸ª T ç±»å‹åˆ†åˆ«è¢«è®¤ä¸ºæ˜¯ int å’Œ double æ—¶ï¼Œä¼šå¯¼è‡´æ¨¡æ¿æ›¿æ¢å¤±è´¥ï¼Œè€Œä¸æ˜¯æŠŠ T è®¤ä¸ºæ˜¯ doubleã€‚æ¯”å¦‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>template</span> <span style=color:#719e07>&lt;</span><span style=color:#719e07>class</span> <span style=color:#268bd2>T</span><span style=color:#719e07>&gt;</span> T max(T a, T b) { <span style=color:#719e07>return</span> a <span style=color:#719e07>&gt;</span> b <span style=color:#719e07>?</span> a : b; }
</span></span></code></pre></div><p>è°ƒç”¨ <code>max(1, 3.0)</code> å°±ä¼šå¤±è´¥ï¼Œè€Œè°ƒç”¨ <code>max&lt;double>(1, 3.0)</code> æ‰èƒ½æˆåŠŸï¼ˆæ¨¡æ¿å‚æ•°è¢«äººä¸ºæŒ‡å®šä¹‹åå°±å…è®¸éšå¼ç±»å‹è½¬æ¢äº†ï¼‰ã€‚</p><h1 id=ç‰¹ä¾‹åˆå§‹åŒ–åˆ—è¡¨>ç‰¹ä¾‹ï¼šåˆå§‹åŒ–åˆ—è¡¨
<a class=header-anchor href=#%e7%89%b9%e4%be%8b%e5%88%9d%e5%a7%8b%e5%8c%96%e5%88%97%e8%a1%a8></a></h1><p>åˆå§‹åŒ–åˆ—è¡¨æ²¡æœ‰ç¡®å®šçš„ç±»å‹ï¼Œå› æ­¤ä¸èƒ½ç»‘å®šåœ¨å‚æ•°ç±»å‹ T ä¸Šé¢ã€‚ä½†æ˜¯å¦‚æœå‚æ•°ç±»å‹ä¸º <code>std::initializer_list&lt;T></code>ï¼Œåˆ™èƒ½å¤Ÿå°è¯•ç»‘å®šï¼ˆå½“æ‰€æœ‰å…ƒç´ ç±»å‹ç›¸åŒæ—¶æˆåŠŸï¼‰ã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>#include</span> <span style=color:#719e07>&lt;initializer_list&gt;</span><span style=color:#719e07>
</span></span></span><span style=display:flex><span><span style=color:#719e07></span>
</span></span><span style=display:flex><span><span style=color:#586e75>// å¦‚æœæŠŠå‚æ•°ç±»å‹ä»åˆå§‹åŒ–åˆ—è¡¨æ”¹æˆ T å°±ä¼šæ¨å¯¼å¤±è´¥
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span> T<span style=color:#719e07>&gt;</span> <span style=color:#dc322f>void</span> f(std<span style=color:#719e07>::</span>initializer_list<span style=color:#719e07>&lt;</span>T<span style=color:#719e07>&gt;</span>) {}
</span></span><span style=display:flex><span><span style=color:#dc322f>int</span> <span style=color:#268bd2>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    f({<span style=color:#2aa198>2</span>, <span style=color:#2aa198>3</span>, <span style=color:#2aa198>5</span>, <span style=color:#2aa198>7</span>, <span style=color:#2aa198>9</span>});               <span style=color:#586e75>// OK: T is deduced to int
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    f({â€™aâ€™, â€™eâ€™, â€™iâ€™, â€™oâ€™, â€™uâ€™, <span style=color:#2aa198>42</span>}); <span style=color:#586e75>// ERROR: T deduced to both char and int
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>åŒæ—¶ï¼Œ<code>auto primes = { 2, 3, 5, 7 };</code> åˆ›å»ºçš„æ˜¯ <code>std::initializer_list&lt;int></code> ç±»å‹çš„æ•°æ®ã€‚åœ¨ C++17 ä¹‹åï¼Œå»æ‰å…¶ä¸­çš„ <code>=</code> å°±æ— æ³•ç¼–è¯‘ã€‚C++17 å¯¹å»æ‰ <code>=</code> çš„ <code>auto x{?};</code> åˆå§‹åŒ–å€¾å‘äºæ¨å¯¼ä¸ºå•ä¸ªå…ƒç´ ï¼Œè€Œä¹‹å‰ç»Ÿä¸€æ¨å¯¼ä¸º <code>std::initializer&lt;?></code> ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>auto</span> oops { <span style=color:#2aa198>0</span>, <span style=color:#2aa198>8</span>, <span style=color:#2aa198>15</span> }; <span style=color:#586e75>// ERROR in C++17. OK before C++17
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>auto</span> val { <span style=color:#2aa198>2</span> };         <span style=color:#586e75>// OK: val has type int in C++17,
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>                        <span style=color:#586e75>// or type std::intializer_list&lt;int&gt; before C++17
</span></span></span></code></pre></div><p>åœ¨å‡½æ•°ä¸­ä½¿ç”¨ <code>auto</code> æ¨å¯¼ï¼ŒåŒæ—¶åˆè¿”å›åˆå§‹åŒ–åˆ—è¡¨ï¼Œåˆ™æ— æ³•ç¼–è¯‘ï¼Œå› ä¸ºæ— æ³•ç¡®å®šå…·ä½“ç±»å‹ã€‚</p><h1 id=ç‰¹ä¾‹å˜å‚åˆ—è¡¨å‚æ•°åŒ…>ç‰¹ä¾‹ï¼šå˜å‚åˆ—è¡¨/å‚æ•°åŒ…
<a class=header-anchor href=#%e7%89%b9%e4%be%8b%e5%8f%98%e5%8f%82%e5%88%97%e8%a1%a8%e5%8f%82%e6%95%b0%e5%8c%85></a></h1><p>ç®€å•æƒ…æ™¯ï¼šåŒ¹é… 0 æˆ–å¤šä¸ªå‰©ä½™å‚æ•°ã€‚</p><p>pack expansionï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span> T, <span style=color:#719e07>typename</span> U<span style=color:#719e07>&gt;</span> <span style=color:#719e07>class</span> <span style=color:#268bd2>pair</span> { };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// **åŒ¹é…èƒ½åŠ›**ï¼šç¬¬ä¸€å‚æ•°ç›¸åŒçš„é›¶ä¸ªæˆ–å¤šä¸ª pair
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span> T, <span style=color:#719e07>typename</span>... Rest<span style=color:#719e07>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#dc322f>void</span> h1(pair<span style=color:#719e07>&lt;</span>T, Rest<span style=color:#719e07>&gt;</span> <span style=color:#719e07>const</span><span style=color:#719e07>&amp;</span>...);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// ç”±äº pack expansion ä¸­æœ‰ä¸¤ä¸ª parameter packï¼Œå› æ­¤ Ts å’Œ Rest çš„å‚æ•°æ•°é‡å¿…é¡»ä¸€è‡´
</span></span></span><span style=display:flex><span><span style=color:#586e75>// **åŒ¹é…èƒ½åŠ›**ï¼šä»»æ„å‚æ•°çš„é›¶ä¸ªæˆ–å¤šä¸ª pair
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span>... Ts, <span style=color:#719e07>typename</span>... Rest<span style=color:#719e07>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#dc322f>void</span> h2(pair<span style=color:#719e07>&lt;</span>Ts, Rest<span style=color:#719e07>&gt;</span> <span style=color:#719e07>const</span><span style=color:#719e07>&amp;</span>...);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#dc322f>void</span> <span style=color:#268bd2>foo</span>(pair<span style=color:#719e07>&lt;</span><span style=color:#dc322f>int</span>, <span style=color:#dc322f>float</span><span style=color:#719e07>&gt;</span> pif, pair<span style=color:#719e07>&lt;</span><span style=color:#dc322f>int</span>, <span style=color:#dc322f>double</span><span style=color:#719e07>&gt;</span> pid, pair<span style=color:#719e07>&lt;</span><span style=color:#dc322f>double</span>, <span style=color:#dc322f>double</span><span style=color:#719e07>&gt;</span> pdd)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    h1(pif, pid);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// OK: deduces T to int, Rest to {float, double}
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    h2(pif, pid);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// OK: deduces Ts to {int, int}, Rest to {float, double}
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    h1(pif, pdd);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// ERROR: T deduced to int from the 1st arg, but to double from the 2nd
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    h2(pif, pdd);
</span></span><span style=display:flex><span>    <span style=color:#586e75>// OK: deduces Ts to {int, double}, Rest to {float, double}
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>ä¼ é€’å˜å‚ï¼Œè€Œä¸æ˜¯åš pack expansionï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span>... Types<span style=color:#719e07>&gt;</span> <span style=color:#719e07>class</span> <span style=color:#268bd2>Tuple</span> { };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// **åŒ¹é…èƒ½åŠ›**ï¼šå‚æ•°å®Œå…¨ç›¸åŒçš„2ä¸ªtuple
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span>... Types<span style=color:#719e07>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#dc322f>bool</span> f1(Tuple<span style=color:#719e07>&lt;</span>Types...<span style=color:#719e07>&gt;</span>, Tuple<span style=color:#719e07>&lt;</span>Types...<span style=color:#719e07>&gt;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// **åŒ¹é…èƒ½åŠ›**ï¼šä»»æ„å‚æ•°çš„2ä¸ªtuple
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span>... Types1, <span style=color:#719e07>typename</span>... Types2<span style=color:#719e07>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#dc322f>bool</span> f2(Tuple<span style=color:#719e07>&lt;</span>Types1...<span style=color:#719e07>&gt;</span>, Tuple<span style=color:#719e07>&lt;</span>Types2...<span style=color:#719e07>&gt;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#dc322f>void</span> <span style=color:#268bd2>bar</span>(Tuple<span style=color:#719e07>&lt;</span><span style=color:#dc322f>short</span>, <span style=color:#dc322f>int</span>, <span style=color:#dc322f>long</span><span style=color:#719e07>&gt;</span> sv,
</span></span><span style=display:flex><span>         Tuple<span style=color:#719e07>&lt;</span><span style=color:#dc322f>unsigned</span> <span style=color:#dc322f>short</span>, <span style=color:#dc322f>unsigned</span>, <span style=color:#dc322f>unsigned</span> <span style=color:#dc322f>long</span><span style=color:#719e07>&gt;</span> uv)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    f1(sv, sv); <span style=color:#586e75>// OK: Types is deduced to {short, int, long}
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    f2(sv, sv); <span style=color:#586e75>// OK: Types1 is deduced to {short, int, long},
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>                <span style=color:#586e75>// Types2 is deduced to {short, int, long}
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    f1(sv, uv); <span style=color:#586e75>// ERROR: Types is deduced to {short, int, long} from the 1st arg, but
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>                <span style=color:#586e75>// to {unsigned short, unsigned, unsigned long} from the 2nd
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    f2(sv, uv); <span style=color:#586e75>// OK: Types1 is deduced to {short, int, long},
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>                <span style=color:#586e75>// Types2 is deduced to {unsigned short, unsigned, unsigned long}
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è¿™ä¸ªæ¯”ä¸Šé¢ä¸€ç»„ä»£ç å®¹æ˜“ç†è§£ä¸€ç‚¹ã€‚</p><p>è¿˜èƒ½ä¸ºå‚æ•°åŒ…æ˜¾å¼æŒ‡å®šå‰å‡ ä¸ªå‚æ•°ç±»å‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>template</span> <span style=color:#dc322f>void</span> <span style=color:#268bd2>f</span>(Ts ... ps) {}
</span></span><span style=display:flex><span><span style=color:#dc322f>int</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    f<span style=color:#719e07>&lt;</span><span style=color:#dc322f>double</span>, <span style=color:#dc322f>int</span><span style=color:#719e07>&gt;</span>(<span style=color:#2aa198>1</span>, <span style=color:#2aa198>2</span>, <span style=color:#2aa198>3</span>); <span style=color:#586e75>// OK
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>è¿™æ˜¯ä¸€ä¸ªåç‰¹åŒ–ã€‚ç¬¬ä¸€ä¸ªå‚æ•°è¢«è½¬æ¢æˆäº† <code>1.0</code>ã€‚</p><h1 id=ç‰¹ä¾‹å­—é¢é‡æ“ä½œç¬¦æ¨¡æ¿>ç‰¹ä¾‹ï¼šå­—é¢é‡æ“ä½œç¬¦æ¨¡æ¿
<a class=header-anchor href=#%e7%89%b9%e4%be%8b%e5%ad%97%e9%9d%a2%e9%87%8f%e6%93%8d%e4%bd%9c%e7%ac%a6%e6%a8%a1%e6%9d%bf></a></h1><p>å­—é¢é‡æœ‰å››ç±»ï¼šæ•´æ•°ã€æµ®ç‚¹æ•°ã€å­—ç¬¦ä¸²ã€å­—ç¬¦ã€‚å­—é¢é‡æ“ä½œç¬¦åŒ¹é…çš„å‰ææ˜¯å­—é¢é‡æœ¬èº«åˆæ³•ï¼ˆå¦‚æœä¸æ˜¯åˆæ³•æ•°å­—ï¼Œå°±éœ€è¦ç”¨å­—ç¬¦ä¸²è¡¨ç¤ºï¼‰ï¼ŒåŒ¹é…çš„ä¼˜å…ˆçº§åˆ™å¦‚ä¸‹ï¼š</p><h2 id=æ•´æ•°-n>æ•´æ•° n
<a class=header-anchor href=#%e6%95%b4%e6%95%b0-n></a></h2><ol><li><p>æ‰¾æ¥å—å‚æ•° <code>unsigned long long</code> çš„é‡è½½ï¼Œè‹¥æœ‰åˆ™è°ƒç”¨ <code>operator ""X(n ULL)</code>ã€‚</p></li><li><p>æ‰¾ <em>a raw literal operator or a numeric literal operator template, but not both</em>ã€‚</p><p>å‰è€…å‚æ•°ä¸º <code>const char *</code>ï¼Œè°ƒç”¨å½¢å¼ä¸º <code>operator""X("n")</code>ã€‚åè€…æ¨¡æ¿å‚æ•°æ˜¯ <code>&lt;char ...></code> ï¼Œè°ƒç”¨å½¢å¼ä¸º <code>operator""X&lt;'c1', 'c 2', 'c3'..., 'ck '>()</code>ï¼Œä¹Ÿå°±æ˜¯æŠŠå­—é¢é‡çš„æ¯ä¸ªå­—ç¬¦æ‹†å¼€çš„å˜å‚æ¨¡æ¿ã€‚</p><p>ä¸¤è€…ä¸å¾—åŒæ—¶è¢«æ‰¾åˆ°ï¼Œå¦åˆ™æ— æ³•åŒºåˆ†ä¼˜åŠ£ã€‚</p></li></ol><p>ç±»å‹åŒ¹é… > å½“æˆå­—ç¬¦ä¸² = æ‹†æˆå­—ç¬¦ä¼ å…¥æ¨¡æ¿ã€‚</p><h2 id=æµ®ç‚¹æ•°-f>æµ®ç‚¹æ•° f
<a class=header-anchor href=#%e6%b5%ae%e7%82%b9%e6%95%b0-f></a></h2><ol><li>æ‰¾æ¥å—å‚æ•° <code>long double</code> çš„é‡è½½ï¼Œè‹¥æœ‰åˆ™è°ƒç”¨ <code>operator ""X(f L)</code>ã€‚</li><li>å‰©ä½™è¿‡ç¨‹å’Œæ•´æ•°çš„ 2ã€3 ç›¸åŒã€‚</li></ol><h2 id=å­—ç¬¦ä¸²-stré•¿åº¦ä¸º-len>å­—ç¬¦ä¸² strï¼Œé•¿åº¦ä¸º len
<a class=header-anchor href=#%e5%ad%97%e7%ac%a6%e4%b8%b2-str%e9%95%bf%e5%ba%a6%e4%b8%ba-len></a></h2><ol><li>C++20ï¼šå¦‚æœæœ‰å‚æ•°èƒ½å¤Ÿå’Œå­—ç¬¦ä¸²å­—é¢é‡åŒ¹é…ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨è¿™ä¸ªæ¨¡æ¿ <code>operator ""X&lt;str>()</code>ã€‚</li><li>å°è¯• <code>operator ""X (str, len)</code>ã€‚</li></ol><p>æ³¨æ„æ•´æ•°å’Œæµ®ç‚¹æ•°å¯ä»¥åŒ¹é…ä¸Šå½¢å¦‚ <code>unsigned operator ""_w(const char*);</code> çš„é‡è½½ï¼Œä½†æ˜¯å› ä¸ºè¯¥é‡è½½æ²¡æœ‰é•¿åº¦å‚æ•°ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²åŒ¹é…ä¸ä¸Šã€‚</p><p>C++20 æ–°å¢çš„åŒ¹é…è§„åˆ™æ„é€ èµ·æ¥ä¹Ÿæ¯”è¾ƒå›°éš¾ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>#include</span> <span style=color:#719e07>&lt;array&gt;</span><span style=color:#719e07>
</span></span></span><span style=display:flex><span><span style=color:#719e07>#include</span> <span style=color:#719e07>&lt;iostream&gt;</span><span style=color:#719e07>
</span></span></span><span style=display:flex><span><span style=color:#719e07></span><span style=color:#719e07>template</span> <span style=color:#719e07>&lt;</span>size_t N<span style=color:#719e07>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>string_literal</span> {
</span></span><span style=display:flex><span>Â  Â  std<span style=color:#719e07>::</span>array<span style=color:#719e07>&lt;</span><span style=color:#dc322f>char</span>, N<span style=color:#719e07>&gt;</span> arr_{};
</span></span><span style=display:flex><span>Â  Â  <span style=color:#719e07>constexpr</span> <span style=color:#268bd2>string_literal</span>(<span style=color:#719e07>const</span> <span style=color:#dc322f>char</span> (<span style=color:#719e07>&amp;</span>in)[N]) {
</span></span><span style=display:flex><span>Â  Â  Â  Â  std<span style=color:#719e07>::</span>copy(in, in <span style=color:#719e07>+</span> N, arr_.begin());
</span></span><span style=display:flex><span>Â  Â  }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>template</span> <span style=color:#719e07>&lt;</span>string_literal str<span style=color:#719e07>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#719e07>auto</span> <span style=color:#719e07>operator</span><span style=color:#2aa198>&#34;&#34;</span> _len() {
</span></span><span style=display:flex><span>Â  Â  <span style=color:#719e07>static_assert</span>(str.arr_.size() <span style=color:#719e07>&gt;</span> <span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>Â  Â  <span style=color:#719e07>return</span> str.arr_.size() <span style=color:#719e07>-</span> <span style=color:#2aa198>1</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#dc322f>int</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>Â  Â  std<span style=color:#719e07>::</span>cout <span style=color:#719e07>&lt;&lt;</span> <span style=color:#2aa198>&#34;34&#34;</span>_len <span style=color:#719e07>&lt;&lt;</span> <span style=color:#2aa198>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å¦‚æœä½¿ç”¨æ™®é€šçš„æ•°ç»„å»åŒ¹é…å­—ç¬¦ä¸²å­—é¢é‡ï¼Œå°±åŒ¹é…ä¸ä¸Šã€‚ï¼ˆC++17 å¯ä»¥é‡‡ç”¨é¢„å…ˆåˆ†é… constexpr å­—ç¬¦æ•°ç»„çš„æ–¹å¼è¿›è¡Œä¸€äº›æ¨¡æ¿æ“ä½œï¼Œè€Œä¸” C++17 ä¹Ÿæ²¡æœ‰ linkage è¦æ±‚ï¼Œä½†æ˜¯è¿™ä¸èƒ½è¢«ç›´æ¥ç”¨åœ¨å­—é¢é‡ä¸Šï¼Œæ‰€ä»¥æ“ä½œèµ·æ¥å¾ˆéº»çƒ¦ï¼‰ã€‚</p><p>å…¶å®è¿™æ¡æ–°è§„åˆ™ä¸é‡è¦å§ï¼Ÿé™¤ééœ€è¦è¦†ç›–åŸè§„åˆ™ï¼ŒæŠŠç¬¬äºŒæ¡è§„åˆ™å®šä¹‰ä¸º constexpr å°±è¡Œäº†ã€‚ï¼ˆ<code>std::string</code> ä¸èƒ½ä½œä¸º consteval å‡½æ•°çš„è¿”å›å€¼ï¼Œä½†æ˜¯ <code>std::string_view</code> å¯ä»¥ï¼‰ä½†æ˜¯ C++20 è¿™æ ·å°±å…è®¸ï¼ˆç”¨ä¸€ç§æ›²æŠ˜çš„æ–¹å¼ï¼‰æŠŠå­—ç¬¦ä¸²å­—é¢é‡ç›´æ¥ä½œä¸ºæ¨¡æ¿å‚æ•°äº†ã€‚</p><h2 id=å­—ç¬¦-ch>å­—ç¬¦ ch
<a class=header-anchor href=#%e5%ad%97%e7%ac%a6-ch></a></h2><p>å°è¯• <code>operator ""X(ch)</code>ã€‚</p><h1 id=ç‰¹ä¾‹é»˜è®¤å‚æ•°>ç‰¹ä¾‹ï¼šé»˜è®¤å‚æ•°
<a class=header-anchor href=#%e7%89%b9%e4%be%8b%e9%bb%98%e8%ae%a4%e5%8f%82%e6%95%b0></a></h1><p>é»˜è®¤å‚æ•°ä¸èƒ½ç”¨äºæ¨å¯¼å‚æ•°ï¼š</p><p><img src=/assets/f7479b8da246316d6819d3674ab5e98d.webp></p><h1 id=å¼•ç”¨ç±»å‹>å¼•ç”¨ç±»å‹
<a class=header-anchor href=#%e5%bc%95%e7%94%a8%e7%b1%bb%e5%9e%8b></a></h1><ol><li>ä¸å¯ä»¥ç›´æ¥å¼•ç”¨å¼•ç”¨ï¼š</li></ol><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#dc322f>int</span> <span style=color:#719e07>const</span><span style=color:#719e07>&amp;</span> r <span style=color:#719e07>=</span> <span style=color:#2aa198>42</span>;
</span></span><span style=display:flex><span><span style=color:#dc322f>int</span> <span style=color:#719e07>const</span><span style=color:#719e07>&amp;</span> <span style=color:#719e07>&amp;</span> ref2ref <span style=color:#719e07>=</span> i; <span style=color:#586e75>// ERROR: reference to reference is invalid
</span></span></span><span style=display:flex><span><span style=color:#586e75>// æ³¨æ„ç¼–è¯‘ä¼šè®¤å‡ºè¿™æ˜¯å¯¹å¼•ç”¨çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯è®¤ä¸ºå®ƒæ˜¯å³å€¼å¼•ç”¨
</span></span></span></code></pre></div><ol><li>é€šè¿‡ decltypeã€ç±»å‹åˆ«åã€æ¨¡æ¿ç­‰æ–¹å¼å¾—åˆ°çš„å¼•ç”¨å¯ä»¥å‚ä¸å¼•ç”¨åå¡Œã€‚</li><li>å¯¹å¼•ç”¨ç±»å‹çš„ cv é™å®šç›¸å½“äºä¸é™å®šï¼Œå¹¶ä¸ä¼šæŠ¥é”™ã€‚ï¼ˆ<code>const</code> / <code>volatile</code>ï¼‰</li></ol><h1 id=å®Œç¾è½¬å‘>å®Œç¾è½¬å‘
<a class=header-anchor href=#%e5%ae%8c%e7%be%8e%e8%bd%ac%e5%8f%91></a></h1><h2 id=ç±»å‹æ¨å¯¼>ç±»å‹æ¨å¯¼
<a class=header-anchor href=#%e7%b1%bb%e5%9e%8b%e6%8e%a8%e5%af%bc></a></h2><p>å®Œç¾è½¬å‘ä¹‹å‰ä¼šå¯¹ç±»å‹è¿›è¡Œæ¨å¯¼ï¼Œè¿™ç›¸å½“äºç¦æ­¢äº†ç±»å‹ä¹‹é—´çš„éšå¼è½¬æ¢ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#dc322f>void</span> <span style=color:#268bd2>g</span>(<span style=color:#dc322f>int</span><span style=color:#719e07>*</span>);
</span></span><span style=display:flex><span><span style=color:#dc322f>void</span> <span style=color:#268bd2>g</span>(...); <span style=color:#586e75>// åº”å½“æ˜¯æœ€æ¬¡çš„é€‰æ‹©
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span> T<span style=color:#719e07>&gt;</span> <span style=color:#dc322f>void</span> forwardToG(T<span style=color:#719e07>&amp;&amp;</span> x)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    g(std<span style=color:#719e07>::</span>forward<span style=color:#719e07>&lt;</span>T<span style=color:#719e07>&gt;</span>(x)); <span style=color:#586e75>// forward x to g()
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#dc322f>void</span> <span style=color:#268bd2>foo</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    g(<span style=color:#2aa198>0</span>);          <span style=color:#586e75>// calls g(int*)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    forwardToG(<span style=color:#2aa198>0</span>); <span style=color:#586e75>// eventually calls g(...)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>ä¸Šé¢ä»£ç ä¸­ç»è¿‡æ¨¡æ¿æ•è·åå‚æ•° <code>T</code> çš„ç±»å‹è®¤ä¸ºæ˜¯ <code>int</code>ï¼Œè€Œ <code>x</code> çš„ç±»å‹è¢«è®¤ä¸ºæ˜¯ <code>int &&</code>ã€‚<code>int</code> ç±»å‹ä¸èƒ½å’Œå‡½æ•° <code>g</code> çš„ç¬¬ä¸€ä¸ªé‡è½½ç‰ˆæœ¬åŒ¹é…ã€‚è¿™å’Œç›´æ¥è°ƒç”¨ <code>g(0)</code> æ•ˆæœä¸åŒã€‚<strong>C++11 å¼•å…¥çš„</strong> <code>nullptr</code> <strong>æœ¬èº«å…·æœ‰ç±»å‹ï¼Œç”¨åœ¨è¿™ç§æƒ…å†µæ›´åŠ åˆé€‚</strong>ã€‚</p><p>æœ¬å°èŠ‚æåˆ°çš„å¯¹ <code>decltype(auto)</code> çš„ä½¿ç”¨å¯ä»¥å‚è€ƒå‰é¢çš„ç« èŠ‚ï¼š
<a href=/cpp-templates-the-complete-guide/11-Generic-Libraries/#%e5%ae%8c%e7%be%8e%e8%bd%ac%e5%8f%91 title=å®Œç¾è½¬å‘>å®Œç¾è½¬å‘</a>ã€‚</p><h2 id=ç¦ç”¨å®Œç¾è½¬å‘>ç¦ç”¨å®Œç¾è½¬å‘
<a class=header-anchor href=#%e7%a6%81%e7%94%a8%e5%ae%8c%e7%be%8e%e8%bd%ac%e5%8f%91></a></h2><p><code>T&&</code> å½¢å¼ç”¨æ¥è¡¨è¾¾å®Œç¾è½¬å‘ï¼Œé‚£ä¹ˆæ€ä¹ˆè¡¨è¾¾å•çº¯çš„å³å€¼å¼•ç”¨å‘¢ï¼Ÿå¯ä»¥ç”¨ <code>std::enable_if</code> æ¥åˆ¤æ–­ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span> T<span style=color:#719e07>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#719e07>typename</span> std<span style=color:#719e07>::</span>enable_if<span style=color:#719e07>&lt;!</span>std<span style=color:#719e07>::</span>is_lvalue_reference<span style=color:#719e07>&lt;</span>T<span style=color:#719e07>&gt;::</span>value<span style=color:#719e07>&gt;::</span>type
</span></span><span style=display:flex><span>rvalues(T<span style=color:#719e07>&amp;&amp;</span>);
</span></span></code></pre></div><h1 id=ç«‹å³ä¸Šä¸‹æ–‡immediate-context>ç«‹å³ä¸Šä¸‹æ–‡ï¼ˆimmediate contextï¼‰
<a class=header-anchor href=#%e7%ab%8b%e5%8d%b3%e4%b8%8a%e4%b8%8b%e6%96%87immediate-context></a></h1><p>æ‘˜è‡ªåŸæ–‡ï¼š</p><p><img src=/assets/5ffedbd0cc91ad5dbbc9ae38a044d43f.webp></p><p><strong>åœ¨ç«‹å³ä¸Šä¸‹æ–‡ä¸­å‘ç”Ÿçš„æ›¿ä»£é”™è¯¯ä¸æ˜¯é”™è¯¯ï¼ˆSFINAEï¼‰</strong>ï¼Œä¸åœ¨å…¶ä¸­å‘ç”Ÿçš„é”™è¯¯è¢«è§†ä½œçœŸæ­£çš„é”™è¯¯ï¼Œæ— æ³•ç¼–è¯‘ã€‚</p><h2 id=ç±»æ¨¡æ¿å®šä¹‰ä¸æ˜¯ç«‹å³ä¸Šä¸‹æ–‡>ç±»æ¨¡æ¿å®šä¹‰ä¸æ˜¯ç«‹å³ä¸Šä¸‹æ–‡
<a class=header-anchor href=#%e7%b1%bb%e6%a8%a1%e6%9d%bf%e5%ae%9a%e4%b9%89%e4%b8%8d%e6%98%af%e7%ab%8b%e5%8d%b3%e4%b8%8a%e4%b8%8b%e6%96%87></a></h2><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span> T<span style=color:#719e07>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#719e07>class</span> <span style=color:#268bd2>Array</span> {
</span></span><span style=display:flex><span><span style=color:#719e07>public</span><span style=color:#719e07>:</span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>using</span> iterator <span style=color:#719e07>=</span> T<span style=color:#719e07>*</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span> T<span style=color:#719e07>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#dc322f>void</span> f(<span style=color:#719e07>typename</span> Array<span style=color:#719e07>&lt;</span>T<span style=color:#719e07>&gt;::</span>iterator first, <span style=color:#719e07>typename</span> Array<span style=color:#719e07>&lt;</span>T<span style=color:#719e07>&gt;::</span>iterator last) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span> T<span style=color:#719e07>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#dc322f>void</span> f(T<span style=color:#719e07>*</span>, T<span style=color:#719e07>*</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#dc322f>int</span> <span style=color:#268bd2>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    f<span style=color:#719e07>&lt;</span><span style=color:#dc322f>int</span><span style=color:#719e07>&amp;&gt;</span>(<span style=color:#2aa198>0</span>, <span style=color:#2aa198>0</span>); <span style=color:#586e75>// ERROR
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>ç¬¬ä¸€ä¸ª <code>f</code> æŠŠ <code>T</code> ç±»å‹ä½œä¸ºå‚æ•°ä¼ ç»™äº†å¦å¤–ä¸€ä¸ªæ¨¡æ¿ <code>Array</code>ï¼Œåˆç”±äºè¿™ä¸ªæ¨¡æ¿å¯èƒ½è¢«ç‰¹åŒ–ï¼Œå› è€Œä¸èƒ½ç¡®å®šå…¶ <code>iterator</code> çš„å…·ä½“ç±»å‹ã€‚<em>è¿™ä¸ªæ¨¡æ¿å£°æ˜ä¸­å¯¹</em> <code>T</code> <em>çš„ç±»å‹æ²¡æœ‰ä»»ä½•çº¦æŸï¼ŒåŒæ—¶ä¹Ÿä¸èƒ½ä»å‚æ•°ä¸­æ¨å¯¼å‡ºæ¥ T çš„ç±»å‹ï¼Œåªæœ‰é€šè¿‡æ˜¾å¼ä¼ å…¥æ¨¡æ¿å‚æ•°æ‰å¯èƒ½å¯ç”¨</em>ã€‚ç¬¬äºŒä¸ª <code>f</code> è¦æ±‚å¯ä»¥ <code>T</code> ç±»å‹æœ‰å¯¹åº”çš„æŒ‡é’ˆç±»å‹ã€‚</p><p>ä¸Šé¢çš„ä»£ç ä¸­æ‰‹åŠ¨é€‰æ‹©äº† <code>int &</code> ç±»å‹ï¼Œè¯¥ç±»å‹å’Œå‡½æ•°æ¨¡æ¿çš„ç¬¬äºŒä¸ªå½¢å¼æ— æ³•åŒ¹é…ï¼Œå´å’Œç¬¬ä¸€ä¸ªèƒ½å¤ŸåŒ¹é…ï¼ˆå› ä¸ºç¬¬ä¸€ä¸ª <code>f</code> å¯¹ <code>T</code> æ²¡æœ‰ä»»ä½•è¦æ±‚ï¼‰ã€‚ä½†æ˜¯åœ¨å®ä¾‹åŒ–æ—¶åˆé‡åˆ°äº† <code>int &*</code> è¿™æ ·çš„éæ³•ç±»å‹ï¼Œå› è€Œä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ã€‚<em>è¿™ç§å‡ºé”™çš„æƒ…å†µå¥½åƒæ— è®ºæ˜¯ç”¨ enable_if è¿˜æ˜¯ç”¨ concept éƒ½æ— æ³•å›é¿ã€‚</em> ç”¨ type traits å’Œ concept èƒ½å¤Ÿå¤„ç†çš„åªæœ‰å¯¹ current instantiation çš„åˆ¤æ–­ã€‚</p><p>å¦‚æœæ·»åŠ ä¸€ä¸ªå’Œç¬¬äºŒä¸ª <code>f</code> ç›¸ä¼¼ï¼Œä½†æ˜¯å‚æ•°åˆ—è¡¨æ”¹æˆ <code>(...)</code> çš„å‡½æ•°æ¨¡æ¿ï¼Œåˆ™ä¹Ÿèƒ½å¤Ÿåœ¨ç»™å®šå‚æ•°ç±»å‹æ—¶åŒ¹é…ï¼ˆä¸ç»™å°±åŒæ ·æ— æ³•æ¨å¯¼ç±»å‹ï¼‰ï¼Œä½†æ˜¯ç”±äº <code>varargs</code> çš„ä¼˜å…ˆçº§å¤ªä½ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨ä»ç„¶ä¼šé€‰ä¸­ç¬¬ä¸€ä¸ª <code>f</code> ï¼Œç„¶ååœ¨å®ä¾‹åŒ–æ—¶ç¼–è¯‘é”™è¯¯ã€‚</p><h2 id=å¼‚å¸¸å£°æ˜ä¸æ˜¯ç«‹å³ä¸Šä¸‹æ–‡>å¼‚å¸¸å£°æ˜ä¸æ˜¯ç«‹å³ä¸Šä¸‹æ–‡
<a class=header-anchor href=#%e5%bc%82%e5%b8%b8%e5%a3%b0%e6%98%8e%e4%b8%8d%e6%98%af%e7%ab%8b%e5%8d%b3%e4%b8%8a%e4%b8%8b%e6%96%87></a></h2><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>template</span> <span style=color:#dc322f>void</span> <span style=color:#268bd2>f</span>(T, <span style=color:#dc322f>int</span>) <span style=color:#719e07>noexcept</span>(nonexistent(T())); <span style=color:#586e75>// #1
</span></span></span><span style=display:flex><span><span style=color:#586e75>// ç”¨ throw(typename T::Nonexistent) ä¹Ÿæ˜¯è¢«é€‰ä¸­ä½†æ˜¯ä¸èƒ½ç¼–è¯‘
</span></span></span><span style=display:flex><span><span style=color:#586e75>// ä¸è¿‡æ˜¾å¼å¼‚å¸¸å£°æ˜å·²ç»åœ¨ C++17 è¢«ç§»é™¤äº†
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#719e07>template</span> <span style=color:#dc322f>void</span> <span style=color:#268bd2>f</span>(T, ...); <span style=color:#586e75>// #2 (C-style vararg function)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#dc322f>void</span> <span style=color:#268bd2>test</span>(<span style=color:#dc322f>int</span> i) {
</span></span><span style=display:flex><span>    f(i, i); <span style=color:#586e75>// ERROR: chooses #1 , but the expression nonexistent(T()) is ill-formed
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>}
</span></span></code></pre></div><p>ä¸Šé¢ä»£ç ä¸­ <code>#1</code> ä¼šè¢«é€‰ä¸­ï¼Œå› ä¸ºå¼‚å¸¸å£°æ˜ä¸æ˜¯ç«‹å³ä¸Šä¸‹æ–‡ã€‚</p><h1 id=auto-å…³é”®å­—>auto å…³é”®å­—
<a class=header-anchor href=#auto-%e5%85%b3%e9%94%ae%e5%ad%97></a></h1><p>C++17 å…è®¸åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ auto å…³é”®å­—ã€‚å°±ç®—ä¸åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ï¼Œ<code>auto</code> æœ¬èº«ä¹Ÿå¤šå°‘å¸¦ç‚¹æ¨¡æ¿æ¨å¯¼çš„æ„å‘³ã€‚</p><h2 id=æ„é€ ä¸€ä¸ªèƒ½å¤Ÿæ“ä½œå¯¹è±¡æˆå‘˜è‡ªå¢çš„-handle>æ„é€ ä¸€ä¸ªèƒ½å¤Ÿæ“ä½œå¯¹è±¡æˆå‘˜è‡ªå¢çš„ handle
<a class=header-anchor href=#%e6%9e%84%e9%80%a0%e4%b8%80%e4%b8%aa%e8%83%bd%e5%a4%9f%e6%93%8d%e4%bd%9c%e5%af%b9%e8%b1%a1%e6%88%90%e5%91%98%e8%87%aa%e5%a2%9e%e7%9a%84-handle></a></h2><p><img src=/assets/15885c4217279a0cdf53e2064b5c49fb.webp></p><p><img src=/assets/163bf876df84759769551820439b10ae.webp></p><h2 id=å¼ºåˆ¶-auto-æ¨å¯¼ä¸­æ‰€æœ‰å‚æ•°ç±»å‹ä¸€è‡´>å¼ºåˆ¶ <code>auto...</code> æ¨å¯¼ä¸­æ‰€æœ‰å‚æ•°ç±»å‹ä¸€è‡´
<a class=header-anchor href=#%e5%bc%ba%e5%88%b6-auto-%e6%8e%a8%e5%af%bc%e4%b8%ad%e6%89%80%e6%9c%89%e5%8f%82%e6%95%b0%e7%b1%bb%e5%9e%8b%e4%b8%80%e8%87%b4></a></h2><p><img src=/assets/10c1cbc02178d0f6d25296ab8c56cf6f.webp></p><p>ç¼ºç‚¹æ˜¯ä¸èƒ½è¡¨è¾¾ç©ºå‚æ•°ã€‚</p><h2 id=decltypeauto><code>decltype(auto)</code>
<a class=header-anchor href=#decltypeauto></a></h2><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>#include</span> <span style=color:#719e07>&lt;type_traits&gt;</span><span style=color:#719e07>
</span></span></span><span style=display:flex><span><span style=color:#719e07></span><span style=color:#719e07>const</span> <span style=color:#dc322f>int</span> four <span style=color:#719e07>=</span> <span style=color:#2aa198>4</span>;
</span></span><span style=display:flex><span><span style=color:#dc322f>int</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>Â  Â  <span style=color:#719e07>auto</span> f <span style=color:#719e07>=</span> []() <span style=color:#719e07>-&gt;</span> <span style=color:#dc322f>int</span> { <span style=color:#719e07>return</span> <span style=color:#2aa198>5</span>; };
</span></span><span style=display:flex><span>Â  Â  std<span style=color:#719e07>::</span>add_const_t<span style=color:#719e07>&lt;</span><span style=color:#719e07>decltype</span>(f())<span style=color:#719e07>&gt;</span> x <span style=color:#719e07>=</span> f();
</span></span><span style=display:flex><span>Â  Â  <span style=color:#719e07>decltype</span>(<span style=color:#719e07>auto</span>) y <span style=color:#719e07>=</span> f();
</span></span><span style=display:flex><span>Â  Â  <span style=color:#586e75>// decltype(auto) const z = f(); // error
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>Â  Â  <span style=color:#719e07>decltype</span>(<span style=color:#719e07>auto</span>) a <span style=color:#719e07>=</span> (four);
</span></span><span style=display:flex><span>Â  Â  <span style=color:#719e07>decltype</span>(<span style=color:#719e07>auto</span>) b <span style=color:#719e07>=</span> four;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li><code>decltype(auto)</code> åªèƒ½ç›´æ¥ä½¿ç”¨ï¼Œä¸èƒ½æ·»åŠ  <code>const</code> ä¹‹ç±»çš„ä¿®é¥°ç¬¦ï¼ˆ<code>auto</code> å¯ä»¥ï¼‰ã€‚</li><li>åŠ æ‹¬å·ä¼šç›¸å½“äºä» <code>T</code> åˆ° <code>T &</code> çš„å˜æ¢ã€‚æ¯”å¦‚ <code>a</code> æ˜¯ <code>const int &</code> ç±»å‹ï¼Œè€Œ <code>b</code> æ˜¯ <code>const int</code> ç±»å‹ã€‚</li></ul><h2 id=ä½¿ç”¨ä¸€ä¸ª-auto-å£°æ˜å¤šä¸ªå˜é‡>ä½¿ç”¨ä¸€ä¸ª <code>auto</code> å£°æ˜å¤šä¸ªå˜é‡
<a class=header-anchor href=#%e4%bd%bf%e7%94%a8%e4%b8%80%e4%b8%aa-auto-%e5%a3%b0%e6%98%8e%e5%a4%9a%e4%b8%aa%e5%8f%98%e9%87%8f></a></h2><p>ä¸æ¨èï¼Œå› ä¸ºä¼šå…±äº«åŒä¸€ä¸ªå‚æ•° <code>T</code>ã€‚</p><p><img src=/assets/f369bf78c8c9fc1e1635fb7191277855.webp></p><p>ä¸Šé¢ç¬¬ä¸‰è¡Œæ¨å¯¼å¤±è´¥ï¼Œå› ä¸ºå­—ç¬¦ç±»å‹åšç®—æ•°è¿ç®—ä¼šè¢«æ•´å‹æå‡ï¼Œç„¶å e å’Œ f çš„ç±»å‹å°±ä¸åŒ¹é…äº†ã€‚</p><h2 id=è¿”å›å€¼ç”¨-auto-æ¨å¯¼ä½†å‡½æ•°æœ‰å¤šä¸ªåˆ†æ”¯>è¿”å›å€¼ç”¨ <code>auto</code> æ¨å¯¼ï¼Œä½†å‡½æ•°æœ‰å¤šä¸ªåˆ†æ”¯
<a class=header-anchor href=#%e8%bf%94%e5%9b%9e%e5%80%bc%e7%94%a8-auto-%e6%8e%a8%e5%af%bc%e4%bd%86%e5%87%bd%e6%95%b0%e6%9c%89%e5%a4%9a%e4%b8%aa%e5%88%86%e6%94%af></a></h2><p><img src=/assets/70abb13ded526610a99c2975e853ed49.webp></p><p>ç±»å‹æ— æ³•æ¨å¯¼ã€‚</p><h2 id=auto-ç±»å‹æ¨å¯¼æ„æˆå¾ªç¯ä¾èµ–><code>auto</code> ç±»å‹æ¨å¯¼æ„æˆå¾ªç¯ä¾èµ–
<a class=header-anchor href=#auto-%e7%b1%bb%e5%9e%8b%e6%8e%a8%e5%af%bc%e6%9e%84%e6%88%90%e5%be%aa%e7%8e%af%e4%be%9d%e8%b5%96></a></h2><p><img src=/assets/feab583f2cedeb032daacf73cd454706.webp></p><h1 id=ç»“æ„åŒ–ç»‘å®šstructured-binding>ç»“æ„åŒ–ç»‘å®šï¼ˆStructured Bindingï¼‰
<a class=header-anchor href=#%e7%bb%93%e6%9e%84%e5%8c%96%e7%bb%91%e5%ae%9astructured-binding></a></h1><p><a href=https://en.cppreference.com/w/cpp/language/structured_binding title="Structured binding declaration (since C++17) - cppreference.com" rel="noopener external nofollow noreferrer" target=_blank class=exturl>Structured binding declaration (since C++17) - cppreference.com<i class="fa fa-external-link-alt"></i></a></p><p><strong>ç»“æ„åŒ–ç»‘å®šçš„è¦æ±‚æ¯”èšåˆç±»çš„é™åˆ¶è¦å¼±ä¸€äº›</strong>ï¼Œéœ€è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ä¹‹ä¸€ï¼š</p><ol><li>C-style æ•°ç»„ã€‚</li><li>æä¾›äº†æ¨¡æ¿æ–¹æ³•é‡è½½ï¼Œä½¿å¾—ç±»å‹èƒ½å¤Ÿè¡¨ç°å¾—åƒ tuple ä¸€æ ·çš„é‚£äº›ç±»ã€‚</li><li>å…¶ä»–æ»¡è¶³æ¡ä»¶çš„ç±»ï¼š<ul><li>ä¸èƒ½æœ‰åŒ¿å union æˆå‘˜ã€‚</li><li>å¦‚æœç±»å‹æœ‰é public æˆå‘˜ï¼Œéœ€è¦ä¸Šä¸‹æ–‡æœ‰è®¿é—®æƒé™ï¼ˆe.g. å­ç±»æ–¹æ³•è®¿ protected æˆå‘˜ï¼Œå‹å…ƒå‡½æ•°ç­‰ï¼‰ã€‚</li></ul></li></ol><p><img src=/assets/1a0439f3069b768a3386ba415946732a.webp></p><p>å¯ä»¥ç»‘å®šæ•°ç»„æˆ–è€…å¯¹æ•°ç»„çš„å¼•ç”¨ï¼š</p><p><img src=/assets/4c173a6ec5f48dcf85b0815731d237bd.webp></p><p>å¯ä»¥ç»‘å®š <em>std::tuple-like classes</em> ã€‚æ¯”å¦‚ä¸ºç±» <code>M</code> æ·»åŠ ç»‘å®šï¼Œéœ€è¦å¢åŠ ï¼š</p><ol><li><code>template&lt;> struct std::tuple_size&lt;M> { ? value = ?; };</code> å³ <code>std::tuple_size</code> ç±»æ¨¡æ¿çš„ç‰¹åŒ–ï¼Œä½¿ç”¨é™æ€å¸¸é‡æä¾›å…ƒç»„çš„é•¿åº¦ã€‚</li><li><code>template&lt;> struct std::tuple_element&lt;0, M> { using type = ?; };</code> å³ä¸ºæ¯ä¸ªå…ƒç´ è¯´æ˜ç±»å‹ã€‚è¿™é‡Œåªè¯´æ˜äº†ç¬¬ 0 ä¸ªå…ƒç´ ç±»å‹ï¼Œåé¢çš„çœç•¥äº†ã€‚ä½¿ç”¨åç‰¹åŒ–åˆ™å¯ä»¥åŒæ—¶è¯´æ˜å¤šä¸ªç±»å‹ã€‚ï¼ˆä¸è¿‡ä¸€è¡Œä¸€ä¸ªç±»å‹å¤åˆ¶ç²˜è´´çœŸçš„å¾ˆç®€å•ï¼‰</li><li>ç‰¹åŒ– <code>get</code> å‡½æ•°æ¨¡æ¿ï¼š</li></ol><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#dc322f>int</span><span style=color:#719e07>&gt;</span> <span style=color:#719e07>auto</span> get(M);
</span></span><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;&gt;</span> <span style=color:#719e07>auto</span> get<span style=color:#719e07>&lt;</span><span style=color:#2aa198>0</span><span style=color:#719e07>&gt;</span>(M) { <span style=color:#719e07>return</span> <span style=color:#2aa198>42</span>; }
</span></span><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;&gt;</span> <span style=color:#719e07>auto</span> get<span style=color:#719e07>&lt;</span><span style=color:#2aa198>1</span><span style=color:#719e07>&gt;</span>(M) { <span style=color:#719e07>return</span> <span style=color:#2aa198>7.0</span>; }
</span></span></code></pre></div><p>å®é™…ä»£ç çœ‹ä¸Šå»è¿˜æ˜¯æ¯”è¾ƒç´§å‡‘çš„ï¼š</p><p><img src=/assets/0d5d1096f56a07a271fe3f835d028923.webp></p><h1 id=class-template-argument-deduction-ctad>Class template argument deduction (CTAD)
<a class=header-anchor href=#class-template-argument-deduction-ctad></a></h1><p><a href=https://en.cppreference.com/w/cpp/language/class_template_argument_deduction title="Class template argument deduction (CTAD) (since C++17) - cppreference.com" rel="noopener external nofollow noreferrer" target=_blank class=exturl>Class template argument deduction (CTAD) (since C++17) - cppreference.com<i class="fa fa-external-link-alt"></i></a></p><p>è¿™è®©åˆ›å»ºä¸€äº›ç±»å‹å˜å¾—æ›´åŠ ç®€å•ï¼š</p><p><a href=https://en.cppreference.com/w/cpp/utility/pair title=std::pair rel="noopener external nofollow noreferrer" target=_blank class=exturl>std::pair<i class="fa fa-external-link-alt"></i></a> <code>p(2, 4.5); // deduces to std::pair&lt;int, double> p(2, 4.5);</code></p><p><a href=https://en.cppreference.com/w/cpp/utility/tuple title=std::tuple rel="noopener external nofollow noreferrer" target=_blank class=exturl>std::tuple<i class="fa fa-external-link-alt"></i></a> <code>t(4, 3, 2.5); // same as auto t = std::make_tuple(4, 3, 2.5);</code></p><p>Deduction guide å¯è§ï¼š
<a href=/cpp-templates-the-complete-guide/02-Class-Templates/ title="02 Class Templates">02 Class Templates</a>ã€‚</p><h2 id=å•æ‹¬å·åˆå§‹åŒ–æ›´åå‘å¤åˆ¶ç§»åŠ¨æ„é€ >å•æ‹¬å·åˆå§‹åŒ–æ›´åå‘å¤åˆ¶/ç§»åŠ¨æ„é€ 
<a class=header-anchor href=#%e5%8d%95%e6%8b%ac%e5%8f%b7%e5%88%9d%e5%a7%8b%e5%8c%96%e6%9b%b4%e5%81%8f%e5%90%91%e5%a4%8d%e5%88%b6%e7%a7%bb%e5%8a%a8%e6%9e%84%e9%80%a0></a></h2><p>å•å…ƒç´ çš„æ‹¬å·åˆå§‹åŒ–ï¼ˆbrace initializerï¼‰å’Œå¤šå…ƒç´ çš„æ‹¬å·åˆå§‹åŒ–æ¨å¯¼è§„åˆ™ä¸åŒã€‚å•å…ƒç´ çš„ä¼šä¼˜å…ˆæ¨å¯¼æˆæ¨¡æ¿ç±»ä»¥ç¡®ä¿å¤åˆ¶æˆ–ç§»åŠ¨è¡Œä¸ºçš„å‘ç”Ÿï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span>std<span style=color:#719e07>::</span>vector v{<span style=color:#2aa198>1</span>, <span style=color:#2aa198>2</span>, <span style=color:#2aa198>3</span>}; <span style=color:#586e75>// vector&lt;int&gt;, not surprising
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>std<span style=color:#719e07>::</span>vector w2{v, v};   <span style=color:#586e75>// vector&lt;vector&lt;int&gt;&gt;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>std<span style=color:#719e07>::</span>vector w1{v};      <span style=color:#586e75>// **vector&lt;int&gt;** !!!
</span></span></span></code></pre></div><h2 id=åŸå§‹æ¨¡æ¿ç±»æœ‰éšå¼æ¨å¯¼è§„åˆ™>åŸå§‹æ¨¡æ¿ç±»æœ‰éšå¼æ¨å¯¼è§„åˆ™
<a class=header-anchor href=#%e5%8e%9f%e5%a7%8b%e6%a8%a1%e6%9d%bf%e7%b1%bb%e6%9c%89%e9%9a%90%e5%bc%8f%e6%8e%a8%e5%af%bc%e8%a7%84%e5%88%99></a></h2><p>æ¯ä¸ªåŸå§‹ç±»æ¨¡æ¿ï¼ˆprimary class templateï¼‰çš„æ„é€ å‡½æ•°éƒ½æœ‰éšå¼çš„ deduction guideï¼Œé™¤éå‚æ•°ä¸åœ¨ deduced context ä¸­ã€‚ï¼ˆå³ä¾¿æ˜¾å¼å£°æ˜äº†è¿™æ ·çš„æ¨å¯¼è§„åˆ™ï¼Œä¹Ÿæ— æ³•åŒ¹é…ä¸Šï¼›ä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯æ¯ä¸ªåŸå§‹ç±»æ¨¡æ¿éƒ½æœ‰è§„åˆ™ï¼Œåªæ˜¯åŒ¹é…å¤±è´¥äº†ã€‚ï¼‰</p><h2 id=injected-class-names>Injected Class Names
<a class=header-anchor href=#injected-class-names></a></h2><p><img src=/assets/c3de7e86b0aba0681f1fd0901a5af562.webp></p><p>åœ¨ C++14 ä¸­å¸¦æ³¨é‡Šè¡Œçš„ <code>X</code> æŒ‡çš„æ˜¯è¢«æ³¨å…¥çš„ç±»åã€‚ä½†æ˜¯æŒ‰ç…§ C++17 çš„ <code>CTAD</code> ä¹Ÿå¯ä»¥æŒ‡éšå¼æ¨å¯¼çš„ç±»å <code>X</code>ï¼Œè¿™æ ·å…¶å‚æ•°å°±ä¸ä¸€å®šå’Œæ³¨å…¥ç±»åä¸€è‡´ã€‚<strong>ä¸ºäº†ä¸å’ŒåŸæ¥çš„ä»£ç å†²çªï¼Œæ­¤æ—¶è§„å®šä¸€å¾‹ä½¿ç”¨æ³¨å…¥çš„ç±»åã€‚</strong></p><h2 id=forwarding-references>Forwarding References
<a class=header-anchor href=#forwarding-references></a></h2><p>å‡è®¾æœ‰ä¸¤æ¡è§„åˆ™ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span> T<span style=color:#719e07>&gt;</span> Y(T <span style=color:#719e07>const</span><span style=color:#719e07>&amp;</span>) <span style=color:#719e07>-&gt;</span> Y<span style=color:#719e07>&lt;</span>T<span style=color:#719e07>&gt;</span>; <span style=color:#586e75>// #1
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#719e07>template</span><span style=color:#719e07>&lt;</span><span style=color:#719e07>typename</span> T<span style=color:#719e07>&gt;</span> Y(T<span style=color:#719e07>&amp;&amp;</span>) <span style=color:#719e07>-&gt;</span> Y<span style=color:#719e07>&lt;</span>T<span style=color:#719e07>&gt;</span>;      <span style=color:#586e75>// #2
</span></span></span></code></pre></div><p>åœ¨é¢å¯¹é <code>const</code> å·¦å€¼å¼•ç”¨æ—¶ï¼Œ<code>#2</code> çš„åŒ¹é…åº¦æ›´é«˜ï¼ˆ<code>#1</code> éœ€è¦æ·»åŠ  <code>const</code> å±æ€§ï¼‰ï¼Œè¿™æœ‰æ—¶å€™ä¼šæœ‰æ„å¤–çš„ç»“æœã€‚å› æ­¤åœ¨ <code>T</code> æœ¬èº«ä¸ºç±»æ¨¡æ¿çš„å‚æ•°æ—¶ç¦ç”¨äº†å…¶å¯¹å¼•ç”¨çš„åŒ¹é…ï¼ˆP319ï¼‰ï¼š</p><blockquote><p>The C++ standardization committee therefore decided to disable the special deduction rule for T&& when performing deduction for implicit deduction guides if the T was originally a class template parameter (as opposed to a constructor template parameter; for those, the special deduction rule remains).</p></blockquote></div><footer class=post-footer><div class=post-tags><a href=/tags/cpp>cpp
</a><a href=/tags/cpp-templates-the-complete-guide>cpp-templates-the-complete-guide</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/cpp-templates-the-complete-guide/13-Names-in-Templates/ rel=next title="CTTCG 13 Names in Templates"><i class="fa fa-chevron-left"></i> CTTCG 13 Names in Templates</a></div><div class="post-nav-prev post-nav-item"><a href=/cpp-templates-the-complete-guide/16-Specializations-and-Overloading/ rel=prev title="CTTCG 16 Specializations and Overloading">CTTCG 16 Specializations and Overloading
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2023 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>ğŸ¤–</span></div><div class=powered-by>ç”± <a href=https://gohugo.io title=0.143.1 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨</div></div></footer><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":false,"save":"manual"},"copybtn":true,"darkmode":false,"hostname":"https://hxhue.github.io/","i18n":{"ds_day":" å¤©å‰","ds_days":" å¤© ","ds_hour":" å°æ—¶å‰","ds_hours":" å°æ—¶ ","ds_just":"åˆšåˆš","ds_min":" åˆ†é’Ÿå‰","ds_mins":" åˆ†é’Ÿ","ds_month":" ä¸ªæœˆå‰","ds_years":" å¹´ ","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","placeholder":"æœç´¢..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":false,"transition":{"collheader":"fadeInLeft","menu_item":"fadeInDown","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline"},"views":{"enable":false,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"cdnjs","router":"https://cdnjs.cloudflare.com/ajax/libs"},"version":"4.5.3"}</script><script type=text/javascript src=/js/main.min.37ba8b54f9d4d784d08028c45eea93b5d4e13eda8ee7fb0d2edd6f3fac66cfd2.js defer></script></body></html>