<!doctype html><html lang=zh-CN data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.143.1"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="åˆè¯» Pro Git"><meta itemprop=description content="ä¸ªäººåšå®¢ï¼Œä¸»è¦æ˜¯é›¶æ•£çš„ç¬”è®°ã€‚"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://hxhue.github.io/imgs/371907.jpg"><meta itemprop=keywords content="pro-git-the-book,git"><link type=text/css rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css><link rel=stylesheet href=/css/main.min.bea76f574a755574e17d42bea39502a74ca3ca4db65807b8c82d3e26dcec8420.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ æˆ‘å¯æ˜¯æœ‰åº•çº¿çš„å“Ÿ ~"}</style><link rel=stylesheet type=text/css href=/css/style.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/github-markdown-css@5.3.0/github-markdown-dark.css><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js></script><script>MathJax={tex:{displayMath:[["$$","$$"],["\\[","\\]"]],inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: false });
  mermaid.mermaidAPI.initialize();
  window.mermaid = mermaid;
</script><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":false,"isHome":false,"isPage":true,"path":"%E5%88%9D%E8%AF%BB-Pro-Git","permalink":"https://hxhue.github.io/pro-git-the-book/%E5%88%9D%E8%AF%BB-Pro-Git/","title":"åˆè¯» Pro Git","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>åˆè¯» Pro Git - Bluegill</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Bluegill</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description></p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href=/about/ class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>å…³äº</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>å½’æ¡£</a></li><li class="menu-item menu-item-categories"><a href=/categories/ class=hvr-icon-pulse rel=section><i class="fa fa-th hvr-icon"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-hashtag hvr-icon"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-daily"><a href=/daily/ class=hvr-icon-pulse rel=section><i class="fa fa-newspaper hvr-icon"></i>éšç¬”</a></li><li class="menu-item menu-item-discovery"><a href=https://rift-fear-f2c.notion.site/2025-1e354a33cfb1802c841bdf29f2f3dab3 class=hvr-icon-pulse rel=section><i class="fa fa-compass hvr-icon"></i>å‘ç°</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>æœç´¢</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=æœç´¢... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>æ–‡ç« ç›®å½•</li><li class=sidebar-nav-overview>ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#git-åŸºç¡€>git åŸºç¡€</a></li><li><a href=#git-add>git add</a></li><li><a href=#git-status>git status</a></li><li><a href=#git-rm>git rm</a></li><li><a href=#git-log>git log</a></li><li><a href=#git-tag>git tag</a></li><li><a href=#git-checkoutbranch>git checkout/branch</a></li><li><a href=#ä¸‰ç§-track-è¿œç¨‹åˆ†æ”¯çš„æ–¹å¼>ä¸‰ç§ track è¿œç¨‹åˆ†æ”¯çš„æ–¹å¼</a></li><li><a href=#git-rebase>git rebase</a></li><li><a href=#git-on-the-server>git on the server</a><ul><li><a href=#å››ç§ä¼ è¾“åè®®>å››ç§ä¼ è¾“åè®®</a></li><li><a href=#bare-repository>Bare Repository</a></li><li><a href=#ssh-å’Œ-git-shell>ssh å’Œ git-shell</a></li><li><a href=#å…¶ä»–æ­å»ºæ–¹å¼>å…¶ä»–æ­å»ºæ–¹å¼</a></li></ul></li><li><a href=#distributed-git>Distributed Git</a><ul><li><a href=#workflow>Workflow</a></li><li><a href=#æ£€æŸ¥æ”¹åŠ¨æ˜¯å¦æœ‰æ ¼å¼é—®é¢˜>æ£€æŸ¥æ”¹åŠ¨æ˜¯å¦æœ‰æ ¼å¼é—®é¢˜</a></li><li><a href=#5072-è§„åˆ™>50/72 è§„åˆ™</a></li><li><a href=#workflow-private-small-team>Workflow: private small team</a></li><li><a href=#workflow-private-managed-team>Workflow: private managed team</a></li><li><a href=#ä½¿ç”¨é‚®ä»¶å·¥ä½œdiff-å’Œ-patch>ä½¿ç”¨é‚®ä»¶å·¥ä½œï¼šdiff å’Œ patch</a></li><li><a href=#ä¸¤ç‚¹å¼å’Œä¸‰ç‚¹å¼çš„-commit-range>ä¸¤ç‚¹å¼å’Œä¸‰ç‚¹å¼çš„ commit range</a></li><li><a href=#åœ¨-git-ä¸­åŒ…å«å¯†é’¥>åœ¨ git ä¸­åŒ…å«å¯†é’¥</a></li><li><a href=#ä¸º-commit-åˆ›å»ºå¯è¯»çš„åç§°>ä¸º commit åˆ›å»ºå¯è¯»çš„åç§°</a></li><li><a href=#åˆ›å»º-archive>åˆ›å»º archive</a></li><li><a href=#shortlog>Shortlog</a></li></ul></li><li><a href=#github>Github</a></li><li><a href=#git-tools>Git Tools</a><ul><li><a href=#git-reflog>git reflog</a><ul><li><a href=#escaping-braces-in-powershell>Escaping braces in PowerShell</a></li></ul></li><li><a href=#commit>{commit}^</a></li><li><a href=#commit-è¡¨ç¤ºæ³•>Commit è¡¨ç¤ºæ³•</a></li><li><a href=#git-add--i>git add -i</a></li><li><a href=#git-stash>git stash</a></li><li><a href=#git-clean>git clean</a></li><li><a href=#gpg-ç­¾å>gpg ç­¾å</a></li><li><a href=#git-grep>git grep</a></li><li><a href=#git-commit---amend>git commit &ndash;amend</a></li><li><a href=#git-rebase--i>git rebase -i</a><ul><li><a href=#git-rebase--i-çš„-edit-é€‰é¡¹>git rebase -i çš„ edit é€‰é¡¹</a></li><li><a href=#git-rebase-å‘ç”Ÿå†²çªæ€ä¹ˆåŠ>git rebase å‘ç”Ÿå†²çªæ€ä¹ˆåŠ</a></li></ul></li><li><a href=#git-reset>git reset</a><ul><li><a href=#åª-reset-éƒ¨åˆ†æ–‡ä»¶>åª reset éƒ¨åˆ†æ–‡ä»¶</a></li><li><a href=#ç”¨-reset-æ¥åš-squashing>ç”¨ reset æ¥åš squashing</a></li></ul></li><li><a href=#git-checkout>git checkout</a></li><li><a href=#git-merge>git merge</a></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=ğŸ¤– src=/imgs/371907.jpg><p class=site-author-name itemprop=name>ğŸ¤–</p><div class=site-description itemprop=description>ä¸ªäººåšå®¢ï¼Œä¸»è¦æ˜¯é›¶æ•£çš„ç¬”è®°ã€‚</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>433</span>
<span class=site-state-item-name>æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>12</span>
<span class=site-state-item-name>åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>86</span>
<span class=site-state-item-name>æ ‡ç­¾</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/hxhue title="Github â†’ https://github.com/hxhue" rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>
Github
</a></span><span class=links-of-social-item><a href=/rss.xml title="RSS è®¢é˜… â†’ /rss.xml" rel=noopener target=_blank><i class="fa fa-rss fa-fw"></i>
RSS è®¢é˜…</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=å…±äº«çŸ¥è¯†><img src=/imgs/cc/big/by_nc_sa.svg alt=å…±äº«çŸ¥è¯†></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
å‹æƒ…é“¾æ¥</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://shuai.guru/ title=https://shuai.guru/ target=_blank>shuai.guru</a></li></ul></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=toggle-theme class=button title=æ·±æµ…æ¨¡å¼åˆ‡æ¢><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=è¿”å›é¡¶éƒ¨><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://hxhue.github.io/pro-git-the-book/%E5%88%9D%E8%AF%BB-Pro-Git/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/371907.jpg"><meta itemprop=name content="ğŸ¤–"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="ğŸ¤–"><meta itemprop=description content="ä¸ªäººåšå®¢ï¼Œä¸»è¦æ˜¯é›¶æ•£çš„ç¬”è®°ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="åˆè¯» Pro Git"><meta itemprop=description content="ä¸€äº›éœ€è¦å¼„æ˜ç™½çš„åè¯ï¼šcommit range/refspecã€‚
git åŸºç¡€

git çš„ç®¡ç†æ–¹å¼æ˜¯è®°å½•æ¯ä¸ªæ–‡ä»¶çš„å¿«ç…§ã€‚








ç„¶ååˆ†æˆä¸‰ä¸ªåŒºï¼š








git add

å¦‚æœä¸€ä¸ªæ–‡ä»¶æ”¹åŠ¨äº†å¤šä¸ªåœ°æ–¹ï¼Œä½†æ˜¯åªæƒ³è¦æäº¤å…¶ä¸­çš„éƒ¨åˆ†è¡Œï¼Œå¯ä»¥ç”¨ git add --patchã€‚è¿™æ · git ä¼šå¯åŠ¨ä¸€ä¸ªäº¤äº’å¼çš„ç¨‹åºï¼Œå¹¶è¯¢é—®ç”¨æˆ·æ¯ä¸ª chunk æ˜¯å¦è¦åŠ å…¥ã€‚è¿™ç§äº¤äº’å¼ç¯å¢ƒæä¾›å¤šç§æ“ä½œï¼Œå…¶ä¸­ e æ“ä½œå…è®¸ç”¨æˆ·ä½¿ç”¨ç¼–è¾‘å™¨ç²¾å‡†ç¼–è¾‘è¦æ·»åŠ çš„ä¿®æ”¹ã€‚"></span><header class=post-header><h1 class=post-title itemprop="name headline">åˆè¯» Pro Git</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-11-16 00:00:00 +0800 CST" itemprop="dateCreated datePublished" datetime="2023-11-16 00:00:00 +0800 CST">2023-11-16
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar-check"></i>
</span><span class=post-meta-item-text title=æ›´æ–°äº>æ›´æ–°äºï¼š
</span><time title=ä¿®æ”¹æ—¶é—´ï¼š2025-04-26T00:00:00+08:00 itemprop=dateModified datetime=2025-04-26T00:00:00+08:00>2025-04-26</time>
</span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/pro-git-the-book itemprop=url rel=index><span itemprop=name>pro-git-the-book</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=å­—æ•°><span class=post-meta-item-icon><i class="far fa-file-word"></i>
</span><span class=post-meta-item-text>å­—æ•°ï¼š</span>
<span>8455</span>
</span><span class=post-meta-item title=é˜…è¯»><span class=post-meta-item-icon><i class="far fa-clock"></i>
</span><span class=post-meta-item-text>é˜…è¯»ï¼š&ap;</span>
<span>17åˆ†é’Ÿ</span></span></div></div></header><div class=post-body itemprop=articleBody><p>ä¸€äº›éœ€è¦å¼„æ˜ç™½çš„åè¯ï¼šcommit range/refspecã€‚</p><h1 id=git-åŸºç¡€>git åŸºç¡€
<a class=header-anchor href=#git-%e5%9f%ba%e7%a1%80></a></h1><p>git çš„ç®¡ç†æ–¹å¼æ˜¯è®°å½•æ¯ä¸ªæ–‡ä»¶çš„å¿«ç…§ã€‚</p><p><img src=/assets/85fc388c6e2e33f14af4af02b672389b.webp></p><p>ç„¶ååˆ†æˆä¸‰ä¸ªåŒºï¼š</p><p><img src=/assets/0a706ecf17b1dad0bff56e9c61c58c73.webp></p><h1 id=git-add>git add
<a class=header-anchor href=#git-add></a></h1><p>å¦‚æœä¸€ä¸ªæ–‡ä»¶æ”¹åŠ¨äº†å¤šä¸ªåœ°æ–¹ï¼Œä½†æ˜¯åªæƒ³è¦æäº¤å…¶ä¸­çš„éƒ¨åˆ†è¡Œï¼Œå¯ä»¥ç”¨ <code>git add --patch</code>ã€‚è¿™æ · git ä¼šå¯åŠ¨ä¸€ä¸ªäº¤äº’å¼çš„ç¨‹åºï¼Œå¹¶è¯¢é—®ç”¨æˆ·æ¯ä¸ª chunk æ˜¯å¦è¦åŠ å…¥ã€‚è¿™ç§äº¤äº’å¼ç¯å¢ƒæä¾›å¤šç§æ“ä½œï¼Œå…¶ä¸­ <code>e</code> æ“ä½œå…è®¸ç”¨æˆ·ä½¿ç”¨ç¼–è¾‘å™¨ç²¾å‡†ç¼–è¾‘è¦æ·»åŠ çš„ä¿®æ”¹ã€‚</p><h1 id=git-status>git status
<a class=header-anchor href=#git-status></a></h1><p><code>git status</code> å¯ä»¥æ˜¾ç¤ºå½“å‰å·¥ä½œåŒºçš„çŠ¶æ€ã€‚æ·»åŠ  <code>-s</code> é€‰é¡¹ï¼Œå³ <code>git status -s</code>ï¼Œå¯ä»¥æ˜¾ç¤ºæ›´ç®€å•ï¼ˆæ‘˜è¦ï¼‰çš„çŠ¶æ€ï¼ˆå¾ˆåƒ VS Code è¾¹æ ä¸Šçš„ä¿¡æ¯ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git status -s
</span></span><span style=display:flex><span>?? .cache/
</span></span><span style=display:flex><span>?? .clang-tidy
</span></span><span style=display:flex><span>?? utils/clang-tidy.py
</span></span></code></pre></div><p>è¾“å‡ºçš„æœ‰äº›æ–‡ä»¶ç­¾åæ˜¯åŒé—®å·ï¼Œè¡¨ç¤º untrackedã€‚</p><h1 id=git-rm>git rm
<a class=header-anchor href=#git-rm></a></h1><p><strong>å…³äº <code>git rm --cached</code> å’Œ <code>git restore --staged</code> çš„åŒºåˆ«</strong>ï¼ˆ<a href=https://stackoverflow.com/a/65434709/ title=https://stackoverflow.com/a/65434709/ rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://stackoverflow.com/a/65434709/<i class="fa fa-external-link-alt"></i></a>ï¼‰ï¼š</p><blockquote><p><code>git rm --cached file</code>: removes the copy of the file from the index / staging-area, without touching the working tree copy. The proposed next commit now lacks the file. If the current commit has the file, and you do in fact make a next commit at this point, the difference between the previous commit and the new commit is that the file is gone.</p><p><code>git restore --staged file</code>: Git copies the file from the HEAD commit into the index, without touching the working tree copy. The index copy and the HEAD copy now match, whether or not they matched before. A new commit made now will have the same copy of the file as the current commit.</p><p>If the current commit lacks the file, this has the effect of removing the file from the index. So in this case it does the same thing as <code>git rm --cached</code>.</p><p><code>git reset file</code>: this copies the HEAD version of the file to the index, just like <code>git restore --staged file</code>.</p></blockquote><p>æ³¨æ„è½¬ä¹‰æ˜Ÿå·ï¼ˆgit æœ¬èº«å’Œéƒ¨åˆ† shell ä¼šè§£é‡Šæ˜Ÿå·ï¼‰ï¼Œæ¯”å¦‚<code>git rm log/\*.log</code>ã€‚</p><h1 id=git-log>git log
<a class=header-anchor href=#git-log></a></h1><p><code>git log -p -2</code>ï¼ˆä¹Ÿå¯ä»¥å†™æˆ <code>--patch</code>ï¼‰èƒ½å¤Ÿåœ¨æ˜¾ç¤ºæ—¥å¿—çš„æ—¶å€™åŒæ—¶æ˜¾ç¤ºæ”¹åŠ¨çš„å†…å®¹ï¼ˆç›¸å½“äºåŒæ—¶åšäº† diffï¼‰ï¼Œç„¶å <code>-2</code> é™åˆ¶äº†åªæ˜¾ç¤ºæœ€å¼€å¤´çš„ä¸¤ä¸ª commitsï¼ˆè¿™ä¸ªé€‰é¡¹å’Œ <code>-p</code> æ˜¯æ­£äº¤çš„ï¼‰ã€‚</p><p><code>git log --stat</code> ä¼šåœ¨ log ä¸­æ˜¾ç¤ºæ¯ä¸ª commit çš„ summaryã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git log --pretty<span style=color:#719e07>=</span>oneline
</span></span><span style=display:flex><span>ca82a6dff817ec66f44342007202690a93763949 Change version number
</span></span><span style=display:flex><span>085bb3bcb608e1e8451d4b2432f8ecbe6306e7e7 Remove unnecessary <span style=color:#b58900>test</span>
</span></span><span style=display:flex><span>a11bef06a3f659402fe7563abf99ad00de2209e6 Initial commit
</span></span></code></pre></div><p><code>--pretty=oneline</code> ä¼šæ˜¾ç¤ºå®Œæ•´çš„ hashï¼Œè€Œ <code>--oneline</code> åªæ˜¾ç¤ºå‰ 7 ä¸ªå­—ç¬¦ï¼ˆ<code>--pretty=oneline --abbrev-commit</code>ï¼‰ã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git log --pretty<span style=color:#719e07>=</span>format:<span style=color:#2aa198>&#34;%h - %an, %ar : %s&#34;</span>
</span></span><span style=display:flex><span>ca82a6d - Scott Chacon, <span style=color:#2aa198>6</span> years ago : Change version number
</span></span><span style=display:flex><span>085bb3b - Scott Chacon, <span style=color:#2aa198>6</span> years ago : Remove unnecessary <span style=color:#b58900>test</span>
</span></span><span style=display:flex><span>a11bef0 - Scott Chacon, <span style=color:#2aa198>6</span> years ago : Initial commit
</span></span></code></pre></div><p><code>-S</code> è¡¨ç¤ºæœç´¢ï¼Œè¿™ä¼šè¿‡æ»¤æ•´ä¸ªä»“åº“çš„ commitsï¼ˆå¦‚æœä»“åº“å¾ˆå¤§å¯èƒ½æœ‰ç‚¹æ…¢ï¼‰å¹¶æ˜¾ç¤ºæ‰€æœ‰è®©ç»™å®šçš„å­—ç¬¦ä¸²çš„å‡ºç°æ¬¡æ•°æ”¹å˜çš„ commitsã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git log -S narrow_cast
</span></span><span style=display:flex><span>commit 287fd454cdaca7bf65b0be8e91c730ebeb6bdecd <span style=color:#719e07>(</span>HEAD -&gt; types, origin/xx/types<span style=color:#719e07>)</span>
</span></span><span style=display:flex><span>Author: AA BB &lt;user@email.com&gt;
</span></span><span style=display:flex><span>Date:   Thu Nov <span style=color:#2aa198>16</span> 21:28:44 <span style=color:#2aa198>2023</span> +0800
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    feat: narrow_cast and sign_cast
</span></span></code></pre></div><p>æ˜¾ç¤ºè®©ç‰¹å®šæ–‡ä»¶æ”¹å˜çš„é‚£äº›æäº¤ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git log -- path/to/file
</span></span></code></pre></div><p>æ˜¾ç¤ºç‰¹å®š commit çš„æ—¥å¿—ï¼ˆè€Œä¸æ˜¯ HEADï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git log master
</span></span></code></pre></div><h1 id=git-tag>git tag
<a class=header-anchor href=#git-tag></a></h1><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git tag
</span></span><span style=display:flex><span>v1.0
</span></span><span style=display:flex><span>v2.0
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git tag -l <span style=color:#2aa198>&#34;v1.8.5*&#34;</span>
</span></span><span style=display:flex><span>v1.8.5
</span></span><span style=display:flex><span>v1.8.5-rc0
</span></span><span style=display:flex><span>v1.8.5-rc1
</span></span><span style=display:flex><span>v1.8.5-rc2
</span></span><span style=display:flex><span>v1.8.5-rc3
</span></span></code></pre></div><p><mark>git æ”¯æŒä¸¤ç§ tagï¼šlightweight å’Œ annotated</mark>ã€‚åˆ›å»ºæœ‰æ³¨é‡Šçš„ tag å¯ä»¥ç”¨äºå‘å¸ƒï¼Œè¿™äº›ä¿¡æ¯ä¼šè¯¦ç»†åœ°å­˜å‚¨åœ¨ repo ä¸­ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git tag -a v1.4 -m <span style=color:#2aa198>&#34;my version 1.4&#34;</span>
</span></span></code></pre></div><p><code>-m</code> å’Œ <code>git commit</code> çš„ <code>-m</code> é€‰é¡¹ç±»ä¼¼ï¼Œå¦‚æœä¸ç»™å°±ä¼šå¼¹å‡ºé»˜è®¤çš„ç¼–è¾‘å™¨ã€‚</p><p>å¦‚æœä¸åŠ  <code>-a</code> é€‰é¡¹ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªç®€å•çš„ tagï¼Œå°±åƒä¸€ä¸ªä¸ç”¨æ›´æ–°çš„ branch ä¸€æ ·ã€‚è¿™æ ·çš„ tag é€‚åˆä¸´æ—¶ä½¿ç”¨ã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git tag v1.4-lw
</span></span><span style=display:flex><span>$ git show v1.4-lw
</span></span><span style=display:flex><span>commit ca82a6dff817ec66f44342007202690a93763949
</span></span><span style=display:flex><span>Author: Scott Chacon &lt;schacon@gee-mail.com&gt;
</span></span><span style=display:flex><span>Date: Mon Mar <span style=color:#2aa198>17</span> 21:52:11 <span style=color:#2aa198>2008</span> -0700
</span></span><span style=display:flex><span>Change version number
</span></span></code></pre></div><p>ç»™é™¤äº† HEAD ä»¥å¤–çš„ commit åŠ  tag çš„ä¾‹å­ï¼ˆéœ€è¦å¤šåŠ ä¸€ä¸ªå‚æ•°ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git tag -a v1.2 9fceb02
</span></span></code></pre></div><blockquote><p>By default, the git push command doesn&rsquo;t transfer tags to remote servers.</p></blockquote><p><code>git push origin &lt;tagname></code> èƒ½å¤ŸæŠŠæœ¬åœ°çš„ tag æ¨é€åˆ°è¿œç¨‹ä¸»æœºã€‚
<code>git push origin --tags</code> ä¼šå°†æœ¬åœ°çš„æ‰€æœ‰ tagsï¼ˆåŒ…æ‹¬ lightweight å’Œ annotatedï¼‰æ¨é€çš„è¿œç¨‹ä¸»æœºã€‚
<code>git push origin --follow-tags</code> ä¼šå°†æœ¬åœ°çš„æ‰€æœ‰ annotated tags æ¨é€çš„è¿œç¨‹ä¸»æœºã€‚</p><div class="markdown-alert markdown-alert-note"><p class=markdown-alert-title><svg class="octicon octicon-info mr-2" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z"/></svg>Note</p><p>åœ¨æˆ‘é˜…è¯» Pro Git è¿™æœ¬ä¹¦çš„æ—¶å€™ï¼Œè¿˜æ²¡æœ‰åªæ¨é€ lightweight tags çš„é€‰é¡¹ã€‚</p></div><p>åˆ é™¤ä¸€ä¸ªæœ¬åœ°çš„ tagï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git tag -d v1.4-lw
</span></span></code></pre></div><p>åˆ é™¤ä¸€ä¸ªè¿œç¨‹çš„ tagï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git push origin :refs/tags/v1.4-lw
</span></span></code></pre></div><p>ä¹Ÿå¯ä»¥ç”¨ <code>git push origin --delete &lt;tagname></code> è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚</p><h1 id=git-checkoutbranch>git checkout/branch
<a class=header-anchor href=#git-checkoutbranch></a></h1><p><code>git checkout -b newBranch &lt;commit></code> å¯ä»¥ä»ç»™å®šçš„ commit åˆ†å‰å‡ºä¸€ä¸ªæ–°åˆ†æ”¯ã€‚è¿™é‡Œçš„ commit è¿˜å¯ä»¥ç”¨ branch æˆ–è€… tagã€‚è¿™æ ·å°±ä¸å¿…å…ˆ checkout åˆ°ç»™å®šçš„åˆ†æ”¯å†åˆ›å»ºæ–°çš„äº†ï¼ˆä¸¤æ­¥åˆæˆä¸€æ­¥ï¼‰ã€‚</p><p>git çš„æœ‰å‘æ— ç¯å›¾ç»“æ„å­˜å‚¨çš„æ˜¯ parent æŒ‡é’ˆï¼ˆå¯èƒ½æœ‰å¤šä¸ªï¼‰ï¼Œè€Œä¸æ˜¯ children æŒ‡é’ˆã€‚æ¯ä¸ªåˆ†æ”¯ã€tag éƒ½åŒ…å«äº†è¿™æ ·çš„æŒ‡é’ˆã€‚</p><p><strong>åˆ›å»ºæ–°çš„åˆ†æ”¯ä½†æ˜¯ä¸ checkout</strong>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git branch testing
</span></span></code></pre></div><p><img src=/assets/9118957388d1d527952877a83ebd98bd.webp></p><p><code>git log --decorate</code> ä¼šåœ¨æ—¥å¿—ä¸­å±•ç¤ºæ¯ä¸ª commit å’Œå“ªäº›åˆ†æ”¯å…³è”ï¼Œç›¸å½“äº <code>git log --decorate=short</code>ã€‚æ—§ git ä¸ä¼šè‡ªåŠ¨ decorateï¼Œè€Œæ–°ç‰ˆå·²ç»é»˜è®¤å¼€å¯äº† <code>--decorate=auto</code>ã€‚</p><p>åˆ›å»ºå¹¶è½¬ç§»åˆ°æ–°çš„åˆ†æ”¯ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git checkout -b branchA
</span></span><span style=display:flex><span><span style=color:#586e75># or</span>
</span></span><span style=display:flex><span>git switch -c branchA
</span></span><span style=display:flex><span><span style=color:#586e75># -c is the same as --create</span>
</span></span></code></pre></div><p>git çš„ hash å…¨é•¿æ˜¯ 40 ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ç®€å†™æ˜¯ 7 ä¸ªå­—ç¬¦ã€‚åœ¨ unmerged files é‡Œé¢ç•™çš„æ ‡è®°ä¹Ÿæ˜¯è¿ç»­ 7 ä¸ª <code>&lt;</code>ã€<code>=</code>ã€<code>></code>ã€‚</p><p><code>git branch -v</code> èƒ½æ˜¾ç¤ºåˆ†æ”¯å’Œå„åˆ†æ”¯æœ€è¿‘ä¸€æ¬¡çš„æäº¤ã€‚<code>git branch -vv</code> ä¼šæ¯” <code>-v</code> å¤šæ˜¾ç¤ºæœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯çš„ track å…³ç³»ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git branch -vv
</span></span><span style=display:flex><span>iss53 7e424c3 <span style=color:#719e07>[</span>origin/iss53: ahead 2<span style=color:#719e07>]</span> Add forgotten brackets
</span></span><span style=display:flex><span>master 1ae2a45 <span style=color:#719e07>[</span>origin/master<span style=color:#719e07>]</span> Deploy index fix
</span></span><span style=display:flex><span>- serverfix f8674d9 <span style=color:#719e07>[</span>teamone/server-fix-good: ahead 3, behind 1<span style=color:#719e07>]</span> This should <span style=color:#719e07>do</span> it
</span></span><span style=display:flex><span>testing 5ea463a Try something new
</span></span></code></pre></div><blockquote><p>The useful <code>--merged</code> and <code>--no-merged</code> options can filter this list to branches that you have or have not
yet merged into the branch you&rsquo;re currently on.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git branch         <span style=color:#586e75># æ˜¾ç¤ºæœ¬åœ°åˆ†æ”¯</span>
</span></span><span style=display:flex><span>git branch -r      <span style=color:#586e75># æ˜¾ç¤ºè¿œç¨‹åˆ†æ”¯</span>
</span></span><span style=display:flex><span>git branch --all   <span style=color:#586e75># æ˜¾ç¤ºæœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯</span>
</span></span></code></pre></div><p>åœ¨å…‹éš†çš„æ—¶å€™å¯ä»¥æŒ‡å®šè¿œç¨‹ä¸»æœºçš„å‘½åï¼ˆå¦åˆ™æ˜¯ originï¼‰ï¼Œæ¯”å¦‚<code>git clone -o booyah</code></p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git push origin serverfix
</span></span><span style=display:flex><span>Counting objects: 24, <span style=color:#719e07>done</span>.
</span></span><span style=display:flex><span>Delta compression using up to <span style=color:#2aa198>8</span> threads.
</span></span><span style=display:flex><span>Compressing objects: 100% <span style=color:#719e07>(</span>15/15<span style=color:#719e07>)</span>, <span style=color:#719e07>done</span>.
</span></span><span style=display:flex><span>Writing objects: 100% <span style=color:#719e07>(</span>24/24<span style=color:#719e07>)</span>, 1.91 KiB | <span style=color:#2aa198>0</span> bytes/s, <span style=color:#719e07>done</span>.
</span></span><span style=display:flex><span>Total <span style=color:#2aa198>24</span> <span style=color:#719e07>(</span>delta 2<span style=color:#719e07>)</span>, reused <span style=color:#2aa198>0</span> <span style=color:#719e07>(</span>delta 0<span style=color:#719e07>)</span>
</span></span><span style=display:flex><span>To https://github.com/schacon/simplegit
</span></span><span style=display:flex><span>- <span style=color:#719e07>[</span>new branch<span style=color:#719e07>]</span> serverfix -&gt; serverfix
</span></span></code></pre></div><blockquote><p>Git automatically expands the serverfix branch name out to <code>refs/heads/serverfix:refs/heads/serverfix</code>.</p></blockquote><h1 id=ä¸‰ç§-track-è¿œç¨‹åˆ†æ”¯çš„æ–¹å¼>ä¸‰ç§ track è¿œç¨‹åˆ†æ”¯çš„æ–¹å¼
<a class=header-anchor href=#%e4%b8%89%e7%a7%8d-track-%e8%bf%9c%e7%a8%8b%e5%88%86%e6%94%af%e7%9a%84%e6%96%b9%e5%bc%8f></a></h1><p>ä»ç»™å®šçš„åˆ†æ”¯ checkout å‡ºæ–°åˆ†æ”¯ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git checkout -b sf origin/serverfix
</span></span><span style=display:flex><span>Branch sf <span style=color:#b58900>set</span> up to track remote branch serverfix from origin.
</span></span><span style=display:flex><span>Switched to a new branch <span style=color:#2aa198>&#39;sf&#39;</span>
</span></span></code></pre></div><p><mark>åŒæ—¶ï¼Œç”±äº checkout åˆ°çš„æ–°åˆ†æ”¯æ˜¯åŸºäºè¿œç¨‹åˆ†æ”¯çš„ï¼Œä¼šè‡ªåŠ¨ trackï¼</mark></p><p><strong>track ä¸€ä¸ªè¿œç¨‹åˆ†æ”¯</strong>çš„å¦å¤–ä¸€ç§å†™æ³•ï¼ˆæœ¬åœ°çš„åˆ†æ”¯åä¹Ÿæ˜¯ <code>serverfix</code>ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git checkout --track origin/serverfix
</span></span></code></pre></div><p>è¿™æ¡å‘½ä»¤å¹¶<strong>ä¸æ˜¯è®©å½“å‰åˆ†æ”¯</strong>å» track è¿œç¨‹åˆ†æ”¯ï¼Œ<strong>è€Œæ˜¯åˆ›å»ºä¸€ä¸ªåŒååˆ†æ”¯å¹¶ track è¿œç¨‹åˆ†æ”¯</strong>ã€‚ç›¸å½“äº <code>git checkout -b severfix origin/serverfix</code>ã€‚</p><p>å¦‚æœ checkout çš„åˆ†æ”¯ä¸å­˜åœ¨ï¼Œè€Œä¸”åˆæ°å¥½æœ‰å¯¹åº”çš„è¿œç¨‹åˆ†æ”¯ï¼Œå¯ä»¥ä¸åŠ é€‰é¡¹åœ°ä½¿ç”¨ checkoutï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git checkout serverfix
</span></span><span style=display:flex><span>Branch serverfix <span style=color:#b58900>set</span> up to track remote branch serverfix from origin.
</span></span><span style=display:flex><span>Switched to a new branch <span style=color:#2aa198>&#39;serverfix&#39;</span>
</span></span></code></pre></div><p>è¦è®©å½“å‰åˆ†æ”¯å» track ç»™å®šçš„è¿œç¨‹åˆ†æ”¯ï¼Œå¯ä»¥ç”¨ <code>git branch -u</code>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git branch -u origin/serverfix
</span></span><span style=display:flex><span>Branch serverfix <span style=color:#b58900>set</span> up to track remote branch serverfix from origin.
</span></span></code></pre></div><p>å¦‚æœæœ¬åœ°åˆ†æ”¯ track äº†è¿œç¨‹åˆ†æ”¯ï¼Œç”¨ <code>@{u}</code> æˆ–è€… <code>@{upstream}</code> å¯ä»¥ä»£è¡¨å¯¹åº”çš„è¿œç¨‹åˆ†æ”¯ã€‚è¿™æ ·åœ¨ <code>git merge</code> ç­‰åœºæ™¯ä¼šæ¯”è¾ƒæ–¹ä¾¿ã€‚</p><h1 id=git-rebase>git rebase
<a class=header-anchor href=#git-rebase></a></h1><p><strong>git rebase</strong> å¯ä»¥ç”¨æ¥å°†åˆ†æ”¯ä¸Šçš„ commits çº¿æ€§æ·»åŠ åˆ°å¦å¤–ä¸€ä¸ªåˆ†æ”¯ä¸Šã€‚</p><p><img src=/assets/930e59e6da017d48c685aa0adad7c504.webp></p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœæƒ³è¦è®© client çš„æ”¹åŠ¨æ”¾åˆ° master ä¸Šï¼Œä½†æ˜¯ä¸æƒ³è¦ server çš„æ”¹åŠ¨ä¹Ÿå°±æ˜¯ C3 ä¹Ÿç§»åŠ¨è¿‡å»ï¼Œå°±éœ€è¦ç”¨åˆ° rebaseã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git rebase --onto master server client
</span></span><span style=display:flex><span><span style=color:#586e75># åŒ git rebase --onto master &#34;$(git merge-base server client)&#34; client</span>
</span></span></code></pre></div><p>ä¸Šé¢çš„å‘½ä»¤æŒ‡å®šè¦å‰å¾€çš„æ–°åˆ†æ”¯æ˜¯ masterã€‚è€Œä» server åˆ° client æ˜¯è¦æŒ‘é€‰çš„ commits èŒƒå›´ã€‚git rebase ä¼šä»è€ƒè™‘ä¸¤ä¸ªåˆ†æ”¯çš„ç¥–å…ˆï¼ˆä¸åŒ…å«ï¼‰åˆ°ç¬¬äºŒä¸ªåˆ†æ”¯ï¼ˆåŒ…å«ï¼‰ä¹‹é—´çš„æ”¹åŠ¨ã€‚</p><h1 id=git-on-the-server>git on the server
<a class=header-anchor href=#git-on-the-server></a></h1><h2 id=å››ç§ä¼ è¾“åè®®>å››ç§ä¼ è¾“åè®®
<a class=header-anchor href=#%e5%9b%9b%e7%a7%8d%e4%bc%a0%e8%be%93%e5%8d%8f%e8%ae%ae></a></h2><p>git æ”¯æŒå››ç§åè®®ï¼šlocal/http/ssh/gitã€‚</p><p>local å¯ä»¥æ˜¯ file:// å¼€å¤´çš„ urlï¼Œä¹Ÿå¯ä»¥æ˜¯æœ¬åœ°è·¯å¾„ã€‚å‰è€…ä¼šä½¿ç”¨æœ¬åœ°ç½‘ç»œæ‹·è´ï¼Œé€Ÿåº¦è¾ƒæ…¢ã€‚åè€…ä¼šä½¿ç”¨ç¡¬é“¾æ¥æˆ–è€…ç›´æ¥æ‹·è´æ–‡ä»¶ï¼Œé€Ÿåº¦å¿«ä½†æ˜¯ä¸å¦‚å‰è€…å¹²å‡€ï¼ˆæ¯”å¦‚åˆšä» svn è½¬ç§»è¿‡æ¥æ—¶æœ‰ä¸å°‘å†—ä½™åˆ†æ”¯ï¼‰ã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>/tmp/git-remote $ git remote add origin /root/proj/.git
</span></span><span style=display:flex><span>/tmp/git-remote $ git fetch origin
</span></span><span style=display:flex><span>remote: Enumerating objects: 15548, <span style=color:#719e07>done</span>.
</span></span><span style=display:flex><span>remote: Counting objects: 100% <span style=color:#719e07>(</span>15548/15548<span style=color:#719e07>)</span>, <span style=color:#719e07>done</span>.
</span></span><span style=display:flex><span>remote: Compressing objects: 100% <span style=color:#719e07>(</span>5231/5231<span style=color:#719e07>)</span>, <span style=color:#719e07>done</span>.
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>æœ¬åœ°åè®®çš„ç»ˆç‚¹å¿…é¡»æ˜¯ä¸€ä¸ª bare repositoryï¼Œä¹Ÿå°±æ˜¯ .git æ–‡ä»¶å¤¹ï¼Œè€Œä¸åŒ…å«å·¥ä½œåŒºæ–‡ä»¶ã€‚äº‹å®ä¸Šï¼Œè¿œç¨‹ä»“åº“æ²¡æœ‰å·¥ä½œåŒºï¼Œå› ä¸ºæ²¡æœ‰äººä¼šåœ¨è¿œç¨‹ä»“åº“ç›´æ¥å·¥ä½œã€‚</p><p><strong>ç”¨ NFS æ­å»ºçš„è¿œç¨‹è®¿é—®ä¸Šçš„ file:// åè®®å¾€å¾€é€Ÿåº¦æ¯” ssh è¦æ…¢</strong>ã€‚æ‰€ä»¥é™¤éæ˜¯å¯ä»¥æœ¬åœ°è®¿é—®ï¼ˆä¸€å°å¤§æœåŠ¡å™¨ä¸Šçš„å¤šä¸ª docker å®¹å™¨ä½¿ç”¨äº†è·¯å¾„æ˜ å°„ï¼‰ï¼Œä½†ä¸å»ºè®®è¿™ç§æ–¹å¼ã€‚ï¼ˆæ”¾åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šä¹Ÿä¸å®‰å…¨å§ï¼Ÿï¼‰</p><p>git ç”¨çš„ http åè®®åˆ†æˆ smart http å’Œ dumb httpã€‚å‰è€…ï¼ˆç°åœ¨ä¸€èˆ¬ä½¿ç”¨çš„æ˜¯è¿™ä¸ªï¼‰é€šè¿‡ http åè®®æ”¯æŒå„ç§åŠŸèƒ½ï¼Œåè€…åªèƒ½ä½œä¸ºä¸€ä¸ªç®€å•çš„ http æœåŠ¡å™¨ serve è£¸ä»“åº“ã€‚è£¸ä»“åº“å…‹éš†ä¹‹åä¸ä¼šè‡ªåŠ¨è®¾ç½®ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚ objects/info/packs å’Œ info/refsã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ <span style=color:#b58900>cd</span> /var/www/htdocs/
</span></span><span style=display:flex><span>$ git clone --bare /path/to/git_project gitproject.git
</span></span><span style=display:flex><span>$ <span style=color:#b58900>cd</span> gitproject.git
</span></span><span style=display:flex><span>$ mv hooks/post-update.sample hooks/post-update
</span></span><span style=display:flex><span>$ chmod a+x hooks/post-update
</span></span></code></pre></div><p>ssh åè®®å¯ä»¥ä¸ç”¨åŠ  ssh:// å‰ç¼€ï¼ˆä¹Ÿå¯ä»¥åŠ ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git clone user@git.example.com:/srv/git/my_project.git
</span></span></code></pre></div><blockquote><p>Finally, we have the Git protocol. This is a special daemon that comes packaged with Git; it listens on a dedicated port (9418) that provides a service similar to the SSH protocol, but with absolutely no authentication or cryptography.</p></blockquote><p>git åè®®è¿˜éœ€è¦åˆ›å»º git-daemon-export-ok æ–‡ä»¶ã€‚git åè®®æ˜¯æ‰€æœ‰äººéƒ½æœ‰æƒé™ï¼Œä¸éœ€è¦è®¤è¯ï¼Œæ‰€ä»¥ä¸€èˆ¬å¤§å®¶åªå¼€æ”¾ pull è€Œä¸å¼€æ”¾ pushã€‚git åè®®æ˜¯æ‰€æœ‰åè®®ä¸­æœ€å¿«çš„ï¼Œå®ƒä½¿ç”¨äº†å’Œ ssh ç›¸åŒçš„æ•°æ®ä¼ è¾“åè®®ï¼Œä½†æ˜¯æ²¡æœ‰åŠ å¯†ä¼ è¾“çš„å¼€é”€ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äº git åè®®ä¸åŠ å¯†ï¼Œæ‰€ä»¥ pull ä¸‹æ¥çš„ä»£ç å¯èƒ½æ˜¯ä¸å®‰å…¨çš„ï¼ˆæ¯”å¦‚ä¸­é—´äººæ”»å‡»æ’å…¥æ¶æ„ä»£ç ï¼‰ã€‚è€Œ https å’Œ ssh éƒ½æ˜¯æœ‰åŠ å¯†çš„ã€‚</p><p>git åè®®éœ€è¦è‡ªå·±çš„ daemonï¼Œæ‰€ä»¥æ­å»ºèµ·æ¥ä¹Ÿä¸æ˜¯å¾ˆå®¹æ˜“ã€‚</p><h2 id=bare-repository>Bare Repository
<a class=header-anchor href=#bare-repository></a></h2><p>åœ¨ git init å’Œ git clone çš„æ—¶å€™éƒ½èƒ½æŒ‡å®š <code>--bare</code> é€‰é¡¹è¡¨ç¤ºè£¸ä»“åº“ã€‚</p><blockquote><p>Git will automatically add group write permissions to a repository properly if you run the git init command with the &ndash;shared option.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>ssh user@git.example.com
</span></span><span style=display:flex><span><span style=color:#b58900>cd</span> /srv/git/my_project.git
</span></span><span style=display:flex><span>git init --bare --shared
</span></span></code></pre></div><p>åœ¨ä¹¦é‡Œçš„ä¾‹å­ä¸­ï¼Œ/srv/git/my_project.git æœ¬æ¥å°±æ˜¯ä¸€ä¸ªè£¸ä»“åº“ï¼Œæ‰€ä»¥ç¬¬ä¸‰å¥çš„å«ä¹‰æ˜¯å°†è£¸ä»“åº“åˆå§‹åŒ–æˆå…±äº«ä»“åº“ã€‚ä¹Ÿå°±æ˜¯è®©ä»“åº“ç›®å½•çš„å½’å±ç»„éƒ½æœ‰å†™æƒé™ï¼Œå¦åˆ™åªæœ‰ä»“åº“ç›®å½•çš„å½’å±ç”¨æˆ·æœ‰å†™æƒé™ã€‚ï¼ˆåœ¨ä¸ªäººç”µè„‘ä¸Šï¼Œå½’å±ç»„å’Œå½’å±ç”¨æˆ·å¯èƒ½æ˜¯é‡åçš„ã€‚ï¼‰</p><p>è£¸ä»“åº“æ˜¯ç›´æ¥å°†æ­£å¸¸ä»“åº“ä¸­çš„ .git é‡Œçš„å†…å®¹å†™åˆ°ç»™å®šçš„è·¯å¾„é‡Œçš„ï¼Œæ²¡æœ‰ working treeã€‚</p><h2 id=ssh-å’Œ-git-shell>ssh å’Œ git-shell
<a class=header-anchor href=#ssh-%e5%92%8c-git-shell></a></h2><p>å¦‚æœå®‰è£…äº† git-shellï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º git çš„ç”¨æˆ·ï¼ˆåªæ˜¯å»ºè®®ï¼Œgit ä¸æ˜¯ç‰¹æ®Šçš„åå­—ï¼‰ç„¶åæ”¹å˜å…¶ç™»é™† shellï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>sudo chsh git -s <span style=color:#719e07>$(</span>which git-shell<span style=color:#719e07>)</span>
</span></span></code></pre></div><p>ç”¨æˆ·ç›´æ¥ç™»é™†é€šè¿‡ ssh åè®® serve æœ‰ä»“åº“çš„æœåŠ¡å™¨æ—¶ä½¿ç”¨ git-shell çš„å¥½å¤„æ˜¯ç®¡ç†è€…å¯ä»¥ç»™ git-shell åŠ ä¸€äº›é™åˆ¶è§„åˆ™ï¼Œä»è€Œé™åˆ¶ç”¨æˆ·å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤ã€‚ï¼ˆç°åœ¨ä¸ä¼šæœ‰äººç”¨è¿™ä¸ªå§ï¼Ÿï¼‰</p><h2 id=å…¶ä»–æ­å»ºæ–¹å¼>å…¶ä»–æ­å»ºæ–¹å¼
<a class=header-anchor href=#%e5%85%b6%e4%bb%96%e6%90%ad%e5%bb%ba%e6%96%b9%e5%bc%8f></a></h2><p>Git daemon/http/GitWeb/Gitlab ç­‰ï¼Œç•¥ã€‚</p><p>ä¹¦ä¸­è®²çš„ gitlab ä¸æ˜¯æ­å»º gitlab å®¹å™¨ï¼Œè€Œæ˜¯å°†é¡¹ç›®ä¸Šä¼ åˆ° gitlab ä¸Šï¼Œè®²çš„æ¯”è¾ƒæµ…ä¸ç”¨çœ‹ã€‚</p><h1 id=distributed-git>Distributed Git
<a class=header-anchor href=#distributed-git></a></h1><h2 id=workflow>Workflow
<a class=header-anchor href=#workflow></a></h2><p>è¿™é‡Œè®²äº†ä¸¤ç§ï¼š</p><p><img src=/assets/7aa01e45eb251c0bff343cc4b1c6c0bd.webp></p><p><img src=/assets/95cb17c66224099f960a03b94600674a.webp>ï¼ˆä»æ…ˆçš„ç‹¬è£è€…ï¼‰</p><h2 id=æ£€æŸ¥æ”¹åŠ¨æ˜¯å¦æœ‰æ ¼å¼é—®é¢˜>æ£€æŸ¥æ”¹åŠ¨æ˜¯å¦æœ‰æ ¼å¼é—®é¢˜
<a class=header-anchor href=#%e6%a3%80%e6%9f%a5%e6%94%b9%e5%8a%a8%e6%98%af%e5%90%a6%e6%9c%89%e6%a0%bc%e5%bc%8f%e9%97%ae%e9%a2%98></a></h2><p><code>git diff --check</code> èƒ½å¤Ÿæ£€æŸ¥æ­¤æ¬¡æ”¹åŠ¨ä¸­ï¼š</p><ol><li>ç©ºç™½å­—ç¬¦ç›¸å…³çš„æ ¼å¼é—®é¢˜ï¼šæ–‡ä»¶æ¯ä¸€è¡Œçš„æœ«å°¾æ˜¯å¦æœ‰å¤šä½™çš„ç©ºç™½å­—ç¬¦ã€æ–‡ä»¶çš„æœ«å°¾æ˜¯å¦æœ‰ä¸¤ä¸ªç©ºè¡Œï¼ˆåªæœ‰ä¸€ä¸ªç©ºè¡Œæ˜¯å¯ä»¥çš„ï¼‰ç­‰ã€‚</li><li>æ˜¯å¦æœ‰ conflict markersï¼ˆåˆå¹¶æˆ– rebase è¿˜æ²¡æœ‰å¤„ç†å®Œæˆï¼‰ã€‚</li></ol><p><strong>åœ¨æäº¤å‰å¯ä»¥è·‘ä¸€ä¸‹ git diff &ndash;cached &ndash;check</strong>ã€‚</p><h2 id=5072-è§„åˆ™>50/72 è§„åˆ™
<a class=header-anchor href=#5072-%e8%a7%84%e5%88%99></a></h2><p>git commit ä¿¡æ¯ä¸­æ ‡é¢˜å»ºè®®ä¸è¦è¶…è¿‡ 50 ä¸ªå­—ç¬¦ï¼Œæ­£æ–‡ä¿¡æ¯æ¯è¡Œä¸è¦è¶…è¿‡ 72 å­—ç¬¦ã€‚</p><h2 id=workflow-private-small-team>Workflow: private small team
<a class=header-anchor href=#workflow-private-small-team></a></h2><p><img src=/assets/4b20ee0963f5ed0eac88a3bd38609e41.webp></p><p>å‡è®¾æƒ³è¦çœ‹çœ‹ origin/master æ¯”æœ¬åœ°çš„ issue54 å¤šäº†å“ªäº›ä¿®æ”¹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git log --no-merges issue54..origin/master
</span></span><span style=display:flex><span>commit 738ee872852dfaa9d6634e0dea7a324040193016
</span></span><span style=display:flex><span>Author: John Smith &lt;jsmith@example.com&gt;
</span></span><span style=display:flex><span>Date: Fri May <span style=color:#2aa198>29</span> 16:01:27 <span style=color:#2aa198>2009</span> -0700
</span></span><span style=display:flex><span>Remove invalid default value
</span></span></code></pre></div><p>å…¶ä¸­ <code>--no-merges</code> é€‰é¡¹è¡¨ç¤ºä¸æ˜¾ç¤º merge ç»“ç‚¹ï¼ˆä¹Ÿå°±æ˜¯ parents æ•°é‡è¶…è¿‡ 1 ä¸ªçš„ç»“ç‚¹ï¼‰ï¼Œåœ¨è¿™é‡Œæ˜¯ origin/master æœ¬èº«ã€‚åªæ˜¯ç”±äºç”¨æˆ·åœ¨è¿è¡Œå…¶ä»–å‘½ä»¤ä¹‹å‰çœ‹ä¸åˆ°è¯»è€…åœ¨ä¹¦ä¸­ç›¸åº”ä½ç½®èƒ½çœ‹åˆ°çš„å›¾ï¼Œæ‰€ä»¥ä¸çŸ¥é“è¿œç¨‹åˆ°åº•æœ‰æ²¡æœ‰ merge ç»“ç‚¹ï¼ˆæ¯•ç«Ÿå¦‚æœçŸ¥é“åˆ™å¯ä»¥æ ¹æ®å›¾æ‰‹åŠ¨æŠŠè¿™ä¸ª commit åˆ’å…¥èŒƒå›´ä¹‹å¤–ï¼‰ã€‚</p><blockquote><p>The <strong>issue54..origin/master</strong> syntax is a log filter that asks Git to display only those commits that are <strong>on the latter branch (in this case origin/master) and that are not on the first branch</strong>.</p></blockquote><h2 id=workflow-private-managed-team>Workflow: private managed team
<a class=header-anchor href=#workflow-private-managed-team></a></h2><p>é™¤éè¦åˆ é™¤å¼€å‘åˆ†æ”¯ï¼Œæœ€å¥½ä¸è¦åœ¨åˆå¹¶çš„æ—¶å€™ squashã€‚å› ä¸º squash åˆå¹¶ååªæœ‰ä¸€ä¸ª parentï¼Œå¼€å‘è€…ä¹‹åçš„æ”¹åŠ¨åˆä¼šéœ€è¦ rebaseï¼</p><p><code>git merge --no-commit</code> æ˜¯æŒ‡ä¸è¦åˆ›å»ºæè¿°æœ¬æ¬¡åˆå¹¶çš„ merge commit ç»“ç‚¹ï¼Œä½†æ˜¯ä»ç„¶å¯èƒ½ fast-forwardã€‚<code>git merge --no-commit --no-ff</code> è¿˜ä¼šç¦ç”¨ fast-forwardã€‚è¿™ä¸¤ä¸ªé€‰é¡¹éƒ½æ‰“å¼€å°±èƒ½è¾¾åˆ°æ£€æŸ¥åˆå¹¶ç»“æœï¼Œä½†æ˜¯æš‚ä¸åˆå¹¶çš„æ•ˆæœã€‚ï¼ˆæ¯”å¦‚æƒ³è¦æµ‹è¯•æ˜¯å¦èƒ½å¤ŸæˆåŠŸåˆå¹¶ï¼Œæˆ–è€…æƒ³åœ¨åˆå¹¶ä¹‹å‰æ£€æŸ¥ä¸€ä¸‹åˆå¹¶ç»“æœå† commitã€‚ï¼‰</p><h2 id=ä½¿ç”¨é‚®ä»¶å·¥ä½œdiff-å’Œ-patch>ä½¿ç”¨é‚®ä»¶å·¥ä½œï¼šdiff å’Œ patch
<a class=header-anchor href=#%e4%bd%bf%e7%94%a8%e9%82%ae%e4%bb%b6%e5%b7%a5%e4%bd%9cdiff-%e5%92%8c-patch></a></h2><p><code>diff</code> å’Œ <code>patch</code> ä¸¤ä¸ªå‘½ä»¤æœ¬èº«å°±åœ¨ Linux ä¸­å­˜åœ¨ï¼ˆå‰è€…ç”Ÿæˆ patchï¼Œåè€…åº”ç”¨ patchï¼‰ã€‚ä½†å¦‚æœå¯èƒ½ï¼Œä½¿ç”¨ <code>git format-patch</code> å’Œ <code>git am</code>ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªå‘½ä»¤ã€‚</p><p><code>git format-patch</code> å¯ä»¥ç”Ÿæˆ patchesã€‚</p><blockquote><p>ä¸è¦ç”¨ <code>git diff master</code> æ¥ç”Ÿæˆ patchï¼Œå› ä¸º <code>git diff master</code> åªæ˜¯ç®€å•æ¯”è¾ƒæ–‡ä»¶çš„å˜åŒ–æƒ…å†µï¼Œå¦‚æœä½ çš„ master åˆ†æ”¯å¹¶ä¸æ˜¯ topic åˆ†æ”¯çš„ parentï¼ˆåœ¨ branch ä¹‹åå·²ç»å‘å‰ç§»åŠ¨äº†ï¼‰ï¼Œé‚£ä¹ˆ diff ä¸­ä¼šå‡ºç°æœ‰åˆ æœ‰å¢çš„å˜åŒ–ï¼è¿™ä¸ªæ—¶å€™åº”è¯¥ç”¨ commit range çš„ä¸¤ç‚¹è¡¨ç¤ºæ³•ï¼Œå¦åˆ™ patch ä¹‹å master çš„æ–°æ”¹åŠ¨ä¼šä¸¢å¤±ã€‚</p></blockquote><p><code>git apply</code> å¯ä»¥åº”ç”¨ä¸€èˆ¬çš„ diffï¼Œä½†æ˜¯å’Œ patch å‘½ä»¤ç›¸æ¯”å…·æœ‰åŸå­æ€§ï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚<code>git apply --check</code> å¯ä»¥ç”¨æ¥æ£€æŸ¥æœ¬æ¬¡ apply æ˜¯å¦èƒ½å¤ŸæˆåŠŸï¼Œä½†æ˜¯ä¸ä¼šçœŸçš„ applyã€‚</p><p><code>git am</code> æ˜¯å¯¹ <code>git apply</code> çš„åŒ…è£…ï¼Œèƒ½å¤Ÿå¯¹ mbox æ ¼å¼çš„æ–‡ä»¶å¤„ç†ã€‚mbox æ˜¯ä¸€ç³»åˆ— diff æ–‡ä»¶æ‹¼æ¥åˆ°ä¸€èµ·ä½œä¸ºé‚®ä»¶æ­£æ–‡ä¼ è¾“çš„ä¸€ç§æ ¼å¼ã€‚</p><h2 id=ä¸¤ç‚¹å¼å’Œä¸‰ç‚¹å¼çš„-commit-range>ä¸¤ç‚¹å¼å’Œä¸‰ç‚¹å¼çš„ commit range
<a class=header-anchor href=#%e4%b8%a4%e7%82%b9%e5%bc%8f%e5%92%8c%e4%b8%89%e7%82%b9%e5%bc%8f%e7%9a%84-commit-range></a></h2><p>æ³¨æ„ï¼<strong>ä¸é€‚ç”¨äº git diff</strong>ï¼æ›´å¤šè§
<a href=/pro-git-the-book/%E5%88%9D%E8%AF%BB-Pro-Git/#commit-%e8%a1%a8%e7%a4%ba%e6%b3%95 title="Commit è¡¨ç¤ºæ³•">Commit è¡¨ç¤ºæ³•</a>ã€‚</p><p><img src=/assets/1b8a90f1b0ad703c7bae42b5b3621b56.webp> ä¸‰ç‚¹å¼ï¼šå‡ºç°åœ¨ A ä½†ä¸å‡ºç°äº Bï¼Œæˆ–è€…ç›¸åã€‚</p><p><img src=/assets/43f771beda5ee65164d1626f8e982450.webp> ä¸¤ç‚¹å¼ï¼šå‡ºç°åœ¨ B ä¸­ï¼Œä½†ä¸å‡ºç°åœ¨ A ä¸­ã€‚</p><p><code>git log contrib --not master</code> å’Œ <code>git log master..contrib</code> æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</p><h2 id=åœ¨-git-ä¸­åŒ…å«å¯†é’¥>åœ¨ git ä¸­åŒ…å«å¯†é’¥
<a class=header-anchor href=#%e5%9c%a8-git-%e4%b8%ad%e5%8c%85%e5%90%ab%e5%af%86%e9%92%a5></a></h2><p>å¯èƒ½ç°åœ¨ä¸ä¼šç”¨åˆ°äº†ã€‚è¿™ç§å¯¼å…¥å¯†é’¥çš„æ–¹å¼åªä¼šåœ¨ git ä»“åº“çš„ objects ä¸­åŒ…å«ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸ä¼šè®©æ–‡ä»¶å‡ºç°åœ¨å·¥ä½œåŒºã€‚</p><p>å¯¼å‡ºå¯†é’¥ï¼Œå¹¶å°†å¯†é’¥å†™å…¥åˆ°ä»“åº“çš„ objects ä¸­ã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ gpg -a --export F721C45A | git hash-object -w --stdin
</span></span><span style=display:flex><span>659ef797d181633c87ec71ac3f9ba29fe5775b92
</span></span></code></pre></div><p>ç„¶åç»™ objects ä¸€ä¸ª tagï¼Œé˜²æ­¢ gc çš„æ—¶å€™ä¸¢å¤±ï¼ˆåŒæ—¶ä¹Ÿèƒ½æ–¹ä¾¿æŸ¥æ‰¾ï¼‰ã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git tag -a maintainer-pgp-pub 659ef797d181633c87ec71ac3f9ba29fe5775b92
</span></span></code></pre></div><p>ç»™å®Œ tag ä¹‹ååç»­åˆ«äººå¯ä»¥é€šè¿‡ tag æ‰¾åˆ° hashï¼Œç„¶åæ‰¾åˆ°æ–‡ä»¶å¹¶å¯¼å…¥ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git show maintainer-pgp-pub | gpg --import
</span></span></code></pre></div><p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ç°åœ¨åœ¨ darknet çš„ä»“åº“ä¸­ï¼ˆæ‰‹å¤´æœ‰ä¸ªä»“åº“ï¼Œé¡ºä¾¿æ‰“å¼€äº†ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git ls-tree master
</span></span><span style=display:flex><span><span style=color:#2aa198>100644</span> blob bea19ff44fcb77ccca5448e730bd154327088a30    .gitignore
</span></span><span style=display:flex><span><span style=color:#2aa198>100644</span> blob a50f7d700ba02bfacd50f59b315311cf4d0bbda2    LICENSE
</span></span><span style=display:flex><span><span style=color:#2aa198>100644</span> blob 8b1a9d8189b3b9f4479221d52882ce36fdc73a62    LICENSE.fuck
</span></span><span style=display:flex><span><span style=color:#2aa198>100644</span> blob c54113271e15057c4def6676693eb96fd6362b28    LICENSE.gen
</span></span><span style=display:flex><span><span style=color:#2aa198>100644</span> blob 9cecc1d4669ee8af2ca727a5d8cde10cd8b2d7cc    LICENSE.gpl
</span></span><span style=display:flex><span><span style=color:#2aa198>100644</span> blob 6728bd28d319c68ae04944fb034118dcc4c9aa09    LICENSE.meta
</span></span><span style=display:flex><span><span style=color:#2aa198>100644</span> blob 5bd806ce16ea5053c8631793787362439375026e    LICENSE.mit
</span></span><span style=display:flex><span><span style=color:#2aa198>100644</span> blob 5b8709acc43e7b76ed69758a52a9eaffaba775e6    LICENSE.v1
</span></span><span style=display:flex><span><span style=color:#2aa198>100644</span> blob 63e15e657fa3e47455598beaf8f27df4386f5a9e    Makefile
</span></span><span style=display:flex><span><span style=color:#2aa198>100644</span> blob fb58c2640038a963cd573d121e4fab59399f67dc    README.md
</span></span><span style=display:flex><span><span style=color:#2aa198>040000</span> tree b789d4e25fb76862394c3805d2a529d49c353ae9    cfg
</span></span><span style=display:flex><span><span style=color:#2aa198>040000</span> tree 7751b6063e5b86ef67fd155b2d4496c5c85d4516    data
</span></span><span style=display:flex><span><span style=color:#2aa198>040000</span> tree da080efd69a73cdfd765b1785e0df5fcee769a52    examples
</span></span><span style=display:flex><span><span style=color:#2aa198>040000</span> tree 87a27ca1a74b281df2301d41b7a5b359c5322335    include
</span></span><span style=display:flex><span><span style=color:#2aa198>040000</span> tree 5cf5ca862a8e43ac9276a84c7187680d32754aa0    python
</span></span><span style=display:flex><span><span style=color:#2aa198>040000</span> tree f5c65d4da6faf9f382a28a7f766d1c2247453150    scripts
</span></span><span style=display:flex><span><span style=color:#2aa198>040000</span> tree e4da33bf1850bf3c6eab30232e299acddf672b62    src
</span></span></code></pre></div><p>ä½¿ç”¨ <code>git show {hash}</code>ï¼Œå¦‚æœ hash å¯¹åº”æŸä¸ª blobï¼Œå°†ç›´æ¥å±•ç¤ºå¿«ç…§çš„å†…å®¹ã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git show a50f7d700ba02bfacd50f59b315311cf4d0bbda2
</span></span><span style=display:flex><span>                                  YOLO LICENSE
</span></span><span style=display:flex><span>                             Version 2, July <span style=color:#2aa198>29</span> <span style=color:#2aa198>2016</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>THIS SOFTWARE LICENSE IS PROVIDED <span style=color:#2aa198>&#34;ALL CAPS&#34;</span> SO THAT YOU KNOW IT IS SUPER
</span></span><span style=display:flex><span>SERIOUS AND YOU DON<span style=color:#2aa198>&#39;T MESS AROUND WITH COPYRIGHT LAW BECAUSE YOU WILL GET IN
</span></span></span><span style=display:flex><span><span style=color:#2aa198>TROUBLE HERE ARE SOME OTHER BUZZWORDS COMMONLY IN THESE THINGS WARRANTIES
</span></span></span><span style=display:flex><span><span style=color:#2aa198>LIABILITY CONTRACT TORT LIABLE CLAIMS RESTRICTION MERCHANTABILITY. NOW HERE&#39;</span>S
</span></span><span style=display:flex><span>THE REAL LICENSE:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>0. Darknet is public domain.
</span></span><span style=display:flex><span>1. Do whatever you want with it.
</span></span><span style=display:flex><span>2. Stop emailing me about it!
</span></span></code></pre></div><p>å¦‚æœ hash å¯¹åº”ä¸€ä¸ª treeï¼Œä¼šåˆ—ä¸¾æ–‡ä»¶å¤¹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git show 7751b6063e5b86ef67fd155b2d4496c5c85d4516
</span></span><span style=display:flex><span>tree 7751b6063e5b86ef67fd155b2d4496c5c85d4516
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>9k.labels
</span></span><span style=display:flex><span>9k.names
</span></span><span style=display:flex><span>9k.tree
</span></span><span style=display:flex><span>coco.names
</span></span><span style=display:flex><span>coco9k.map
</span></span><span style=display:flex><span>dog.jpg
</span></span><span style=display:flex><span>eagle.jpg
</span></span><span style=display:flex><span>giraffe.jpg
</span></span><span style=display:flex><span>goal.txt
</span></span><span style=display:flex><span>horses.jpg
</span></span><span style=display:flex><span>imagenet.labels.list
</span></span><span style=display:flex><span>imagenet.shortnames.list
</span></span><span style=display:flex><span>inet9k.map
</span></span><span style=display:flex><span>kite.jpg
</span></span><span style=display:flex><span>labels/
</span></span><span style=display:flex><span>openimages.names
</span></span><span style=display:flex><span>person.jpg
</span></span><span style=display:flex><span>scream.jpg
</span></span><span style=display:flex><span>voc.names
</span></span></code></pre></div><p>å¦‚æœ hash å¯¹åº”ä¸€ä¸ª commitï¼Œå¯¹æ˜¾ç¤º commit çš„æ—¥å¿—ã€‚</p><h2 id=ä¸º-commit-åˆ›å»ºå¯è¯»çš„åç§°>ä¸º commit åˆ›å»ºå¯è¯»çš„åç§°
<a class=header-anchor href=#%e4%b8%ba-commit-%e5%88%9b%e5%bb%ba%e5%8f%af%e8%af%bb%e7%9a%84%e5%90%8d%e7%a7%b0></a></h2><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git describe master
</span></span><span style=display:flex><span>v1.6.2-rc1-20-g8c5b85c
</span></span><span style=display:flex><span><span style=color:#586e75>########## ^^  ^^^^^^^</span>
</span></span><span style=display:flex><span><span style=color:#586e75>#      /    |     \</span>
</span></span><span style=display:flex><span><span style=color:#586e75># last tag  |   partial sha1</span>
</span></span><span style=display:flex><span><span style=color:#586e75>#           |</span>
</span></span><span style=display:flex><span><span style=color:#586e75>#   commits since the tag</span>
</span></span></code></pre></div><blockquote><p>In response, Git generates a string consisting of the name of the most recent tag earlier than that commit, followed by the number of commits since that tag, followed finally by a partial SHA-1 value of the commit being described (prefixed with the letter &ldquo;g&rdquo; meaning Git).</p></blockquote><p>ä½†æ˜¯å¿…é¡»å¾—è®© git å…ˆæ‰¾åˆ°å¯¹åº”åˆ†æ”¯ä¸Šæœ€è¿‘çš„ tagï¼Œæ‰èƒ½ç”¨ describeã€‚ä¹Ÿå°±æ˜¯è¯´æ—  tag çš„æ—¶å€™æ˜¯ä¸èƒ½ describe çš„ï¼Œä¼šæŠ¥é”™ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œgit describe æè¿°çš„ tags çš„åªèƒ½æ˜¯ annotated tagsã€‚å¯ä»¥åŠ  &ndash;tags æ¥æè¿°æ— æ³¨é‡Šçš„ tagsã€‚</p><h2 id=åˆ›å»º-archive>åˆ›å»º archive
<a class=header-anchor href=#%e5%88%9b%e5%bb%ba-archive></a></h2><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git archive master --prefix<span style=color:#719e07>=</span><span style=color:#2aa198>&#39;project/&#39;</span> --format<span style=color:#719e07>=</span>zip &gt; <span style=color:#586e75>`</span>git describe master<span style=color:#586e75>`</span>.zip
</span></span></code></pre></div><p>å¦‚æœæ²¡æœ‰ <code>--format</code> é€‰é¡¹ï¼Œåˆ™ä¼šé‡‡ç”¨ tar.gzã€‚</p><h2 id=shortlog>Shortlog
<a class=header-anchor href=#shortlog></a></h2><p><code>git shortlog</code> èƒ½å¤Ÿå±•ç¤ºé€‰å®šèŒƒå›´å†…çš„æ‰€æœ‰æ”¹åŠ¨ï¼Œè€Œä¸”æ˜¯æŒ‰<strong>ä½œè€…</strong>åˆ†ç»„çš„ï¼Œæ¦‚è§ˆèµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ã€‚ä¸»è¦ç”¨é€”æ˜¯é˜…è¯»ä¸€æ®µæ—¶é—´å†…ä¸åŒäººå‘˜å¯¹ä»“åº“åšå‡ºçš„è´¡çŒ®ã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git shortlog --no-merges master --not v1.0.1
</span></span><span style=display:flex><span>Chris Wanstrath <span style=color:#719e07>(</span>6<span style=color:#719e07>)</span>:
</span></span><span style=display:flex><span>    Add support <span style=color:#719e07>for</span> annotated tags to Grit::Tag
</span></span><span style=display:flex><span>    Add packed-refs annotated tag support.
</span></span><span style=display:flex><span>    Add Grit::Commit#to_patch
</span></span><span style=display:flex><span>    Update version and History.txt
</span></span><span style=display:flex><span>    Remove stray <span style=color:#586e75>`</span>puts<span style=color:#586e75>`</span>
</span></span><span style=display:flex><span>    Make ls_tree ignore nils
</span></span><span style=display:flex><span>Tom Preston-Werner <span style=color:#719e07>(</span>4<span style=color:#719e07>)</span>:
</span></span><span style=display:flex><span>    fix dates in <span style=color:#b58900>history</span>
</span></span><span style=display:flex><span>    dynamic version method
</span></span><span style=display:flex><span>    Version bump to 1.0.2
</span></span><span style=display:flex><span>    Regenerated gemspec <span style=color:#719e07>for</span> version 1.0.2
</span></span></code></pre></div><h1 id=github>Github
<a class=header-anchor href=#github></a></h1><p>è¿™ä¸€ç« åŸºæœ¬å¯ä»¥è·³è¿‡ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›æ–°çš„çŸ¥è¯†ç‚¹ã€‚</p><p><code>git diff --word-diff</code> å¯ä»¥ç”¨æ¥æŒ‰ç…§è¯æ˜¾ç¤ºå·®å¼‚ã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-txt data-lang=txt><span style=display:flex><span>$ git diff --word-diff
</span></span><span style=display:flex><span>diff --git a/blink.ino b/blink.ino
</span></span><span style=display:flex><span>index 15b9911..a6cc5a5 100644
</span></span><span style=display:flex><span>--- a/blink.ino
</span></span><span style=display:flex><span>+++ b/blink.ino
</span></span><span style=display:flex><span>@@ -18,7 +18,7 @@ void setup() {
</span></span><span style=display:flex><span>// the loop routine runs over and over again forever:
</span></span><span style=display:flex><span>void loop() {
</span></span><span style=display:flex><span>digitalWrite(led, HIGH); // turn the LED on (HIGH is the voltage level)
</span></span><span style=display:flex><span>[-delay(1000);-]{+delay(3000);+} // wait for a second
</span></span><span style=display:flex><span>digitalWrite(led, LOW); // turn the LED off by making the voltage LOW
</span></span><span style=display:flex><span>[-delay(1000);-]{+delay(3000);+} // wait for a second
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è¿™æ˜¯ Gitlab-flavored markdown æ”¯æŒçš„ã€‚Github å¯èƒ½ä¹Ÿæ”¯æŒï¼Ÿ</p><blockquote><p>The other interesting URLs are the .diff and .patch URLs, which as you may guess, provide unified
diff and patch versions of the Pull Request. You could technically merge in the Pull Request work
with something like this:</p></blockquote><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl https://github.com/tonychacon/fade/pull/1.patch | git am
</span></span></code></pre></div><p>è¿™æ ·èƒ½å¤Ÿç›´æ¥ä» gitlab çš„ url ä¸Šé¢ä¸‹è½½æ–°çš„ä¸œè¥¿ patch å¹¶åº”ç”¨ã€‚gitlab ä¹Ÿæ”¯æŒã€‚</p><p>åœ¨ merge-request æˆ–è€… pull é¡µé¢åŠ ä¸Šåç¼€ï¼š</p><ul><li><code>.diff</code> åç¼€ï¼šç›¸å½“äºè¿è¡Œ git diffï¼Œæ”¹åŠ¨æŒ‰ç…§æ–‡ä»¶åˆ†ç±»ã€‚</li><li><code>.patch</code> åç¼€ï¼šç›¸å½“äºè¿è¡Œ git format-patchï¼Œæ”¹åŠ¨å…ˆæŒ‰ç…§ commit åˆ†ç±»å†æŒ‰ç…§æ–‡ä»¶åˆ†ç±»ã€‚</li></ul><p>å¦ä¸€æ–¹é¢ï¼Œåœ¨åŸæ¥ä½¿ç”¨ä¸»æœºçš„åœ°æ–¹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ urlï¼Œä¸»è¦æ˜¯ç”¨äºä¸´æ—¶ä¸‹è½½ï¼ˆä¸æƒ³è¦ä¿å­˜ä¸»æœºå†åˆ é™¤çš„æƒ…å†µï¼‰ã€‚</p><h1 id=git-tools>Git Tools
<a class=header-anchor href=#git-tools></a></h1><h2 id=git-reflog>git reflog
<a class=header-anchor href=#git-reflog></a></h2><p>git reflog èƒ½å¤Ÿæ˜¾ç¤ºè¿‡å»ä¸€æ®µæ—¶é—´å¯¹ HEAD çš„æ“ä½œä¿¡æ¯ï¼Œè®°å½•äº†å½“å‰çš„åˆ†æ”¯æ˜¯æ€ä¹ˆæ”¹åŠ¨çš„ã€‚æ¯”å¦‚ä»€ä¹ˆæ—¶å€™å‘ç”Ÿäº† reset æˆ–è€… checkoutã€‚<strong>reflog ä¿¡æ¯æ˜¯å®Œå…¨æœ¬åœ°çš„</strong>ã€‚</p><blockquote><p>Think of the reflog as Git&rsquo;s version of shell history.</p></blockquote><p><img src=/assets/5ebfa85039debd727416a3c7fb920a56.webp></p><p>è¿™äº›ä¿¡æ¯å¯¹äºæœ€ç»ˆçš„ä»£ç æ²¡ç”¨ï¼Œä½†æ˜¯å¯¹äºå·¥ä½œå¯èƒ½å¾ˆæœ‰å¸®åŠ©ã€‚æ¯”å¦‚å…ˆæŸ¥åˆ° <code>git reflog</code> ä¿¡æ¯ä¹‹åå¯ä»¥è¿™æ ·æŒ‡ä»£ä¸€ä¸ª commitï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git show HEAD@<span style=color:#719e07>{</span>5<span style=color:#719e07>}</span>
</span></span><span style=display:flex><span><span style=color:#586e75># or</span>
</span></span><span style=display:flex><span>git show master@<span style=color:#719e07>{</span>yesterday<span style=color:#719e07>}</span>
</span></span><span style=display:flex><span><span style=color:#586e75># or</span>
</span></span><span style=display:flex><span>git show HEAD@<span style=color:#719e07>{</span>2.months.ago<span style=color:#719e07>}</span>
</span></span></code></pre></div><p>ä½¿ç”¨ <code>git log -g</code> å¯ä»¥åœ¨ log ä¸­æ˜¾ç¤º reflog ä¿¡æ¯ã€‚</p><h3 id=escaping-braces-in-powershell>Escaping braces in PowerShell
<a class=header-anchor href=#escaping-braces-in-powershell></a></h3><p>When using PowerShell, braces like { and } are special characters and must be escaped. You can escape them with a backtick <kbd>`</kbd> or put the commit reference in quotes:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git show HEAD@<span style=color:#719e07>{</span>0<span style=color:#719e07>}</span>   <span style=color:#586e75># will NOT work</span>
</span></span><span style=display:flex><span>$ git show HEAD@<span style=color:#586e75>`</span><span style=color:#719e07>{</span>0<span style=color:#586e75>`</span><span style=color:#719e07>}</span> <span style=color:#586e75># OK</span>
</span></span><span style=display:flex><span>$ git show <span style=color:#2aa198>&#34;HEAD@{0}&#34;</span> <span style=color:#586e75># OK</span>
</span></span></code></pre></div><p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä¸å–œæ¬¢ PowerShellã€‚</p><h2 id=commit>{commit}^
<a class=header-anchor href=#commit></a></h2><p>^ è¡¨ç¤º parentã€‚æ³¨æ„ Windows çš„ cmd ä¸Šè¦ç”¨ ^^ï¼Œå› ä¸º cmd å¯¹ ^ æœ‰è½¬ä¹‰ã€‚</p><p>è§
<a href=/posts/systems/Windows/Windows-cmd-%E8%BD%AC%E4%B9%89/ title="Windows cmd è½¬ä¹‰">Windows cmd è½¬ä¹‰</a>ã€‚</p><h2 id=commit-è¡¨ç¤ºæ³•>Commit è¡¨ç¤ºæ³•
<a class=header-anchor href=#commit-%e8%a1%a8%e7%a4%ba%e6%b3%95></a></h2><blockquote><p>You can get the same results as in the previous example by typing <code>git log origin/master..</code> â€” Git substitutes HEAD if one side is missing.</p></blockquote><p>å¦‚æœ range çš„ä¸€ç«¯è¢«çœç•¥ï¼Œåˆ™ git ä¼šç”¨ HEAD ä»£æ›¿ã€‚</p><p>ä¹Ÿå¯ä»¥å¤šç‚¹è¡¨ç¤ºã€‚ä»¥ä¸‹ä¸‰ç§å†™æ³•å«ä¹‰ç›¸åŒï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git log refA..refB
</span></span><span style=display:flex><span>$ git log ^refA refB
</span></span><span style=display:flex><span>$ git log refB --not refA
</span></span></code></pre></div><p>å…¶ä¸­ <code>^refA</code> å°±è¡¨ç¤º <code>--not refA</code>ã€‚è¿™ç§å†™æ³•æ¯”èµ· ä¸¤ç‚¹å’Œä¸‰ç‚¹è¡¨ç¤ºæ³• å¯ä»¥æ”¯æŒæ›´å¤šçš„åˆ†æ”¯ã€‚æ¯”å¦‚ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git log refA refB ^refC
</span></span><span style=display:flex><span>$ git log refA refB --not refC
</span></span></code></pre></div><p><strong>æ³¨æ„ï¼è¿™ä¸é€‚ç”¨äº git diffï¼git diff ä»…èƒ½æ¯”è¾ƒä¸¤ä¸ªæäº¤</strong>ï¼Œè€Œä¸”æœ‰å†å²æ€§çš„ã€ä¸æ»¡è¶³ commit è¡¨ç¤ºæ³•çš„å®ç°éœ€è¦å…¼å®¹ã€‚</p><ol><li>å¦‚æœåŒ…å« <code>--not</code> æˆ– <code>^</code>ï¼Œå…ˆè½¬æ¢æˆä¸¤ç‚¹è¡¨ç¤ºæ³•ï¼Œå†è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</li><li>å¦‚æœæ˜¯ä¸¤ç‚¹è¡¨ç¤ºæ³•ï¼Œå»æ‰ <code>..</code> ç›¸å½“äºç›´æ¥æ¯”è¾ƒä¸¤ä¸ªç«¯ç‚¹ï¼ˆendpointï¼‰ã€‚</li><li>å¦‚æœæ˜¯ä¸‰ç‚¹è¡¨ç¤ºæ³•ï¼Œåˆ™å…ˆæ‰¾åˆ°ä¸¤ä¸ªç«¯ç‚¹çš„ merge-baseï¼Œå†æ¯”è¾ƒ merge-base å’Œç¬¬äºŒä¸ªç«¯ç‚¹ã€‚</li></ol><blockquote><p><code>git diff [&lt;options>] &lt;commit>..&lt;commit> [--] [&lt;path>â€¦â€‹]</code>
This is synonymous to the earlier form (without theÂ <code>..</code>) for viewing the changes between two arbitrary <code>&lt;commit></code>. If <code>&lt;commit></code> on one side is omitted, it will have the same effect as using HEAD instead.</p><p><code>git diff [&lt;options>] &lt;commit>...&lt;commit> [--] [&lt;path>â€¦â€‹]</code>
This form is to view the changes on the branch containing and up to the second <code>&lt;commit></code>, starting at a common ancestor of both <code>&lt;commit></code>.Â <code>git diff A...B</code>Â is equivalent toÂ <code>git diff $(git merge-base A B) B</code>. You can omit any one of <code>&lt;commit></code>, which has the same effect as using HEAD instead.</p></blockquote><p><strong>å› ä¸ºå†å²é—ç•™é—®é¢˜ï¼Œçœ‹ä¸Šå» git diff çš„ä¸¤ç‚¹è¡¨ç¤ºæ³•å’Œä¸‰ç‚¹è¡¨ç¤ºæ³•å’Œå…¶ä»–å‘½ä»¤æ˜¯ç›¸åçš„ï¼</strong></p><p><code>git log</code> ä½¿ç”¨ä¸‰ç‚¹è¡¨ç¤ºæ³•ï¼ˆè¢«ç»™å®šçš„æŸä¸€ä¸ªåˆ†æ”¯åŒ…å«ï¼Œå´ä¸æ˜¯åŒæ—¶åŒ…å«çš„é‚£äº› commitsï¼‰çš„æ—¶å€™è¿˜å¯ä»¥åŠ ä¸Š <strong>&ndash;left-right</strong> å‚æ•°ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git log --left-right master...experiment
</span></span><span style=display:flex><span>&lt; F
</span></span><span style=display:flex><span>&lt; E
</span></span><span style=display:flex><span>&gt; D
</span></span><span style=display:flex><span>&gt; C
</span></span></code></pre></div><p>è¿™æ ·èƒ½çœ‹åˆ° commit æ˜¯æ¥è‡ªå·¦è¾¹è¿˜æ˜¯å³è¾¹ã€‚</p><h2 id=git-add--i>git add -i
<a class=header-anchor href=#git-add--i></a></h2><p><img src=/assets/4fdd0766f10c7df60530856e566bd4fe.webp>
ä¸€äº›å‘½ä»¤ï¼š</p><ul><li>revert å¯ä»¥æ’¤æ‰å¯¹ä¸€ä¸ªæ–‡ä»¶çš„æ›´æ–°ï¼Œç›¸å½“äº <code>git restore --staged -- {file}</code>ã€‚</li><li>update å¯ä»¥æ•´ä½“æ·»åŠ æ–‡ä»¶ã€‚</li><li>patch å¯ä»¥æ·»åŠ æ–‡ä»¶çš„ä¸€ä¸ªéƒ¨åˆ†ã€‚åœ¨ patch æ¨¡å¼ä¸­ä½¿ç”¨ e é€‰é¡¹å¯ä»¥ç¼–è¾‘ chunkï¼Œä½†åªæ˜¯ä¼šä¿®æ”¹è¦æš‚å­˜çš„å†…å®¹ï¼ˆindexï¼‰ï¼Œè¿™é‡Œç¼–è¾‘çš„å†…å®¹å¹¶ä¸ä¼šå½±å“å·¥ä½œåŒºã€‚ä» <code>git add -p</code> ä¹Ÿå¯ä»¥ç›´æ¥è¿›å…¥è¿™ä¸€æ­¥ã€‚</li></ul><p>å…¶ä»–è¯´æ˜ï¼š</p><ul><li><code>git reset</code>ã€<code>git stash save</code> å’Œ <code>git checkout</code> ä¹Ÿéƒ½èƒ½åŠ  <code>-p</code> é€‰é¡¹ï¼</li><li>git stash saveï¼ˆdeprecatedï¼‰ç°åœ¨è¢« git stash push æ›¿ä»£ã€‚</li><li>VS Code ä¹Ÿæœ‰æŒ‰ç…§é€‰åŒºæ·»åŠ å†…å®¹çš„æ–¹å¼ã€‚</li></ul><h2 id=git-stash>git stash
<a class=header-anchor href=#git-stash></a></h2><p>git stash list ä¹‹åé€‰æ‹©è¦åº”ç”¨çš„ stashï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git stash apply stash@<span style=color:#719e07>{</span>2<span style=color:#719e07>}</span>
</span></span></code></pre></div><p>è¿™ä¸ªæ ¼å¼æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Ÿè¿™æ˜¯ reflog çš„æ ¼å¼ï¼Œè¿™ä¹ŸåŒæ ·è¡¨æ˜ git stash çš„å†…å®¹æ˜¯å®Œå…¨æœ¬åœ°ï¼Œä¸ä¼šè¢«æäº¤åˆ°è¿œç¨‹ä»“åº“çš„ï¼git stash å†…å®¹å¦‚æœä¸¢å¤±å°†æ— æ³•æ¢å¤ã€‚</p><p>åœ¨ stash çš„æ—¶å€™å¿½ç•¥ index åŒºï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git stash --keep-index
</span></span><span style=display:flex><span>Saved working directory and index state WIP on master: 1b65b17 added the index file
</span></span><span style=display:flex><span>HEAD is now at 1b65b17 added the index file
</span></span></code></pre></div><p>Stash æœªè¿½è¸ªçš„å†…å®¹å¯ä»¥ç”¨ <code>--include-untracked</code> or <code>-u</code>ï¼Œä½†æ˜¯è¿™ä¸ä¼š stash å†™åœ¨ .gitignore ä¸­çš„å†…å®¹ã€‚ä½¿ç”¨ <code>--all</code> æˆ–è€… <code>-a</code> èƒ½å°† .gitignore ä¸­çš„å†…å®¹ä¹Ÿ stashã€‚</p><p><code>git stash --patch</code>ï¼šå°†éƒ¨åˆ†æ–‡ä»¶å†…å®¹åŠ å…¥ stashã€‚</p><p><code>git stash branch &lt;new branchname></code>ï¼šåˆ›å»º stashï¼Œ<code>checkout -b</code> åˆ°æ–°åˆ†æ”¯ï¼Œå† apply stashã€‚åœ¨å·¥ä½œåŒºäº§ç”Ÿäº†åˆ«çš„æ”¹åŠ¨å†…å®¹æ—¶æœ‰ç”¨ã€‚</p><h2 id=git-clean>git clean
<a class=header-anchor href=#git-clean></a></h2><p><code>git clean</code> ç”¨æ¥ç§»é™¤ untracked æ–‡ä»¶ã€‚ï¼ˆ<strong>ä½œä¸ºå¯¹æ¯”ï¼Œ<code>git reset</code> æ˜¯é‡ç½® tracked æ–‡ä»¶</strong>ã€‚ï¼‰</p><p>å¦‚æœä¸æ”¾å¿ƒï¼Œå¯ä»¥å…ˆ <code>--dry-run</code> æˆ–è€… <code>-n</code> ä¸€ä¸‹ã€‚</p><p>ä¸€äº›é€‰é¡¹ï¼š-f å¼ºåˆ¶åˆ é™¤ï¼Œ-ff åœ¨å¼ºåˆ¶åˆ é™¤ä¸å¯è¡Œçš„æ—¶å€™å¼ºè°ƒå¼ºåˆ¶åˆ é™¤ã€‚-i äº¤äº’å¼åˆ é™¤ï¼Œ-d åˆ é™¤æ–‡ä»¶å¤¹ï¼ˆå¦åˆ™ä¼šå¿½ç•¥æ–‡ä»¶å¤¹ï¼‰ï¼Œ-x å¿½ç•¥ .gitignore æ–‡ä»¶ã€‚</p><p><code>git clean</code> ç›¸å¯¹æ¥è¯´ä¸æ˜¯å¾ˆå®‰å…¨ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ git stash -a ä½œä¸ºæ›¿ä»£ã€‚</p><h2 id=gpg-ç­¾å>gpg ç­¾å
<a class=header-anchor href=#gpg-%e7%ad%be%e5%90%8d></a></h2><p>å¯ä»¥ç”¨ gpg ç­¾åä¸€ä¸ª tag æˆ–è€… commitï¼Œè¿™æ ·å…¶ä»–äººå°±èƒ½éªŒè¯æäº¤è€…çš„èº«ä»½ã€‚åœ¨ git é…ç½®æ–‡ä»¶ä¸­è®¾ç½® <code>commit.gpgsign</code> ä¸º true ä¼šé»˜è®¤å¯ç”¨ç­¾åã€‚</p><p><em>å…¶ä»–çš„åŒ…æ‹¬åˆ›å»ºå¯†é’¥ã€å¯¼å‡ºã€éªŒè¯ã€åœ¨ tag æˆ– commit çš„æ—¶å€™ç­¾åçš„å†…å®¹å°±æ­¤çœç•¥</em>ã€‚</p><h2 id=git-grep>git grep
<a class=header-anchor href=#git-grep></a></h2><p><code>git grep</code> åªä¼šæœ git çŸ¥é“çš„æ–‡ä»¶ï¼Œæ‰€ä»¥é€Ÿåº¦æ¯” grep æ›´å¿«ï¼ˆå‰ææ˜¯ä½ è¦æ‰¾çš„å†…å®¹å°±åœ¨ git ä¸­ï¼‰ï¼</p><p>é»˜è®¤æœç´¢èŒƒå›´æ˜¯æ•´ä¸ªå·¥ä½œåŒºã€‚</p><p><code>-n</code> æˆ–è€… <code>--line-number</code> å¯ä»¥è®©è¾“å‡ºç»“æœé™„åŠ è¡Œå·ï¼ˆé»˜è®¤çš„è¾“å‡ºåªæœ‰æ–‡ä»¶åå’Œå†…å®¹è¡Œï¼‰ã€‚</p><p><em>æ„Ÿè§‰å’Œå¯è§†åŒ–ç•Œé¢ç›¸æ¯”ä¸æ˜¯å¾ˆå¥½ç”¨ã€‚</em></p><p><code>git log -S</code> æœç´¢å­—ç¬¦ä¸²å˜åŒ–æƒ…å†µã€‚</p><p><strong><code>git log -L</code> å¯ä»¥æœç´¢è¡Œå†å²ã€‚-L argument å¯ä»¥æ˜¯ &lsquo;start,end:file&rsquo; or &lsquo;:funcname:file&rsquo;</strong>ã€‚æœç´¢ funcname å¯èƒ½æœç´¢ä¸åˆ°ï¼Œæ¯”å¦‚ python æ–‡ä»¶ä¸­ç±»çš„æˆå‘˜å‡½æ•°ã€‚ä¹Ÿå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼æŒ‡å®šå‡½æ•°çš„å¼€å§‹å’Œç»“æŸï¼Œæ¯”å¦‚ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git log -L <span style=color:#2aa198>&#39;/unsigned long git_deflate_bound/&#39;</span>,/^<span style=color:#719e07>}</span>/:zlib.c
</span></span></code></pre></div><p>è¿™æ ·å°±èƒ½æœåˆ°ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-txt data-lang=txt><span style=display:flex><span>@@ -81,0 +85,5 @@
</span></span><span style=display:flex><span>+unsigned long git_deflate_bound(z_streamp strm, unsigned long size)
</span></span><span style=display:flex><span>+{
</span></span><span style=display:flex><span>+ return deflateBound(strm, size);
</span></span><span style=display:flex><span>+}
</span></span><span style=display:flex><span>+
</span></span></code></pre></div><h2 id=git-commit---amend>git commit &ndash;amend
<a class=header-anchor href=#git-commit---amend></a></h2><p>å¦‚æœä¸éœ€è¦ä¸º <code>git commit --amend</code> æä¾›ä¿¡æ¯ï¼Œå¯ä»¥ç”¨ <code>git commit --amend --no-edit</code>ã€‚</p><h2 id=git-rebase--i>git rebase -i
<a class=header-anchor href=#git-rebase--i></a></h2><p>å¯ä»¥ squash commitsã€ä¿®æ”¹ commits çš„æäº¤ä¿¡æ¯ã€äº¤æ¢ commits çš„é¡ºåºã€å°†ä¸€ä¸ª commit åˆ†è£‚æˆå¤šä¸ªã€‚</p><h3 id=git-rebase--i-çš„-edit-é€‰é¡¹>git rebase -i çš„ edit é€‰é¡¹
<a class=header-anchor href=#git-rebase--i-%e7%9a%84-edit-%e9%80%89%e9%a1%b9></a></h3><p>å…¶ä¸­ edit é€‰é¡¹èƒ½å¤Ÿç¼–è¾‘è¿‡å»çš„ä¸€ä¸ª commitï¼ˆå¯ä»¥ rewordã€é€‰æ‹©æäº¤çš„æ–‡ä»¶ã€åˆ†å¤šæ¬¡æäº¤ç­‰ç­‰ï¼‰ã€‚æ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>ç»™æŸä¸ª commit é€‰æ‹© editï¼Œgit-rebase å°±ä¼šåœ¨è¿™ä¸ªåœ°æ–¹åœä¸‹æ¥ã€‚æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è‡ªå·±çš„æ„æ„¿è¿›è¡Œæäº¤ï¼Œç„¶åä½¿ç”¨ <code>git rebase --continue</code> è®© git ç»§ç»­ rebaseã€‚åç»­çš„ commits å°±åƒç”¨ cherrypick é€‰å‡ºæ¥çš„ä¸€æ ·ï¼ˆæ­£å¦‚ cherrypickï¼Œè¢«ç¼–è¾‘çš„ commit ä¹‹åçš„æ‰€æœ‰ commit çš„ hash éƒ½ä¼šå˜ï¼‰ã€‚</p><p>å¦‚æœè¿™ä¸ªæ—¶å€™ç›´æ¥ä½¿ç”¨ <code>git rebase --continue</code>ï¼Œé‚£å°±ç›¸å½“äºæ²¡æœ‰ç¼–è¾‘è¿™ä¸ª commitã€‚å¦‚æœæƒ³è¦ç¼–è¾‘åˆ™éœ€è¦å…ˆ resetï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git reset HEAD^
</span></span><span style=display:flex><span>$ git add README
</span></span><span style=display:flex><span>$ git commit -m <span style=color:#2aa198>&#39;Update README formatting&#39;</span>
</span></span><span style=display:flex><span>$ git add lib/simplegit.rb
</span></span><span style=display:flex><span>$ git commit -m <span style=color:#2aa198>&#39;Add blame&#39;</span>
</span></span><span style=display:flex><span>$ git rebase --continue
</span></span></code></pre></div><p>è¿™æ ·è¿™æ¡ commit å°±å˜æˆäº†ä¸¤æ¡ã€‚åœ¨ä½¿ç”¨ <code>git rebase --continue</code> ä¹‹åï¼Œåé¢çš„å‘½ä»¤ä¼šæ¥ä¸Šæ¥ã€‚</p><p><strong>ç”¨ git rebase &ndash;abort å¯ä»¥å–æ¶ˆä¹‹å‰çš„ rebase</strong>ã€‚</p><p>fixup åŠŸèƒ½: å½“ä½ å‘ç°äº†ä¹‹å‰ commit çš„ä¸€ä¸ªå°é”™è¯¯ï¼Œæƒ³è¦å°†å°é”™è¯¯ä¿®è¡¥å›å»æ—¶ï¼Œå¯ä»¥å…ˆå°†è¿™ä¸ªå°é”™è¯¯çš„ä¿®å¤æäº¤ï¼Œç„¶åç”¨ rebase -i æ¥é‡ç»„æäº¤ã€‚å°†è¯¥ä¿®å¤ç§»åŠ¨åˆ°ä¹‹å‰æäº¤çš„ä¸‹æ–¹ï¼Œç„¶åé€‰æ‹© fixupã€‚</p><p>ä¹Ÿæœ‰æ›´æ–¹ä¾¿çš„æ–¹å¼ï¼ˆä¸»è¦æ˜¯éš¾è®°ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ git add <span style=color:#719e07>{</span>filename...<span style=color:#719e07>}</span>                 <span style=color:#586e75># Stage a fix</span>
</span></span><span style=display:flex><span>$ git commit --fixup<span style=color:#719e07>=</span>a0b1c2d3           <span style=color:#586e75># Perform the commit to fix broken a0b1c2d3</span>
</span></span><span style=display:flex><span>$ git rebase -i --autosquash a0b1c2d3~1 <span style=color:#586e75># Now merge fixup commit into broken commit</span>
</span></span></code></pre></div><p>fixup å’Œ squash å¾ˆåƒï¼Œä½†æ˜¯ä¸ä¼šå¼¹å‡ºç¼–è¾‘å™¨è¦æ±‚ä½ æä¾› commit messageã€‚</p><p><code>git commit --fixup</code> çš„ä½œç”¨æ˜¯è®©è¿™æ¬¡çš„æäº¤ä¿¡æ¯å˜æˆ &ldquo;fixup! " åŠ ä¸Šè¦ fixup çš„é‚£æ¡ commit çš„æ—¥å¿—ï¼Œè¿™æ ·ä½¿ç”¨ <code>git rebase -i --autosquash</code> çš„æ—¶å€™å·¥å…·å°±èƒ½æŠŠå®ƒæ”¾åœ¨ä¸€ä¸ªæ­£ç¡®çš„ä½ç½®ï¼Œç†è®ºä¸Šæ¯”æ‰‹åŠ¨ç¼–è¾‘ commit æ›´æ–¹ä¾¿ã€‚ç„¶è€Œï¼Œä½ éœ€è¦çŸ¥é“è¦ fixup çš„ commitï¼Œä¹Ÿå°±æ˜¯è¯´è¦ç²˜è´´ä¸¤æ¬¡ï¼ˆcommit ä¸€æ¬¡ï¼Œrebase ä¸€æ¬¡ï¼‰ï¼Œè€Œä¸” <code>--autosquash</code> è¿™ä¸ªé€‰é¡¹è¿˜æŒºé•¿çš„ã€‚æ„Ÿè§‰è¿˜æ˜¯ vim dd + p æ¯”è¾ƒæ–¹ä¾¿ã€‚</p><h3 id=git-rebase-å‘ç”Ÿå†²çªæ€ä¹ˆåŠ>git rebase å‘ç”Ÿå†²çªæ€ä¹ˆåŠ
<a class=header-anchor href=#git-rebase-%e5%8f%91%e7%94%9f%e5%86%b2%e7%aa%81%e6%80%8e%e4%b9%88%e5%8a%9e></a></h3><blockquote><p>The first is how you complete the conflict resolution. Rather thanÂ <code>git commit</code>Â like you&rsquo;ll use when addressing conflicts that arise fromÂ <code>git merge</code>, the appropriate command for rebasing isÂ <code>git rebase --continue</code>.</p></blockquote><p>åŒæ ·ä¼šåœ¨æ–‡ä»¶ä¸­ç•™ä¸‹ markersï¼Œè§£å†³å†²çªä¹‹åè¦ç”¨ git rebase &ndash;continue è€Œä¸æ˜¯ git mergeã€‚</p><blockquote><p>If you want to take a look at the diff of the commit that Git failed to replay, and which resulted in a merge conflict, you can useÂ <code>git rebase --show-current-patch</code>, or its equivalentÂ <code>git show REBASE_HEAD</code>.</p></blockquote><blockquote><p>Finally, it&rsquo;s worth noting that when usingÂ <code>git checkout --ours</code>Â orÂ <code>--theirs</code>Â to quickly resolve conflicted paths by checking out a specific version from the index, the meaning of those options is reversed compared to a regularÂ <code>git merge</code>Â merge conflict: during rebase,Â <code>--theirs</code>Â refers to the changes from the branch being rebased (<code>REBASE_HEAD</code>), andÂ <code>--ours</code>Â refers to the changes from the branch onto which we are rebasing (<code>HEAD</code>). <a href=https://git-rebase.io/#note-6 title=https://git-rebase.io/#note-6 rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://git-rebase.io/#note-6<i class="fa fa-external-link-alt"></i></a></p></blockquote><h2 id=git-reset>git reset
<a class=header-anchor href=#git-reset></a></h2><blockquote><p>The reset command overwrites these three trees in a specific order, stopping when you tell it to:</p><ol><li>Move the branch HEAD points to (stop here if <code>--soft</code>).</li><li>Make the index look like HEAD (stop here unless <code>--hard</code>).</li><li>Make the working directory look like the index.</li></ol></blockquote><h3 id=åª-reset-éƒ¨åˆ†æ–‡ä»¶>åª reset éƒ¨åˆ†æ–‡ä»¶
<a class=header-anchor href=#%e5%8f%aa-reset-%e9%83%a8%e5%88%86%e6%96%87%e4%bb%b6></a></h3><p><code>git reset file.txt</code> ç›¸å½“äº <code>git reset --mixed HEAD file.txt</code>ã€‚ç”±äº HEAD åªæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œä¸èƒ½åŒæ—¶æŒ‡å‘ä¸åŒçš„åœ°æ–¹ï¼Œgit reset æ–‡ä»¶çš„æ—¶å€™æ˜¯ä¸ä¼šç§»åŠ¨ HEAD çš„ã€‚é‚£è¿™ä¸€æ­¥çš„æ•ˆæœå°±æ˜¯ä» HEAD ä¸­å–å‡ºæ–‡ä»¶å¿«ç…§è¿˜åŸåˆ° index åŒºï¼Œç›¸å½“äº <code>git restore --staged file.txt</code>ã€‚</p><p>åª reset éƒ¨åˆ†æ–‡ä»¶çš„æ—¶å€™ï¼Œå¥½åƒåªèƒ½æ˜¯ &ndash;mixed æ¨¡å¼ã€‚</p><h3 id=ç”¨-reset-æ¥åš-squashing>ç”¨ reset æ¥åš squashing
<a class=header-anchor href=#%e7%94%a8-reset-%e6%9d%a5%e5%81%9a-squashing></a></h3><p>é¦–å…ˆæ˜¯ git reset &ndash;soft {commit} å®šä½åˆ°ä¹‹å‰çš„ä½ç½®ï¼Œç„¶åç›´æ¥ git commitã€‚å› ä¸º git reset &ndash;soft {commit} ä¸ä¼šæ”¹åŠ¨ index å’Œå·¥ä½œåŒºï¼</p><h2 id=git-checkout>git checkout
<a class=header-anchor href=#git-checkout></a></h2><p><code>git checkout {commit}</code> è¡¨é¢ä¸Šæœ‰ç‚¹åƒ <code>git reset --hard {commit}</code>ï¼Œä½†æ˜¯ï¼š</p><ol><li>git checkout åœ¨ä¿®æ”¹æ–‡ä»¶ä¹‹å‰ä¼šåšæ£€æŸ¥ï¼Œåªä¼šå°†æœªä¿®æ”¹è¿‡çš„æ–‡ä»¶æ›´æ–°ã€‚</li><li><strong>git checkout åªä¼šç®€å•ä¿®æ”¹ HEADï¼Œå› è€Œèƒ½åœ¨ä¸åŒçš„åˆ†æ”¯ä¹‹é—´è·³è½¬ã€‚git reset &ndash;hard ä¼šæŠŠå½“å‰åˆ†æ”¯çš„ HEAD æ”¹æˆç»™å®šçš„ commit å¹¶ç§»åŠ¨è¿‡å»ï¼</strong></li></ol><p><code>git checkout -- {files...}</code> ç›¸å½“äº <code>git reset -- {files...}</code>ï¼ˆåªä¿®æ”¹ indexï¼‰ä¹‹ååˆå°†ç›¸å…³æ–‡ä»¶åœ¨ index çš„å†…å®¹å¤åˆ¶åˆ°å·¥ä½œåŒºã€‚</p><p>è¦æ‰¾åªä¿®æ”¹å·¥ä½œåŒºæ–‡ä»¶è€Œä¸ä¿®æ”¹ index çš„å•ä¸ªå‘½ä»¤å°±åªæœ‰ <code>git restore</code> èƒ½åšåˆ°ã€‚</p><h2 id=git-merge>git merge
<a class=header-anchor href=#git-merge></a></h2><p>git merge å¯ä»¥ä½¿ç”¨ <code>-Xignore-all-space</code> æˆ–è€… <code>-Xignore-space-change</code> å‚æ•°ã€‚åè€…å°†å¤šä¸ªç©ºç™½å­—ç¬¦è§†ä½œä¸€ä¸ªï¼Œä½†æ˜¯å°†æœ‰ç©ºç™½å­—ç¬¦å’Œæ— ç©ºç™½å­—ç¬¦è§†ä½œå·®å¼‚ã€‚</p></div><footer class=post-footer><div class=post-tags><a href=/tags/pro-git-the-book>pro-git-the-book
</a><a href=/tags/git>git</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/pro-git-the-book/7.9-Git-Tools-Rerere/ rel=next title="7.9 Git Tools - Rerere"><i class="fa fa-chevron-left"></i> 7.9 Git Tools - Rerere</a></div><div class="post-nav-prev post-nav-item"></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2023 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>ğŸ¤–</span></div><div class=powered-by>ç”± <a href=https://gohugo.io title=0.143.1 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨</div></div></footer><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":false,"save":"manual"},"copybtn":true,"darkmode":false,"hostname":"https://hxhue.github.io/","i18n":{"ds_day":" å¤©å‰","ds_days":" å¤© ","ds_hour":" å°æ—¶å‰","ds_hours":" å°æ—¶ ","ds_just":"åˆšåˆš","ds_min":" åˆ†é’Ÿå‰","ds_mins":" åˆ†é’Ÿ","ds_month":" ä¸ªæœˆå‰","ds_years":" å¹´ ","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","placeholder":"æœç´¢..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":false,"transition":{"collheader":"fadeInLeft","menu_item":"fadeInDown","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline"},"views":{"enable":false,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"cdnjs","router":"https://cdnjs.cloudflare.com/ajax/libs"},"version":"4.5.3"}</script><script type=text/javascript src=/js/main.min.37ba8b54f9d4d784d08028c45eea93b5d4e13eda8ee7fb0d2edd6f3fac66cfd2.js defer></script></body></html>