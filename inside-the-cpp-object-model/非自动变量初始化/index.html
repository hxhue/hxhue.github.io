<!doctype html><html lang=zh-CN data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.143.1"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="ğŸ“Œ éè‡ªåŠ¨å˜é‡åˆå§‹åŒ–"><meta itemprop=description content="ä¸ªäººåšå®¢ï¼Œä¸»è¦æ˜¯é›¶æ•£çš„ç¬”è®°ã€‚"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://hxhue.github.io/imgs/371907.jpg"><meta itemprop=keywords content="cpp,inside-the-cpp-object-model"><link type=text/css rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css><link rel=stylesheet href=/css/main.min.bea76f574a755574e17d42bea39502a74ca3ca4db65807b8c82d3e26dcec8420.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ æˆ‘å¯æ˜¯æœ‰åº•çº¿çš„å“Ÿ ~"}</style><link rel=stylesheet type=text/css href=/css/style.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/github-markdown-css@5.3.0/github-markdown-dark.css><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js></script><script>MathJax={tex:{displayMath:[["$$","$$"],["\\[","\\]"]],inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: false });
  mermaid.mermaidAPI.initialize();
  window.mermaid = mermaid;
</script><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":false,"isHome":false,"isPage":true,"path":"%E9%9D%9E%E8%87%AA%E5%8A%A8%E5%8F%98%E9%87%8F%E5%88%9D%E5%A7%8B%E5%8C%96","permalink":"https://hxhue.github.io/inside-the-cpp-object-model/%E9%9D%9E%E8%87%AA%E5%8A%A8%E5%8F%98%E9%87%8F%E5%88%9D%E5%A7%8B%E5%8C%96/","title":"ğŸ“Œ éè‡ªåŠ¨å˜é‡åˆå§‹åŒ–","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>ğŸ“Œ éè‡ªåŠ¨å˜é‡åˆå§‹åŒ– - Bluegill</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Bluegill</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description></p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href=/about/ class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>å…³äº</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>å½’æ¡£</a></li><li class="menu-item menu-item-categories"><a href=/categories/ class=hvr-icon-pulse rel=section><i class="fa fa-th hvr-icon"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-hashtag hvr-icon"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-daily"><a href=/daily/ class=hvr-icon-pulse rel=section><i class="fa fa-newspaper hvr-icon"></i>éšç¬”</a></li><li class="menu-item menu-item-discovery"><a href=https://rift-fear-f2c.notion.site/2025-1e354a33cfb1802c841bdf29f2f3dab3 class=hvr-icon-pulse rel=section><i class="fa fa-compass hvr-icon"></i>å‘ç°</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>æœç´¢</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=æœç´¢... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>æ–‡ç« ç›®å½•</li><li class=sidebar-nav-overview>ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#c-å’Œ-c-thread_local-çš„åŒºåˆ«>C++ å’Œ C <code>thread_local</code> çš„åŒºåˆ«</a></li><li><a href=#ä»ä»£ä»·ä¸Šæ¥çœ‹-c-çš„å‡ ç§å˜é‡åˆå§‹åŒ–>ä»ä»£ä»·ä¸Šæ¥çœ‹ C++ çš„å‡ ç§å˜é‡åˆå§‹åŒ–</a></li><li><a href=#å…¨å±€-å’Œ-static-å˜é‡>å…¨å±€ (å’Œ static) å˜é‡</a><ul><li><a href=#ä¸æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼c-æ¨¡å‹>ä¸æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ï¼ˆC æ¨¡å‹ï¼‰</a></li><li><a href=#æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ä½†åªå¯¹å¯¹è±¡ç”Ÿæ•ˆcfront-10-æ¨¡å‹><del>æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ï¼Œä½†åªå¯¹å¯¹è±¡ç”Ÿæ•ˆ</del>ï¼ˆCfront 1.0 æ¨¡å‹ï¼‰</a></li><li><a href=#æ‰€æœ‰ç±»å‹æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ç°åœ¨çš„-c-æ¨¡å‹>æ‰€æœ‰ç±»å‹æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ï¼ˆç°åœ¨çš„ C++ æ¨¡å‹ï¼‰</a><ul><li><a href=#gpt-å¯¹äºä¹¦ä¸­è¯´æ³•çš„è§£é‡Š>GPT å¯¹äºä¹¦ä¸­è¯´æ³•çš„è§£é‡Š</a></li></ul></li></ul></li><li><a href=#å±€éƒ¨-static-å˜é‡>å±€éƒ¨ static å˜é‡</a></li><li><a href=#å…¨å±€--å±€éƒ¨-thread_local-å˜é‡>å…¨å±€ / å±€éƒ¨ thread_local å˜é‡</a><ul><li><a href=#c11-thread_local>C++11 thread_local</a></li><li><a href=#c11-_thread_local>C11 _Thread_local</a></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=ğŸ¤– src=/imgs/371907.jpg><p class=site-author-name itemprop=name>ğŸ¤–</p><div class=site-description itemprop=description>ä¸ªäººåšå®¢ï¼Œä¸»è¦æ˜¯é›¶æ•£çš„ç¬”è®°ã€‚</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>433</span>
<span class=site-state-item-name>æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>12</span>
<span class=site-state-item-name>åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>86</span>
<span class=site-state-item-name>æ ‡ç­¾</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/hxhue title="Github â†’ https://github.com/hxhue" rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>
Github
</a></span><span class=links-of-social-item><a href=/rss.xml title="RSS è®¢é˜… â†’ /rss.xml" rel=noopener target=_blank><i class="fa fa-rss fa-fw"></i>
RSS è®¢é˜…</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=å…±äº«çŸ¥è¯†><img src=/imgs/cc/big/by_nc_sa.svg alt=å…±äº«çŸ¥è¯†></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
å‹æƒ…é“¾æ¥</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://shuai.guru/ title=https://shuai.guru/ target=_blank>shuai.guru</a></li></ul></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=toggle-theme class=button title=æ·±æµ…æ¨¡å¼åˆ‡æ¢><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=è¿”å›é¡¶éƒ¨><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://hxhue.github.io/inside-the-cpp-object-model/%E9%9D%9E%E8%87%AA%E5%8A%A8%E5%8F%98%E9%87%8F%E5%88%9D%E5%A7%8B%E5%8C%96/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/371907.jpg"><meta itemprop=name content="ğŸ¤–"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="ğŸ¤–"><meta itemprop=description content="ä¸ªäººåšå®¢ï¼Œä¸»è¦æ˜¯é›¶æ•£çš„ç¬”è®°ã€‚"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="ğŸ“Œ éè‡ªåŠ¨å˜é‡åˆå§‹åŒ–"><meta itemprop=description content="C++ å’Œ C thread_local çš„åŒºåˆ«


C++ æ”¯æŒä½¿ç”¨éå¸¸é‡è¡¨è¾¾å¼å¯¹å…¨å±€æˆ–é™æ€å˜é‡åˆå§‹åŒ– 1ã€‚å¯¹äº static local 2 / thread_local å˜é‡è€Œè¨€ï¼Œè¿™é¡¹åŠŸèƒ½éœ€è¦åœ¨è®¿é—®å‰æ£€æŸ¥å˜é‡æ˜¯å¦å·²ç»å®Œæˆåˆå§‹åŒ–ï¼Œthread_local åˆå§‹åŒ–ä¸éœ€è¦çº¿ç¨‹é—´åŒæ­¥ï¼Œè€Œ static local å˜é‡çš„è®¿é—®è¿‡ç¨‹éœ€è¦çº¿ç¨‹é—´çš„åŒæ­¥ï¼ˆ__cxa_guard_acquire å’Œ __cxa_guard_releaseï¼‰ã€‚
C++ çš„ thread_local å˜é‡åœ¨å‡½æ•°ä½œç”¨åŸŸä¸­è‡ªåŠ¨å…·æœ‰ static å±æ€§ 3ï¼Œè€Œ C è¦æ‰‹åŠ¨åŠ ã€‚åœ¨ C è¯­è¨€ä¸­ï¼Œå‡½æ•°ä¸­çš„ thread_local å¿…é¡»å’Œ extern æˆ–è€… static ä¹‹ä¸€ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å­ä¸º https://godbolt.org/z/eKz71xh7a ã€‚
C çš„ thread_local åœ¨ C23 ä¹‹å‰æ˜¯ä¸ªå®ã€‚

ä»ä»£ä»·ä¸Šæ¥çœ‹ C++ çš„å‡ ç§å˜é‡åˆå§‹åŒ–


é¦–å…ˆï¼Œä¸éœ€è¦å‡½æ•°åˆå§‹åŒ–çš„åœ¨ç¼–è¯‘æœŸé—´å°±èƒ½å®Œæˆå·¥ä½œï¼Œæ²¡æœ‰ä»£ä»·ã€‚æ‰€ä»¥ä»¥ä¸‹è®¨è®ºçš„éƒ½æ˜¯é€šè¿‡å‡½æ•°æˆ–æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–çš„å˜é‡ã€‚
å…¶æ¬¡ï¼Œå‡½æ•°å†… (static) thread_local å˜é‡åªéœ€è¦åœ¨ä½¿ç”¨å‰æ£€æŸ¥ä¸€ä¸‹ï¼Œæ„é€ å’Œä½¿ç”¨éƒ½ä¸ç”¨åŒæ­¥ï¼Œä»£ä»·å¾ˆå°ã€‚å‡½æ•°å†… static å˜é‡çš„æ„é€ å’Œä½¿ç”¨åˆ™éœ€è¦çº¿ç¨‹ä¹‹é—´åŒæ­¥ã€‚
å‡½æ•°å¤–å®šä¹‰çš„æ™®é€šå˜é‡å’Œ thread_local å˜é‡éƒ½ä¸éœ€è¦ä»»ä½•åŒæ­¥å°±èƒ½åœ¨é™æ€åˆå§‹åŒ–é˜¶æ®µå®Œæˆåˆå§‹åŒ–ï¼Œä½¿ç”¨æ—¶ä¹Ÿä¸éœ€è¦æ£€æŸ¥ã€‚
å‡½æ•°å¤–å®šä¹‰çš„ inline å˜é‡ï¼ˆC++17ï¼‰åœ¨ä½¿ç”¨æ—¶ä¸éœ€è¦åŒæ­¥ï¼Œä½†æ˜¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¦æ£€æŸ¥æ˜¯å¦å·²ç»åˆå§‹åŒ–å®Œæˆï¼ˆä¸ºæ­¤æœ‰ä¸ª guard variable æ ‡è®°ï¼‰ã€‚è§ https://godbolt.org/z/hYMjdbsxj ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸º inline å˜é‡å¯èƒ½è¢«å¤šä¸ªåœ°æ–¹ä½¿ç”¨ï¼Œæ¯ä¸ªåœ°æ–¹éƒ½è¦æé˜²é‡å¤åˆå§‹åŒ–ã€‚

å…¨å±€ (å’Œ static) å˜é‡

æœ€å¤–å›´å®šä¹‰åŸŸå®šä¹‰çš„å˜é‡ï¼Œå¯ä»¥å…·æœ‰ static å±æ€§ä¹Ÿå¯ä»¥æ²¡æœ‰ã€‚"></span><header class=post-header><h1 class=post-title itemprop="name headline">ğŸ“Œ éè‡ªåŠ¨å˜é‡åˆå§‹åŒ–</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2023-08-12 00:00:00 +0800 CST" itemprop="dateCreated datePublished" datetime="2023-08-12 00:00:00 +0800 CST">2023-08-12
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar-check"></i>
</span><span class=post-meta-item-text title=æ›´æ–°äº>æ›´æ–°äºï¼š
</span><time title=ä¿®æ”¹æ—¶é—´ï¼š2025-03-18T00:00:00+08:00 itemprop=dateModified datetime=2025-03-18T00:00:00+08:00>2025-03-18</time>
</span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/inside-the-cpp-object-model itemprop=url rel=index><span itemprop=name>inside-the-cpp-object-model</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=å­—æ•°><span class=post-meta-item-icon><i class="far fa-file-word"></i>
</span><span class=post-meta-item-text>å­—æ•°ï¼š</span>
<span>2547</span>
</span><span class=post-meta-item title=é˜…è¯»><span class=post-meta-item-icon><i class="far fa-clock"></i>
</span><span class=post-meta-item-text>é˜…è¯»ï¼š&ap;</span>
<span>6åˆ†é’Ÿ</span></span></div></div></header><div class=post-body itemprop=articleBody><h1 id=c-å’Œ-c-thread_local-çš„åŒºåˆ«>C++ å’Œ C <code>thread_local</code> çš„åŒºåˆ«
<a class=header-anchor href=#c-%e5%92%8c-c-thread_local-%e7%9a%84%e5%8c%ba%e5%88%ab></a></h1><ol><li>C++ æ”¯æŒä½¿ç”¨éå¸¸é‡è¡¨è¾¾å¼å¯¹å…¨å±€æˆ–é™æ€å˜é‡åˆå§‹åŒ– <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>ã€‚å¯¹äº <code>static</code> local <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> / <code>thread_local</code> å˜é‡è€Œè¨€ï¼Œè¿™é¡¹åŠŸèƒ½éœ€è¦åœ¨è®¿é—®å‰æ£€æŸ¥å˜é‡æ˜¯å¦å·²ç»å®Œæˆåˆå§‹åŒ–ï¼Œ<strong><code>thread_local</code> åˆå§‹åŒ–ä¸éœ€è¦çº¿ç¨‹é—´åŒæ­¥ï¼Œè€Œ <code>static</code> local å˜é‡çš„è®¿é—®è¿‡ç¨‹éœ€è¦çº¿ç¨‹é—´çš„åŒæ­¥ï¼ˆ<code>__cxa_guard_acquire</code> å’Œ <code>__cxa_guard_release</code>ï¼‰</strong>ã€‚</li><li>C++ çš„ <code>thread_local</code> å˜é‡<strong>åœ¨å‡½æ•°ä½œç”¨åŸŸä¸­</strong>è‡ªåŠ¨å…·æœ‰ <code>static</code> å±æ€§ <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>ï¼Œè€Œ C è¦æ‰‹åŠ¨åŠ ã€‚åœ¨ C è¯­è¨€ä¸­ï¼Œå‡½æ•°ä¸­çš„ <code>thread_local</code> å¿…é¡»å’Œ <code>extern</code> æˆ–è€… <code>static</code> ä¹‹ä¸€ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å­ä¸º <a href=https://godbolt.org/z/eKz71xh7a title=https://godbolt.org/z/eKz71xh7a rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://godbolt.org/z/eKz71xh7a<i class="fa fa-external-link-alt"></i></a> ã€‚</li><li>C çš„ <code>thread_local</code> åœ¨ C23 ä¹‹å‰æ˜¯ä¸ªå®ã€‚</li></ol><h1 id=ä»ä»£ä»·ä¸Šæ¥çœ‹-c-çš„å‡ ç§å˜é‡åˆå§‹åŒ–>ä»ä»£ä»·ä¸Šæ¥çœ‹ C++ çš„å‡ ç§å˜é‡åˆå§‹åŒ–
<a class=header-anchor href=#%e4%bb%8e%e4%bb%a3%e4%bb%b7%e4%b8%8a%e6%9d%a5%e7%9c%8b-c-%e7%9a%84%e5%87%a0%e7%a7%8d%e5%8f%98%e9%87%8f%e5%88%9d%e5%a7%8b%e5%8c%96></a></h1><ul><li>é¦–å…ˆï¼Œä¸éœ€è¦å‡½æ•°åˆå§‹åŒ–çš„åœ¨ç¼–è¯‘æœŸé—´å°±èƒ½å®Œæˆå·¥ä½œï¼Œæ²¡æœ‰ä»£ä»·ã€‚<strong>æ‰€ä»¥ä»¥ä¸‹è®¨è®ºçš„éƒ½æ˜¯é€šè¿‡å‡½æ•°æˆ–æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–çš„å˜é‡</strong>ã€‚</li><li>å…¶æ¬¡ï¼Œå‡½æ•°å†… (static) thread_local å˜é‡åªéœ€è¦åœ¨ä½¿ç”¨å‰æ£€æŸ¥ä¸€ä¸‹ï¼Œæ„é€ å’Œä½¿ç”¨éƒ½ä¸ç”¨åŒæ­¥ï¼Œä»£ä»·å¾ˆå°ã€‚å‡½æ•°å†… static å˜é‡çš„æ„é€ å’Œä½¿ç”¨åˆ™éœ€è¦çº¿ç¨‹ä¹‹é—´åŒæ­¥ã€‚</li><li>å‡½æ•°å¤–å®šä¹‰çš„æ™®é€šå˜é‡å’Œ thread_local å˜é‡éƒ½ä¸éœ€è¦ä»»ä½•åŒæ­¥å°±èƒ½åœ¨é™æ€åˆå§‹åŒ–é˜¶æ®µå®Œæˆåˆå§‹åŒ–ï¼Œä½¿ç”¨æ—¶ä¹Ÿä¸éœ€è¦æ£€æŸ¥ã€‚</li><li>å‡½æ•°å¤–å®šä¹‰çš„ inline å˜é‡ï¼ˆC++17ï¼‰åœ¨ä½¿ç”¨æ—¶ä¸éœ€è¦åŒæ­¥ï¼Œä½†æ˜¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™è¦æ£€æŸ¥æ˜¯å¦å·²ç»åˆå§‹åŒ–å®Œæˆï¼ˆä¸ºæ­¤æœ‰ä¸ª guard variable æ ‡è®°ï¼‰ã€‚è§ <a href=https://godbolt.org/z/hYMjdbsxj title=https://godbolt.org/z/hYMjdbsxj rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://godbolt.org/z/hYMjdbsxj<i class="fa fa-external-link-alt"></i></a> ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸º inline å˜é‡å¯èƒ½è¢«å¤šä¸ªåœ°æ–¹ä½¿ç”¨ï¼Œæ¯ä¸ªåœ°æ–¹éƒ½è¦æé˜²é‡å¤åˆå§‹åŒ–ã€‚</li></ul><h1 id=å…¨å±€-å’Œ-static-å˜é‡>å…¨å±€ (å’Œ static) å˜é‡
<a class=header-anchor href=#%e5%85%a8%e5%b1%80-%e5%92%8c-static-%e5%8f%98%e9%87%8f></a></h1><p>æœ€å¤–å›´å®šä¹‰åŸŸå®šä¹‰çš„å˜é‡ï¼Œå¯ä»¥å…·æœ‰ static å±æ€§ä¹Ÿå¯ä»¥æ²¡æœ‰ã€‚</p><h2 id=ä¸æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼c-æ¨¡å‹>ä¸æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ï¼ˆC æ¨¡å‹ï¼‰
<a class=header-anchor href=#%e4%b8%8d%e6%94%af%e6%8c%81%e9%9d%9e%e5%b8%b8%e9%87%8f%e5%88%9d%e5%a7%8b%e5%8c%96%e8%a1%a8%e8%be%be%e5%bc%8fc-%e6%a8%a1%e5%9e%8b></a></h2><p>ç¼–è¯‘å™¨ä¼šæŠ±æ€¨ï¼šinitializer element is not constantã€‚</p><h2 id=æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ä½†åªå¯¹å¯¹è±¡ç”Ÿæ•ˆcfront-10-æ¨¡å‹><del>æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ï¼Œä½†åªå¯¹å¯¹è±¡ç”Ÿæ•ˆ</del>ï¼ˆCfront 1.0 æ¨¡å‹ï¼‰
<a class=header-anchor href=#%e6%94%af%e6%8c%81%e9%9d%9e%e5%b8%b8%e9%87%8f%e5%88%9d%e5%a7%8b%e5%8c%96%e8%a1%a8%e8%be%be%e5%bc%8f%e4%bd%86%e5%8f%aa%e5%af%b9%e5%af%b9%e8%b1%a1%e7%94%9f%e6%95%88cfront-10-%e6%a8%a1%e5%9e%8b></a></h2><p>åœ¨ç”¨æˆ·ç¨‹åºçœŸæ­£è¿è¡Œå‰æ’å…¥ä¸€æ®µ<strong>é™æ€å˜é‡åˆå§‹åŒ–ä»£ç ã€‚</strong></p><p>Cfront æ—©æœŸå¯¹ class object æ”¯æŒäº†<strong>éå¸¸é‡çš„é™æ€åˆå§‹åŒ–</strong>ï¼Œä½†<strong>æ ‡å‡†ç±»å‹</strong>ï¼ˆæ•´æ•°ã€æŒ‡é’ˆç­‰ï¼‰çš„é™æ€æ”¯æŒå’Œ C ä¸€æ ·ã€‚</p><p><img src=/assets/dd4139cc4c1f5af8a382e9708ca348b5.webp></p><p>è€ƒè™‘ä¸‹é¢çš„ä»£ç ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Point</span> {
</span></span><span style=display:flex><span>    <span style=color:#dc322f>double</span> x;
</span></span><span style=display:flex><span>    <span style=color:#dc322f>double</span> y;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Point</span> point <span style=color:#719e07>=</span> {<span style=color:#2aa198>2.4</span>, <span style=color:#2aa198>0.1</span>};
</span></span></code></pre></div><p>æ­¤ä»£ç æ˜¯åˆæ³•çš„ C æˆ– C++ ä»£ç ã€‚å®ƒçš„æ•°æ®å€¼ç›´æ¥å†™åˆ° data section é‡Œï¼Œä¸éœ€è¦é™æ€åˆå§‹åŒ–ä»£ç ï¼ˆä¹Ÿå°±æ˜¯ä¸éœ€è¦ç”¨éå¸¸é‡è¡¨è¾¾å¼å¯¹å˜é‡åˆå§‹åŒ–ï¼‰ã€‚</p><p>ä¿®æ”¹è¿™æ®µä»£ç ä¹‹åå°±ä¸èƒ½ä½œä¸º C è¯­è¨€ç¼–è¯‘äº†ï¼Œä½†æ˜¯å¯ä»¥ä½œä¸º C++ ç¼–è¯‘ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Point</span> {
</span></span><span style=display:flex><span>    <span style=color:#dc322f>double</span> x;
</span></span><span style=display:flex><span>    <span style=color:#dc322f>double</span> y;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Point</span> point <span style=color:#719e07>=</span> {<span style=color:#2aa198>2.4</span>, <span style=color:#2aa198>0.1</span>};
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Point</span> another_point <span style=color:#719e07>=</span> point;
</span></span></code></pre></div><p>åˆå§‹åŒ– <code>another_point</code> éœ€è¦ç”¨åˆ° <code>point</code>ï¼Œè¿™äº§ç”Ÿäº†å…¨å±€å˜é‡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œåœ¨ç¼–è¯‘å™¨çœ‹æ¥ä¸æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼Œæ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹ä¼šè¢«æ”¾åˆ°<strong>é™æ€å˜é‡åˆå§‹åŒ–ä»£ç </strong>ä¸­è¿›è¡Œã€‚</p><h2 id=æ‰€æœ‰ç±»å‹æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ç°åœ¨çš„-c-æ¨¡å‹>æ‰€æœ‰ç±»å‹æ”¯æŒéå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ï¼ˆç°åœ¨çš„ C++ æ¨¡å‹ï¼‰
<a class=header-anchor href=#%e6%89%80%e6%9c%89%e7%b1%bb%e5%9e%8b%e6%94%af%e6%8c%81%e9%9d%9e%e5%b8%b8%e9%87%8f%e5%88%9d%e5%a7%8b%e5%8c%96%e8%a1%a8%e8%be%be%e5%bc%8f%e7%8e%b0%e5%9c%a8%e7%9a%84-c-%e6%a8%a1%e5%9e%8b></a></h2><p>åæ¥ C++ å¯¹æ‰€æœ‰ç±»å‹éƒ½æ”¯æŒéå¸¸é‡é™æ€åˆå§‹åŒ–äº†ã€‚è¿™å¯èƒ½æ˜¯æ”¯æŒè™šåŸºç±»çš„å‰¯äº§å“ï¼Œå› ä¸ºè™šåŸºç±»å’Œå­ç±»ä¹‹é—´çš„æŒ‡é’ˆè½¬æ¢éœ€è¦çŸ¥é“ offsetï¼Œè€Œ offset åªèƒ½åœ¨ç¼–è¯‘å…¨éƒ¨å®Œæˆä¹‹åæ‰èƒ½ç¡®å®šã€‚</p><p>å¯ä»¥å‚è€ƒï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>class</span> <span style=color:#268bd2>Base</span> {};
</span></span><span style=display:flex><span><span style=color:#719e07>class</span> <span style=color:#268bd2>VirtualBase</span><span style=color:#719e07>:</span> <span style=color:#719e07>public</span> <span style=color:#719e07>virtual</span> Base {};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// ä¸éœ€è¦é™æ€åˆå§‹åŒ–ä»£ç 
</span></span></span><span style=display:flex><span><span style=color:#586e75>// Base *pbase = (Base *)0x1000;
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>// ä» VirtualBase* è½¬æ¢æˆ Base*ï¼Œéœ€è¦é™æ€åˆå§‹åŒ–ä»£ç 
</span></span></span><span style=display:flex><span><span style=color:#586e75>// å¦‚æœæŠŠè™šç»§æ‰¿æ”¹æˆå…·ä½“ç»§æ‰¿ï¼Œä¹Ÿä¸å†ä¼šéœ€è¦é™æ€åˆå§‹åŒ–ä»£ç 
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>Base <span style=color:#719e07>*</span>pbase2 <span style=color:#719e07>=</span> (VirtualBase <span style=color:#719e07>*</span>)<span style=color:#2aa198>0x1000</span>;
</span></span></code></pre></div><h3 id=gpt-å¯¹äºä¹¦ä¸­è¯´æ³•çš„è§£é‡Š>GPT å¯¹äºä¹¦ä¸­è¯´æ³•çš„è§£é‡Š
<a class=header-anchor href=#gpt-%e5%af%b9%e4%ba%8e%e4%b9%a6%e4%b8%ad%e8%af%b4%e6%b3%95%e7%9a%84%e8%a7%a3%e9%87%8a></a></h3><p>Consider the following example:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>class</span> <span style=color:#268bd2>Base</span> {};
</span></span><span style=display:flex><span><span style=color:#719e07>class</span> <span style=color:#268bd2>VirtualBase</span><span style=color:#719e07>:</span> <span style=color:#719e07>public</span> <span style=color:#719e07>virtual</span> Base {};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>class</span> <span style=color:#268bd2>Derived1</span><span style=color:#719e07>:</span> <span style=color:#719e07>public</span> VirtualBase {};
</span></span><span style=display:flex><span><span style=color:#719e07>class</span> <span style=color:#268bd2>Derived2</span><span style=color:#719e07>:</span> <span style=color:#719e07>public</span> VirtualBase {};
</span></span></code></pre></div><p>In this example, we have two separate derived classes, <strong><code>Derived1</code></strong> and <strong><code>Derived2</code></strong>, both inheriting from the same virtual base class <strong><code>VirtualBase</code></strong>.</p><p>Now, when the compiler encounters the definition of <strong><code>Derived1</code></strong> or <strong><code>Derived2</code></strong> in a given translation unit, it doesn&rsquo;t have information about other derived classes. As a result, the exact offset of the <strong><code>VirtualBase</code></strong> subobject within <strong><code>Derived1</code></strong> or <strong><code>Derived2</code></strong> cannot be determined at that point.</p><p>To handle this situation, the compiler employs static initialization. It generates code that initializes static variables associated with the virtual base class. These static variables store the offset information needed to access the virtual base class subobject. The initialization of these static variables happens at runtime before any objects of the derived classes are created.</p><p>By utilizing static initialization, the compiler ensures that the correct offset information is available at runtime, allowing proper access to the virtual base class subobject.</p><h1 id=å±€éƒ¨-static-å˜é‡>å±€éƒ¨ static å˜é‡
<a class=header-anchor href=#%e5%b1%80%e9%83%a8-static-%e5%8f%98%e9%87%8f></a></h1><p>è¿™é‡Œåªè®¨è®º C++ï¼ŒC æ²¡æœ‰éå¸¸é‡åˆå§‹åŒ–çš„åŠŸèƒ½ã€‚</p><p>C++ ä¿è¯å‡½æ•°ä¸­çš„é™æ€å¯¹è±¡åªåœ¨å…¶å¯¹åº”å‡½æ•°è¢«è°ƒç”¨æ—¶åˆå§‹åŒ–ï¼Œè€Œä¸”ä»…åˆå§‹åŒ–ä¸€æ¬¡ã€‚å¦‚æœæ˜¯å¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ï¼Œåˆ™åœ¨ç¼–è¯‘æ—¶å¯ä»¥åˆå§‹åŒ–ï¼Œå‡½æ•°ä¸­ä¹Ÿä¸éœ€è¦åŒæ­¥æªæ–½ï¼›<strong>ä½†å¦‚æœæ˜¯éå¸¸é‡åˆå§‹åŒ–è¡¨è¾¾å¼ï¼Œåˆ™æœ‰åŒæ­¥ä»£ä»·ï¼</strong></p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>#include</span> <span style=color:#719e07>&lt;cstdio&gt;</span><span style=color:#719e07>
</span></span></span><span style=display:flex><span><span style=color:#719e07></span>
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Echo</span> {
</span></span><span style=display:flex><span>    Echo(<span style=color:#719e07>const</span> <span style=color:#dc322f>char</span> <span style=color:#719e07>*</span>s) {
</span></span><span style=display:flex><span>        puts(s);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#719e07>static</span> Echo <span style=color:#719e07>*</span>static_member;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>// åˆå§‹åŒ–åªèƒ½æ”¾åˆ°è¿™é‡Œï¼Œå¦‚æœæ”¾åˆ°ä¸Šé¢ Echo å°±ä¸æ˜¯å®Œæ•´å¯¹è±¡ä¸èƒ½åˆ›å»º
</span></span></span><span style=display:flex><span><span style=color:#586e75>// å‰é¢å£°æ˜ä¸èƒ½åŠ  inline å› ä¸º inline ä¼šè®©å£°æ˜å˜æˆå®šä¹‰
</span></span></span><span style=display:flex><span><span style=color:#586e75>// æ­¤å¤„å®šä¹‰ä¸èƒ½åŠ  static å› ä¸ºä¸èƒ½å¤šæ¬¡æŒ‡å®šå­˜å‚¨ç±»å‹
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>inline</span> Echo <span style=color:#719e07>*</span>Echo<span style=color:#719e07>::</span>static_member <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> Echo {<span style=color:#2aa198>&#34;Echo::static_member&#34;</span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#dc322f>void</span> <span style=color:#268bd2>test_echo</span>() {
</span></span><span style=display:flex><span>    <span style=color:#719e07>static</span> Echo hidden(<span style=color:#2aa198>&#34;local static&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Echo <span style=color:#268bd2>global_echo</span>(<span style=color:#2aa198>&#34;global&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#719e07>static</span> Echo <span style=color:#268bd2>static_echo</span>(<span style=color:#2aa198>&#34;static echo&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>struct</span> <span style=color:#268bd2>Foo</span> {
</span></span><span style=display:flex><span>    <span style=color:#719e07>static</span> <span style=color:#268bd2>inline</span> Echo <span style=color:#719e07>*</span>static_member <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> Echo {<span style=color:#2aa198>&#34;Foo::static_member&#34;</span>};
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#dc322f>int</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#586e75>// è¯•è¯•è°ƒç”¨ 0/1/2 æ¬¡
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>    test_echo();
</span></span><span style=display:flex><span>    test_echo();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>æ‰“å°ç»“æœï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-txt data-lang=txt><span style=display:flex><span>Echo::static_member
</span></span><span style=display:flex><span>global
</span></span><span style=display:flex><span>static echo
</span></span><span style=display:flex><span>Foo::static_member
</span></span><span style=display:flex><span>local static
</span></span></code></pre></div><p>ä¸Šé¢çš„ä»£ç ä¸­å¦‚æœæ³¨é‡Šæ‰ main å‡½æ•°ä¸­çš„ä¸¤æ¬¡è°ƒç”¨ï¼Œåˆ™ <code>hidden("local static")</code> ä¸ä¼šè¢«åˆå§‹åŒ–ï¼çœ‹ä¸‹é¢çš„æ±‡ç¼–ä»£ç ï¼Œæœ‰äº†åŒæ­¥æªæ–½åå¤æ‚äº†ä¸å°‘ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-nasm data-lang=nasm><span style=display:flex><span><span style=color:#268bd2>test_echo</span>():
</span></span><span style=display:flex><span>        <span style=color:#268bd2>push</span>    <span style=color:#b58900>rbp</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>rbp</span>, <span style=color:#b58900>rsp</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>push</span>    <span style=color:#268bd2>r12</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>push</span>    <span style=color:#b58900>rbx</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>movzx</span>   <span style=color:#b58900>eax</span>, <span style=color:#dc322f>BYTE</span> <span style=color:#268bd2>PTR</span> <span style=color:#268bd2>guard</span> <span style=color:#268bd2>variable</span> <span style=color:#268bd2>for</span> <span style=color:#268bd2>test_echo</span>()::<span style=color:#268bd2>hidden</span>[<span style=color:#268bd2>rip</span>]
</span></span><span style=display:flex><span>        <span style=color:#268bd2>test</span>    <span style=color:#b58900>al</span>, <span style=color:#b58900>al</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>sete</span>    <span style=color:#b58900>al</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>test</span>    <span style=color:#b58900>al</span>, <span style=color:#b58900>al</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>je</span>      <span style=color:#268bd2>.L7</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>edi</span>, <span style=color:#268bd2>OFFSET</span> <span style=color:#268bd2>FLAT</span>:<span style=color:#268bd2>guard</span> <span style=color:#268bd2>variable</span> <span style=color:#268bd2>for</span> <span style=color:#268bd2>test_echo</span>()::<span style=color:#268bd2>hidden</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>call</span>    <span style=color:#268bd2>__cxa_guard_acquire</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>test</span>    <span style=color:#b58900>eax</span>, <span style=color:#b58900>eax</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>setne</span>   <span style=color:#b58900>al</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>test</span>    <span style=color:#b58900>al</span>, <span style=color:#b58900>al</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>je</span>      <span style=color:#268bd2>.L7</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>r12d</span>, <span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>esi</span>, <span style=color:#268bd2>OFFSET</span> <span style=color:#268bd2>FLAT</span>:<span style=color:#268bd2>.LC0</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>edi</span>, <span style=color:#268bd2>OFFSET</span> <span style=color:#268bd2>FLAT</span>:<span style=color:#268bd2>_ZZ9test_echovE6hidden</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>call</span>    <span style=color:#268bd2>Echo</span>::<span style=color:#268bd2>Echo</span>(<span style=color:#b58900>ch</span><span style=color:#268bd2>ar</span> <span style=color:#268bd2>const</span><span style=color:#719e07>*</span>) [<span style=color:#268bd2>complete</span> <span style=color:#268bd2>object</span> <span style=color:#268bd2>constructor</span>]
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>edi</span>, <span style=color:#268bd2>OFFSET</span> <span style=color:#268bd2>FLAT</span>:<span style=color:#268bd2>guard</span> <span style=color:#268bd2>variable</span> <span style=color:#268bd2>for</span> <span style=color:#268bd2>test_echo</span>()::<span style=color:#268bd2>hidden</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>call</span>    <span style=color:#268bd2>__cxa_guard_release</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>jmp</span>     <span style=color:#268bd2>.L7</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>rbx</span>, <span style=color:#b58900>rax</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>test</span>    <span style=color:#b58900>r12b</span>, <span style=color:#b58900>r12b</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>jne</span>     <span style=color:#268bd2>.L5</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>edi</span>, <span style=color:#268bd2>OFFSET</span> <span style=color:#268bd2>FLAT</span>:<span style=color:#268bd2>guard</span> <span style=color:#268bd2>variable</span> <span style=color:#268bd2>for</span> <span style=color:#268bd2>test_echo</span>()::<span style=color:#268bd2>hidden</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>call</span>    <span style=color:#268bd2>__cxa_guard_abort</span>
</span></span><span style=display:flex><span>.L5:
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>rax</span>, <span style=color:#b58900>rbx</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>rdi</span>, <span style=color:#b58900>rax</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>call</span>    <span style=color:#268bd2>_Unwind_Resume</span>
</span></span><span style=display:flex><span>.L7:
</span></span><span style=display:flex><span>        <span style=color:#268bd2>nop</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>pop</span>     <span style=color:#b58900>rbx</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>pop</span>     <span style=color:#268bd2>r12</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>pop</span>     <span style=color:#b58900>rbp</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>ret</span>
</span></span></code></pre></div><h1 id=å…¨å±€--å±€éƒ¨-thread_local-å˜é‡>å…¨å±€ / å±€éƒ¨ thread_local å˜é‡
<a class=header-anchor href=#%e5%85%a8%e5%b1%80--%e5%b1%80%e9%83%a8-thread_local-%e5%8f%98%e9%87%8f></a></h1><h2 id=c11-thread_local>C++11 thread_local
<a class=header-anchor href=#c11-thread_local></a></h2><p>è®¿é—®å˜é‡éœ€è¦ä½¿ç”¨ä¸€ä¸ª<strong>å’Œçº¿ç¨‹ç›¸å…³çš„æ®µå¯„å­˜å™¨</strong>å’Œå›ºå®šçš„å˜é‡åç§»å¾—åˆ°å˜é‡çš„åœ°å€ï¼Œè¿™æ ·ä¸åŒçº¿ç¨‹è®¿é—®çš„å˜é‡åœ°å€è‚¯å®šä¸åŒã€‚</p><p>å¯¹äºå…¨å±€çš„ <code>thread_local</code> å˜é‡ï¼Œæ¯æ¬¡è®¿é—® <code>thread_local</code> å˜é‡ <code>i</code> ä¼šå…ˆè°ƒç”¨ <code>TLS wrapper function for i</code>ï¼Œç„¶åè¯¥å‡½æ•°è°ƒç”¨ <code>TLS init function for i</code>ï¼ˆåœ¨ Compiler Explorer è¿‡æ»¤çš„æ±‡ç¼–ä¸­æ˜¯ <code>__tls_init</code>ï¼‰ç¡®ä¿å˜é‡åªè¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼Œæœ€åè¿”å›å˜é‡çš„<strong>åœ°å€</strong>ã€‚</p><p><a href=https://godbolt.org/z/Y8a7s4Msz title=https://godbolt.org/z/Y8a7s4Msz rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://godbolt.org/z/Y8a7s4Msz<i class="fa fa-external-link-alt"></i></a></p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>#include</span> <span style=color:#719e07>&lt;iostream&gt;</span><span style=color:#719e07>
</span></span></span><span style=display:flex><span><span style=color:#719e07>#include</span> <span style=color:#719e07>&lt;thread&gt;</span><span style=color:#719e07>
</span></span></span><span style=display:flex><span><span style=color:#719e07></span>
</span></span><span style=display:flex><span><span style=color:#719e07>thread_local</span> <span style=color:#dc322f>int</span> i <span style=color:#719e07>=</span> time(<span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#dc322f>int</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    i <span style=color:#719e07>=</span> <span style=color:#2aa198>7</span>;
</span></span><span style=display:flex><span>    std<span style=color:#719e07>::</span><span style=color:#268bd2>thread</span> t{[<span style=color:#719e07>&amp;</span>](){ i <span style=color:#719e07>=</span> <span style=color:#2aa198>9</span>; }};
</span></span><span style=display:flex><span>    t.join();
</span></span><span style=display:flex><span>    std<span style=color:#719e07>::</span>cout <span style=color:#719e07>&lt;&lt;</span> i <span style=color:#719e07>&lt;&lt;</span> <span style=color:#2aa198>&#34;</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å¯¹äºå±€éƒ¨çš„ thread_local å˜é‡ï¼š</p><p><a href=https://godbolt.org/z/xdePfv3eM title=https://godbolt.org/z/xdePfv3eM rel="noopener external nofollow noreferrer" target=_blank class=exturl>https://godbolt.org/z/xdePfv3eM<i class="fa fa-external-link-alt"></i></a></p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>#include</span> <span style=color:#719e07>&lt;iostream&gt;</span><span style=color:#719e07>
</span></span></span><span style=display:flex><span><span style=color:#719e07>#include</span> <span style=color:#719e07>&lt;thread&gt;</span><span style=color:#719e07>
</span></span></span><span style=display:flex><span><span style=color:#719e07></span>
</span></span><span style=display:flex><span><span style=color:#586e75>// å› ä¸º main å…¥å£è‚¯å®šåªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥å°è¯•æŠŠ thread_local æ”¾åˆ°å…¶ä»–å‡½æ•°ä¸­è¯•è¯•
</span></span></span><span style=display:flex><span><span style=color:#586e75>// å®é™…ä¸Šå’ŒæŠŠ thread_local å˜é‡æ”¾åœ¨ main ä¸­çš„æ•ˆæœä¸€æ ·
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#dc322f>int</span> <span style=color:#719e07>&amp;</span>get_i() {
</span></span><span style=display:flex><span>    <span style=color:#719e07>thread_local</span> <span style=color:#dc322f>int</span> i <span style=color:#719e07>=</span> time(<span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#719e07>return</span> i;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#dc322f>int</span> <span style=color:#268bd2>main</span>() {
</span></span><span style=display:flex><span>    get_i() <span style=color:#719e07>=</span> <span style=color:#2aa198>7</span>;
</span></span><span style=display:flex><span>    std<span style=color:#719e07>::</span><span style=color:#268bd2>thread</span> t{[<span style=color:#719e07>&amp;</span>](){ get_i() <span style=color:#719e07>=</span> <span style=color:#2aa198>9</span>; }};
</span></span><span style=display:flex><span>    t.join();
</span></span><span style=display:flex><span>    std<span style=color:#719e07>::</span>cout <span style=color:#719e07>&lt;&lt;</span> get_i() <span style=color:#719e07>&lt;&lt;</span> <span style=color:#2aa198>&#34;</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>get_i()</code> ä¸­ä¹Ÿæœ‰ç¡®ä¿å˜é‡ä»…ä»…åˆå§‹åŒ–ä¸€æ¬¡çš„é€»è¾‘ã€‚</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-nasm data-lang=nasm><span style=display:flex><span><span style=color:#268bd2>get_i</span>()::<span style=color:#268bd2>i</span>:
</span></span><span style=display:flex><span>        <span style=color:#268bd2>.zero</span>   <span style=color:#2aa198>4</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>guard</span> <span style=color:#268bd2>variable</span> <span style=color:#268bd2>for</span> <span style=color:#268bd2>get_i</span>()::<span style=color:#268bd2>i</span>:
</span></span><span style=display:flex><span>        <span style=color:#268bd2>.zero</span>   <span style=color:#2aa198>8</span>
</span></span><span style=display:flex><span><span style=color:#268bd2>get_i</span>():
</span></span><span style=display:flex><span>        <span style=color:#268bd2>push</span>    <span style=color:#b58900>rbp</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>rbp</span>, <span style=color:#b58900>rsp</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>rax</span>, <span style=color:#dc322f>QWORD</span> <span style=color:#268bd2>PTR</span> <span style=color:#b58900>fs</span>:<span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>add</span>     <span style=color:#b58900>rax</span>, <span style=color:#268bd2>OFFSET</span> <span style=color:#268bd2>FLAT</span>:<span style=color:#268bd2>guard</span> <span style=color:#268bd2>variable</span> <span style=color:#268bd2>for</span> <span style=color:#268bd2>get_i</span>()::<span style=color:#268bd2>i@tpoff</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>movzx</span>   <span style=color:#b58900>eax</span>, <span style=color:#dc322f>BYTE</span> <span style=color:#268bd2>PTR</span> [<span style=color:#b58900>rax</span>]
</span></span><span style=display:flex><span>        <span style=color:#268bd2>test</span>    <span style=color:#b58900>al</span>, <span style=color:#b58900>al</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>jne</span>     <span style=color:#268bd2>.L11</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>edi</span>, <span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>call</span>    <span style=color:#268bd2>time</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#dc322f>DWORD</span> <span style=color:#268bd2>PTR</span> <span style=color:#b58900>fs</span>:<span style=color:#268bd2>get_i</span>()::<span style=color:#268bd2>i@tpoff</span>, <span style=color:#b58900>eax</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>rax</span>, <span style=color:#dc322f>QWORD</span> <span style=color:#268bd2>PTR</span> <span style=color:#b58900>fs</span>:<span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>add</span>     <span style=color:#b58900>rax</span>, <span style=color:#268bd2>OFFSET</span> <span style=color:#268bd2>FLAT</span>:<span style=color:#268bd2>guard</span> <span style=color:#268bd2>variable</span> <span style=color:#268bd2>for</span> <span style=color:#268bd2>get_i</span>()::<span style=color:#268bd2>i@tpoff</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#dc322f>BYTE</span> <span style=color:#268bd2>PTR</span> [<span style=color:#b58900>rax</span>], <span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span>.L11:
</span></span><span style=display:flex><span>        <span style=color:#268bd2>mov</span>     <span style=color:#b58900>rax</span>, <span style=color:#dc322f>QWORD</span> <span style=color:#268bd2>PTR</span> <span style=color:#b58900>fs</span>:<span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>add</span>     <span style=color:#b58900>rax</span>, <span style=color:#268bd2>OFFSET</span> <span style=color:#268bd2>FLAT</span>:<span style=color:#268bd2>get_i</span>()::<span style=color:#268bd2>i@tpoff</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>pop</span>     <span style=color:#b58900>rbp</span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>ret</span>
</span></span></code></pre></div><p>æ‰€ä»¥ï¼Œå…¨å±€å’Œå±€éƒ¨çš„ <code>thread_local</code> å˜é‡è®¿é—®çš„ä»£ä»·æ˜¯ä¸€æ ·çš„ã€‚åªä¸è¿‡å¦‚æœ <code>thread_local</code> æ˜¯å±€éƒ¨çš„ï¼Œ<strong>æ£€æŸ¥æ˜¯å¦éœ€è¦åˆå§‹åŒ–</strong>çš„é€»è¾‘å°±ç›´æ¥æ”¾åœ¨å‡½æ•°ä¸­ï¼›å¦‚æœæ˜¯å…¨å±€çš„ï¼Œè¿™ä¸ªé€»è¾‘ç”¨ä¸€ä¸ªç”Ÿæˆçš„å‡½æ•°å®ç°è€Œå·²ã€‚<code>thread_local static</code> å’Œ <code>static</code> å±€éƒ¨å˜é‡ç›¸æ¯”ï¼Œ</p><p>æ¥ä¸‹æ¥å°è¯•æŠŠ <code>time(0)</code> è¿™ç§åˆå§‹åŒ–è¡¨è¾¾å¼æ¢æˆä¸€ä¸ªå¸¸é‡ï¼Œæ¯”å¦‚è¯´ 2ï¼Œåˆ™è®¿é—® <code>thread_local</code> æ—¶ä¸ä¼šæœ‰åŒæ­¥æªæ–½ï¼Œåªæ˜¯åˆ›å»ºçº¿ç¨‹çš„æ—¶å€™è¦å¤åˆ¶ä¸€ä»½å˜é‡è€Œå·²ã€‚</p><h2 id=c11-_thread_local>C11 _Thread_local
<a class=header-anchor href=#c11-_thread_local></a></h2><p>C11 çš„å¤´æ–‡ä»¶ threads.h ä¸­æœ‰ä¸‹é¢å®šä¹‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#719e07>#define thread_local _Thread_local
</span></span></span></code></pre></div><p>è¿™å°±å’Œä»¥å‰çš„ <code>bool</code> å®éœ€è¦å¼•å…¥ä¸€æ ·ã€‚åœ¨ C23 ä¹‹åï¼Œ<code>thread_local</code> å°±æ˜¯ä¸€ä¸ªå•ç‹¬çš„å…³é”®å­—äº†ã€‚</p><p>C11 çš„ <code>thread_local</code> æ˜¯ä¸å…·å¤‡ <code>static</code> å±æ€§çš„ï¼Œåœ¨å‡½æ•°ä¸­ä½¿ç”¨æ—¶è¦ç”¨ <code>thread_local static</code>ï¼Œè€Œ C++ ä¸­çš„ <code>thread_local</code> åœ¨å‡½æ•°ä¸­è‡ªåŠ¨å…·å¤‡ <code>static</code> å±æ€§ï¼ŒåŠ ä¸åŠ  <code>static</code> éƒ½è¡Œã€‚</p><p>C++ æ ‡å‡†ï¼š</p><blockquote><p>When thread_local is applied to a variable of block scope the storage-class-specifier staticÂ <strong>is implied</strong>Â if it does not appear explicitly.</p></blockquote><p>2023 å¹´ 6 æœˆ 15 æ—¥ï¼šC11 çš„ threads.h åœ¨ Windows ä¸Šæ²¡æœ‰å®ç°ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰æä¾›åƒ C++ çš„ mutex ä¸€æ ·çš„åŒæ­¥åŠŸèƒ½ï¼Œå†™ C è¯­è¨€ç”¨çº¿ç¨‹è¿˜æ˜¯ pthreads.h / Win32 API ä¼šæ¯”è¾ƒå¥½ä¸€ç‚¹ã€‚</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>åƒ C ä¸€æ ·ç”¨å¸¸é‡è¡¨è¾¾å¼åˆå§‹åŒ–å°±ä¸ä¼šæœ‰è®¿é—®å¼€é”€ã€‚&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Static local æŒ‡çš„æ˜¯åœ¨å‡½æ•°ä½œç”¨åŸŸä¸­è¢« <code>static</code> ä¿®é¥°çš„å±€éƒ¨å˜é‡ã€‚&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>å¯¹äºå…¨å±€å˜é‡æ¥è¯´ï¼Œæ— è®ºæ˜¯ C++ è¿˜æ˜¯ Cï¼Œ<code>static</code> å’Œ <code>thread_local</code> æ˜¯æ­£äº¤çš„ï¼Œ<code>static</code> è¡¨ç¤ºæ˜¯å¦å¯¹å¤–é“¾æ¥ï¼Œ<code>thread_local</code> è¡¨ç¤ºæ˜¯å¦çº¿ç¨‹æœ¬åœ°ã€‚&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><div class=post-tags><a href=/tags/cpp>cpp
</a><a href=/tags/inside-the-cpp-object-model>inside-the-cpp-object-model</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/inside-the-cpp-object-model/vtable/ rel=next title="ğŸ“Œ vtable"><i class="fa fa-chevron-left"></i> ğŸ“Œ vtable</a></div><div class="post-nav-prev post-nav-item"><a href=/inside-the-cpp-object-model/Cfront-%E5%A6%82%E4%BD%95%E6%8F%92%E5%85%A5%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/ rel=prev title="Cfront å¦‚ä½•æ’å…¥æ„é€ å‡½æ•°">Cfront å¦‚ä½•æ’å…¥æ„é€ å‡½æ•°
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2023 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>ğŸ¤–</span></div><div class=powered-by>ç”± <a href=https://gohugo.io title=0.143.1 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨</div></div></footer><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js defer></script><script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":false,"save":"manual"},"copybtn":true,"darkmode":false,"hostname":"https://hxhue.github.io/","i18n":{"ds_day":" å¤©å‰","ds_days":" å¤© ","ds_hour":" å°æ—¶å‰","ds_hours":" å°æ—¶ ","ds_just":"åˆšåˆš","ds_min":" åˆ†é’Ÿå‰","ds_mins":" åˆ†é’Ÿ","ds_month":" ä¸ªæœˆå‰","ds_years":" å¹´ ","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","placeholder":"æœç´¢..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":false,"transition":{"collheader":"fadeInLeft","menu_item":"fadeInDown","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":false,"plugin":"waline"},"views":{"enable":false,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"cdnjs","router":"https://cdnjs.cloudflare.com/ajax/libs"},"version":"4.5.3"}</script><script type=text/javascript src=/js/main.min.37ba8b54f9d4d784d08028c45eea93b5d4e13eda8ee7fb0d2edd6f3fac66cfd2.js defer></script></body></html>